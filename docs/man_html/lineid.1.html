<!-- manual page source format generated by PolyglotMan v3.2, -->
<!-- available at http://polyglotman.sourceforge.net/ -->

<html>
<head>
<title>LINEID(1NEMO) manual page</title>
</head>
<body bgcolor='white'>
This HTML automatically generated with <A HREF=http://manpages.ubuntu.com/manpages/bionic/man1/rman.1.html>rman</A> for <A HREF=https://astronemo.readthedocs.io>NEMO</A><br>
<a href='#toc'>Table of Contents</a><p>

<p> 
<h2><a name='sect0' href='#toc0'>Name</a></h2>
lineid - spectral line ID tool 
<p> 
<h2><a name='sect1' href='#toc1'>Synopsis</a></h2>
<b>lineid</b> in=file [parameter=value]

<p> 
<h2><a name='sect2' href='#toc2'>Description</a></h2>
<b>lineid</b> is a tool that helps with converting between frequencies
and doppler velocities, as well as identifying lines when the rest frequency
can be derived. 
<p> <p>
<b>lineid</b> currently operates in three modes: 
<p> <br>
1. For a given doppler velocity (<b>vel=</b>) and an input list of sky frequencies,
the rest frequencies are calculated, and if a linelist is given, a lineid
is attempted. This will be useful for multiple spectral lines in a given
object. 
<p> <br>
2. For a given rest frequency (<b>restfreq=</b>) and an input list of sky frequencies,
their doppler shifts are calculated in a variety of conventions (radio,
relativistic, optical, and z). This will be useful for a large field of
view where always the same line (e.g. HI) is detected in many sources at
different cosmological distances. 
<p> <br>
3. For a given <b>restfreq=</b> and an input list of velocities (now with <b>xunit=km/s</b>),
the rest frequencies of the other lines are computed, and a lineid can
be attempted. The first velocity in the list needs to match the given rest
frequency This is probably a rare case, as spectra typically originate
in frequency, not doppler velocity. 
<p> <br>
4. For given <b>vel=</b> and list of velocities there is no practical application?
It can probably be run as mode 3. 
<p> <p>
In cases 1. and 3. a lineid can be attempted
if a line list is supplied using <b>linelist=</b>. See LINELIST below for examples
of line lists. 
<p> <p>
<b>lineid</b> can also attempt to find the strongest peak in a
spectrum if both the X and Y columns are given, but <a href='tabpeak.1.html'><i>tabpeak(1NEMO)</i></a>
 is probably
a better feed into <b>lineid</b>. 
<p> <p>
More sophisticated algorithms for lineid can
be found in ADMIT&rsquo;s LineID task, in particular dealing with multiple "spectra"
derived from a fits cube. 
<p> 
<h2><a name='sect3' href='#toc3'>Parameters</a></h2>
 The following parameters are recognized
in order; they may be given in any order if the keyword is also given. Use
<b>--help</b> to confirm this man page is up to date.  
<dl>

<dt><b>in=</b><i>file</i> </dt>
<dd>Input file name, in
ASCII <a href='table.5.html'><i>table(5NEMO)</i></a>
 format.  The number of columns will depend on which of
the xcol,ycol,dycol is used. <br>
No default. </dd>

<dt><b>xcol=</b><i>x-column</i> </dt>
<dd>X coordinate column, representing the frequency
or wavelength axis. Units are GHz, unless specified with the <b>xunit</b> keyword.
The X column is always required. <br>
[1] </dd>

<dt><b>ycol=</b><i>y-column</i> </dt>
<dd>Y coordinate column, reprepenting an intensity. If not
used, the xcol is assumed to have the already determined values of the
lines to be identified or converted to doppler velocities. <br>
By default not used. </dd>

<dt><b>dxcol=</b><i>x-err-column</i> </dt>
<dd>Errors in the X coordnates. Only makes
sense if no ycol is given.  Not implemented yet. <br>
By default not used. </dd>

<dt><b>xunit=</b> </dt>
<dd>X axis unit. Currently only GHz and km/s are
supported. <br>
[GHz] </dd>

<dt><b>vel=[#[,unit]]</b> </dt>
<dd>Redshift of object, in km/s. Optional unit added, e.g.
<i>vel=1.2,z</i>. As for unit, only <i>km/s</i> and the dimensionless <i>z</i> are allowed. <br>
Not set by default. If a value is given, the unit defaults to <i>km/s</i>. </dd>

<dt><b>restfreq=</b>
</dt>
<dd>If line is known, give rest frequency in <b>xunit</b> (only GHz supported now).
In a future version <i>restwave=</i> might be supported. <br>
Not set by default. </dd>

<dt><b>linelist=</b> </dt>
<dd>Table with frequencies and line names. There
is a simple list in $NEMODAT/z_lines.list with some common high-Z lines. <br>
Not set by default. </dd>

<dt><b>dv=</b> </dt>
<dd>Slop (in km/s) allowed in identifying lines. Negative
values will use nearest neighbor and report the dv. <br>
[10] </dd>

<dt><b>clip=</b> </dt>
<dd>Do not fit peaks in the spectrum below this clip level. <br>
Default: not used </dd>

<dt><b>veldef=RAD|OPT|REL</b> </dt>
<dd>Mode of velocity axis. Radio, Relativistic,
or Optical are supported. <br>
[OPT] 
<p> </dd>
</dl>

<h2><a name='sect4' href='#toc4'>Caveats</a></h2>

<p> The code was developed with frequency in mind, only GHz
and km/s are supported. Wavelength is planned. 
<p> Looks for a single emission
line in the strongest peak.. May not work for absorption lines yet, or use
<a href='tabpeak.1.html'><i>tabpeak(1NEMO)</i></a>
 if multiple lines are needed. See EXAMPLES below. 
<p> Although
different doppler conventions are supported, coordinate frames are ignored.

<p> 
<h2><a name='sect5' href='#toc5'>Examples</a></h2>
The following three example generates a spectrum from a random
table of 115 values, smoothes by 10 channels to create a handful of peaks
and investigates the strongest peak, which happens to be near 40 "GHz".
 The frequencies are labeled 0 to 114 in steps of 1 GHz.  
<p>   #&gt; mode 1.<br>
   tabgen - 115 1 2 123 | tabsmooth - 1 12 10,5 |\<br>
         lineid - 0 1 vel=1.872,z dv=200 linelist=$NEMODAT/z_lines.list<br>
   ### nemo Debug[0]: Vrad=195408 Vrel=234961 Vopt=561211 z=1.872<br>
   ### nemo Debug[0]: Found 23 lines in the linelist=/home/teuben/teunix/nemo/data/z_lines.list<br>
   # There are 1 restfreq&rsquo;s to identify:<br>
   # Commented lines do not fall within dv=200 km/s<br>
   #    guess    ID    LINE     dFreq    deltaV  NAME<br>
   #    GHz            Ghz      GHz      km/s<br>
     115.230827   2 115.271202 0.040375 105.006 CO(1-0)<br>
 
<p> 
<p>   #&gt; mode 2.<br>
   tabgen - 115 1 2 123 | tabsmooth - 1 12 10,5 | tabpeak -  0 1 |\<br>
         lineid - restfreq=115<br>
   # restfreq=115<br>
   # SkyFreq Vrad  Vrel   Vopt    z<br>
   # GHz     km/s  km/s  km/s    <br>
   29.914   221810 261794 852717  2.84436<br>
   40.1222  195198 234729 559487  1.86625<br>
   72.1352  111744 130493 178145  0.594229<br>
 
<p> 
<p>   #&gt; mode 3.<br>
   tabgen - 115 1 2 123 | tabsmooth - 1 12 10,5 | tabpeak -  0 1 |\<br>
         lineid - restfreq=115 xunit=km/s<br>
   ### nemo Debug[0]: Reading 2 column(s)<br>
   # There are 3 restfreq&rsquo;s to identify: (use linelist= to find their names)<br>
   115.000000<br>
   114.996085<br>
   114.983808<br>
 
<p>  
<p> and here some examples with no input spectrum. Only <b>xcol=</b> is needed:

<p>  
<p>   #&gt; mode 1.<br>
   echo 1.397105 | lineid - vel=5000 <br>
   ### nemo Debug[0]: Vrad=4917.98 Vrel=4958.31 Vopt=5000 z=0.0166782<br>
   # There are 1 restfreq&rsquo;s to identify: (use linelist= to find their names)<br>
   1.420406<br>
   <br>
 
<p>   #&gt; mode 2.<br>
   nemoinp 1.397105,1.1 | lineid - restfreq=1.420405751786 <br>
   # restfreq=1.42041<br>
   # SkyFreq Vrad    Vrel     Vopt     z<br>
   # GHz     km/s    km/s     km/s<br>
   1.39711  4916.83  4957.14  4998.81  0.0166742<br>
   1.1     67625.2  75009.8  87322.9   0.291278<br>
 
<p> 
<p>   #&gt; mode 3.<br>
   echo 5000 | lineid - restfreq=1.420405751786 xunit=km/s<br>
   ### nemo Debug[1]: 0a: Line at 5000.000000 km/s has skyfreq 1.397105 
restfreq 1.420406<br>
   # There are 1 restfreq&rsquo;s to identify: (use linelist= to find their names)<br>
   1.420406<br>
 
<p>  
<p> An contrived example of the CO(1-0) and CO(2-1) lines from the CO ladder,
deliberately doppler shifted a bit by 300 km/s (give or take): 
<p>  
<p>   #&gt; mode
1.<br>
   nemoinp 110.092,115.155,220.179,230.308  |\<br>
       lineid - linelist=$NEMODAT/z_lines.list vel=300 dv=2.5<br>
   ### nemo Debug[0]: Vrad=299.7 Vrel=299.85 Vopt=300 z=0.00100069<br>
   ### nemo Debug[0]: Found 23 lines in the listlist /home/teuben/NEMO/nemo/data/z_lines.list<br>
   # There are 4 restfreq&rsquo;s to identify:<br>
   #    guess    ID    LINE     dFreq    deltaV   NAME<br>
   #    GHz            Ghz      GHz      km/s<br>
     110.202168   1 110.201354 0.000814 -2.21418  13CO(1-0)<br>
   # 115.270235   2 115.271202 0.000967  2.51514  CO(1-0)<br>
     220.399331   3 220.398680 0.000651 -0.886089 13CO(2-1)<br>
     230.538467   4 230.538000 0.000467 -0.607859 CO(2-1)<br>
     <br>
  
<p> Here an example of detected lines in velocity space and deriving their
restfreq&rsquo;s.  The first line in the list will be the one belonging to the
known restfreq of CO(1-0), and was detected at -20 km/s. But there was a weak
line at -312 km/s with unknown identification. To find what line this is,
We need to find the rest frequency and then a lineid. In the example we
only grab the restfreq&rsquo;s. 
<p>  
<p>   #&gt; mode 3.<br>
   nemoinp -20,-310 | lineid - restfreq=115.2712018 xunit=km/s<br>
   # There are 2 restfreq&rsquo;s to identify: (use linelist= to find names)<br>
   115.271202<br>
   115.382823<br>
   <br>
  
<p> There is indeed a known SiC2,v=0 line at 115.382367 GHz. 
<p> <p>

<p> Compare different
doppler conventions (veldef)  
<p>   #&gt; mode 1.<br>
   echo 0 | lineid - vel=5000 veldef=rel<br>
   ### nemo Debug[0]: rad=4958.99 rel=5000 opt=5042.4 z=0.0168196<br>
 
<p>  
<p> 
<h2><a name='sect6' href='#toc6'>Linelist</a></h2>
The input linelist is a very simple ascii table of (frequency,name).
There are many sources for a linelist, we mention a few: <br>
<pre>1. $NEMO/data/z_lines.list : common high-Z lines, from HI at 1.4GHz upwards
2. ADMIT&rsquo;S has a few in $ADMIT/etc/*list
3. Splatalogue at https://www.splatalogue.online/
4. Astroquery:   https://astroquery.readthedocs.io/en/latest/nist/nist.html
and
   https://astroquery.readthedocs.io/en/latest/atomic/atomic.html
</pre>
<p> 
<h2><a name='sect7' href='#toc7'>See Also</a></h2>
<a href='tablsqfit.1.html'>tablsqfit(1NEMO)</a>
, <a href='tabpeak.1.html'>tabpeak(1NEMO)</a>
, <a href='tabpp.1.html'>tabpp(1NEMO)</a>
, <a href='ccdsky.1.html'>ccdsky(1NEMO)</a>
,
<a href='table.5.html'>table(5NEMO)</a>
 <p>
admit::LineID_AT() 
<p> 
<h2><a name='sect8' href='#toc8'>Author</a></h2>
Peter Teuben 
<p> 
<h2><a name='sect9' href='#toc9'>Update History</a></h2>
<br>
<pre>13-dec-2024<tt> </tt>&nbsp;<tt> </tt>&nbsp;0.1 Draft created<tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
3-jul-2025<tt> </tt>&nbsp;<tt> </tt>&nbsp;0.3 add mode=<tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
15-jan-2026<tt> </tt>&nbsp;<tt> </tt>&nbsp;0.4 added simple nearest neighbor line_id<tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
16-jan-2026<tt> </tt>&nbsp;<tt> </tt>&nbsp;0.5 implemented veldef=<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
17-jan-2026<tt> </tt>&nbsp;<tt> </tt>&nbsp;0.6 mode= deprecated<tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
18-jan-2026<tt> </tt>&nbsp;<tt> </tt>&nbsp;0.7 removed never used keywords<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
</pre><p>

<hr><p>
<a name='toc'><b>Table of Contents</b></a><p>
<ul>
<li><a name='toc0' href='#sect0'>Name</a></li>
<li><a name='toc1' href='#sect1'>Synopsis</a></li>
<li><a name='toc2' href='#sect2'>Description</a></li>
<li><a name='toc3' href='#sect3'>Parameters</a></li>
<li><a name='toc4' href='#sect4'>Caveats</a></li>
<li><a name='toc5' href='#sect5'>Examples</a></li>
<li><a name='toc6' href='#sect6'>Linelist</a></li>
<li><a name='toc7' href='#sect7'>See Also</a></li>
<li><a name='toc8' href='#sect8'>Author</a></li>
<li><a name='toc9' href='#sect9'>Update History</a></li>
</ul>
</body>
</html>
