<!-- manual page source format generated by PolyglotMan v3.2, -->
<!-- available at http://polyglotman.sourceforge.net/ -->

<html>
<head>
<title>FTOC(1NEMO) manual page</title>
</head>
<body bgcolor='white'>
<a href='#toc'>Table of Contents</a><p>

<h2><a name='sect0' href='#toc0'>Name</a></h2>
ftoc - nemo_main() builder from fortran source code 
<h2><a name='sect1' href='#toc1'>Synopsis</a></h2>
<b>ftoc</b> [parameter=value]

<h2><a name='sect2' href='#toc2'>Description</a></h2>
<i>ftoc</i> is a C-source extracter (from fortran) that can be useful
if you need to add the NEMO user interface to a FORTRAN program. The FORTRAN
<b>PROGRAM</b> statement must not appear in the source code, instead there must
be a subroutine, preferably with the name <b>NEMOMAIN</b>, that the NEMO user
interface will consider the MAIN fortran program. Example see below. <p>
This
manual page also documents the usage of the F77_FUNC macros to aid C programmers
importing/exporting their fortran/C code to C/Fortran resp. 
<h2><a name='sect3' href='#toc3'>Parameters</a></h2>
The
following parameters are recognized in any order if the keyword is also
given: 
<dl>

<dt><b>in=</b> </dt>
<dd>Input source code to extract defv[] from. No default. </dd>

<dt><b>out=</b> </dt>
<dd>Output
nemo_main module [- means stdout]. [Default: <b>-</b>]. </dd>

<dt><b>call=</b> </dt>
<dd>You fortran main subroutine
(no args!)  [Default: <b>nemomain</b>]. </dd>

<dt><b>machine=</b> </dt>
<dd>machine for symbols name conversions.
 Recognized machines for symbol name conversion are <b>cray</b>, <b>bsd</b>, <b>vms</b>. They
upper case the symbol, add a trailing underscore or leave the  symbol alone,
resp.  By default, <i>ftoc</i> will try and figure it out by itself.  </dd>
</dl>

<h2><a name='sect4' href='#toc4'>Example</a></h2>
Let&rsquo;s
take a routine, <b>test.f</b> displayed below, that needs the NEMO user interface:
<br>
<pre>C
C:      Test program for NEMO&rsquo;s footran interface
C+
C   in=???\n            Required (dummy) filename
C   n=1000\n            Test integer value
C   pi=3.1415\n         Test real value
C   e=2.3\n             Another test value
C   text=hello world\n  Test string
C   VERSION=1.1\n       24-may-92 PJT
C-
C
      SUBROUTINE nemomain
C
      .......
</pre>with the following command <br>
<pre>    % ftoc test.f &gt; test_main.c
    % f77 -c test.f test_main.c -L$NEMOLIB -lnemo
</pre>a non-graphics program can be compiled. It is assumed, that the fortran callable
<a href='getparam.3.html'><i>getparam(3NEMO)</i></a>
 has also been added to the NEMO library. 
<h2><a name='sect5' href='#toc5'>Nemomain</a></h2>
A NEMO
C-main will use the routine name <i>nemo_main</i>, whereas  a Fortran-main will
use the name <i>nemomain</i>. ANSI rules do not clearly define (or may even forbid)
use of embedded underscores. In fact, on linux a fortran symbol name like
<i>a_b</i> will get exported as <i>a_b__</i>. You may have to add the  -fno-underscoring
 and/or  -fno-second-underscore options to the fortran compiler (FFLAGS). 
<h2><a name='sect6' href='#toc6'>F77_func</a></h2>
A
macro called F77_FUNC is defined through config.h (created at installation
time by the configure script) that aids the programmer to re-define the
name of a C function, such that it can be used by fortran code, or by defining
the name of an extern fortran module such that C can call it. For example,
look at the following contrived example. <p>
In fortran: <br>
<pre>        DOUBLE PRECISION FUNCTION FUNCF(X)
        DOUBLE PRECISION X, FUNCC
        IF (X.LT.1.0d0) THEN
            FUNCF = SQRT(X)
        ELSE
            FUNCF = FUNCC(1.0d0/X)
        ENDIF 
        END
</pre>and in C: <br>
<pre>    #define funcc F77_FUNC(funcc,FUNCC)
    #define funcf F77_FUNC(funcf,FUNCF)
        
    extern double funcf(double *);
   
    double funcc(double * xp) {
        double x = *xp;
        if (x &lt; 1.0)
            return  sqrt(x);
        else {
            x = 1.0/x;
            return  funcf(&amp;x);
        }
    }


See Alsonm(1) AuthorPeter Teuben Update History
xx-jun-92<tt> </tt>&nbsp;<tt> </tt>&nbsp;V1.0 Created<tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
25-May-92<tt> </tt>&nbsp;<tt> </tt>&nbsp;V1.1 added c: to signal usage line<tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
20-jan-98<tt> </tt>&nbsp;<tt> </tt>&nbsp;more doc
7-jan-00<tt> </tt>&nbsp;<tt> </tt>&nbsp;V2.0 changed to use F77_FUNC; machine -&gt; options    <tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
</pre><p>

<hr><p>
<a name='toc'><b>Table of Contents</b></a><p>
<ul>
<li><a name='toc0' href='#sect0'>Name</a></li>
<li><a name='toc1' href='#sect1'>Synopsis</a></li>
<li><a name='toc2' href='#sect2'>Description</a></li>
<li><a name='toc3' href='#sect3'>Parameters</a></li>
<li><a name='toc4' href='#sect4'>Example</a></li>
<li><a name='toc5' href='#sect5'>Nemomain</a></li>
<li><a name='toc6' href='#sect6'>F77_func</a></li>
<li><a name='toc7' href='#sect7'>See Also</a></li>
<li><a name='toc8' href='#sect8'>Author</a></li>
<li><a name='toc9' href='#sect9'>Update History</a></li>
</ul>
</body>
</html>
