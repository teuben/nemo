<!-- manual page source format generated by PolyglotMan v3.2, -->
<!-- available at http://polyglotman.sourceforge.net/ -->

<html>
<head>
<title>SCANFITS(1NEMO) manual page</title>
</head>
<body bgcolor='white'>
<a href='#toc'>Table of Contents</a><p>

<h2><a name='sect0' href='#toc0'>Name</a></h2>
scanfits - scan a fits file, optionally extract and convert. 
<h2><a name='sect1' href='#toc1'>Synopsis</a></h2>
<p>
<b>scanfits
in=</b>fits_file  [parameter=value] 
<h2><a name='sect2' href='#toc2'>Description</a></h2>
<i>scanfits</i> reads a FITS file. It
scans the header for various FITS (mis)interpretations, and reports on
bad behaviour. Some of it can be fixed, in which case the header and/or
data can be output to a file. It is also possible to insert new card images
in a header. <p>
FITS Header-Data Unit&rsquo;s (HDU) can be extracted individually by
using the <b>hdu</b> keyword. 0 typically signifies all of the HDU&rsquo;s in a file,
you can select them by number, 1 being the first. <p>
Since scanfits can only
process disk FITS files, FITS files on tape have to be extracted using
<a href='dd.1.html'><i>dd(1)</i></a>
 or similar programs. See also notes in <a href='ccdfits.1.html'><i>ccdfits(1NEMO)</i></a>
 how  to process
fits files from tape. <p>
This program was written while the author was on the
first FITS panel. The cfitsio suite is now also providing a FITS checker

<p> 
<h2><a name='sect3' href='#toc3'>Parameters</a></h2>
The following parameters are recognized in any order if the
keyword is  also given: 
<dl>

<dt><b>in=<i>fits-infile</i></b> </dt>
<dd>input file, in <a href='fits.5.html'><i>fits(5)</i></a>
 format. The
input fits file is allowed to have many HDU&rsquo;s. [no default].  </dd>

<dt><b>out=<i>fits-outfile</i></b>
</dt>
<dd>output file, in <a href='fits.5.html'><i>fits(5)</i></a>
 format. If <b>split=t</b> this is the basename of the output
filename. The basename can contain a standard <a href='printf.3.html'><i>printf(3)</i></a>
 expression (e.g. <i>try%d.fits</i>),
in which case the HDU will be automatically encoded in the output filename(s).
If no filename is given, the input fits  file is only scanned, and a summary
of the selected HDU&rsquo;s is presented (see also <b>print=</b>). The header can also
be fixed up (see <b>delete=</b>, <b>keep=</b>, <b>insert=</b> and <b>fix=</b> below),  though the data
cannot be modified,  but it is guaranteed that the size of the data portion
on disk will be a multiple of the logical block size  (<i>blocking * 2880</i>,
see below), even if the last did not have this.  [default: none]. </dd>

<dt><b>hdu=<i>integer_list</i></b>
</dt>
<dd>List of HDU&rsquo;s of the FITS file that need to be processed. (<i> Note: currently
only one at a time can be processed</i>) Using a value of 0 will cause all
HDU&rsquo;s (the whole fits file) to be read. [default: <b>0</b>]. </dd>

<dt><b>delete=<i>pattern</i></b> </dt>
<dd>A list
of patterns can be given, separated by comma&rsquo;s. Note that no spaces can be
used: a space is  considered part of the pattern. Each of these is matched
against the card images. If a match is found, that particular card images
is deleted by blanking the card.  Blank lines can then be deleted from the
FITS header using <b>fix=BLANK</b>, see below. The list can be empty, in which
case no action is undertaken. Note that only one of <b>keep=</b> and <b>delete=</b> can
be given. [default: none]. </dd>

<dt><b>keep=<i>pattern</i></b> </dt>
<dd>A list of patterns can be given,
separated by comma&rsquo;s. Each of these is matched against the card images. When
all the card images have been scanned, only the ones which were part of
the <i>keep</i> patterns will not be blanked out. Blank lines can subsequently
be deleted from the header by using  <b>fix=BLANK</b>, see below. The list can
be empty, in which case no action is undertaken. Note that only one of <b>keep=</b>
and <b>delete=</b> can be given. <i>Note: </i>Be careful when using this keyword, and
that the required keywords are not deleted this way. [default: none]. </dd>

<dt><b>insert=</b><i>hfile</i>
</dt>
<dd>A list of files with (currently valid FITS header format) header  cards,
which will be inserted *as is* just before the END keyword in the above
selected HDU&rsquo;s. Note that these insertions are done after any of the above
mentioned  optional <b>keep</b>, <b>delete</b>, <b>fix</b> etc. To get an example file, extract
an editable ASCII header with e.g. <i>fitshead</i>, or see the example below.  <i>NOTE</i>:
The lines need to be exactly 80 characters wide, any lines shorter than
this will be blankfilled according to the FITS rules, and any lines wider
than 80 will be cut. [Default: none]. </dd>

<dt><b>fix=<i>options</i></b> </dt>
<dd>List of fixes, separated
by comma&rsquo;s. Possible options are: <b>ING, TUCSON, LF, BLANK, ZERO, DECORDER,
FIRST, LAST, Y2K, UNY2K</b>  and <b>IRAF0</b>.  For an description see the section
FIXES below. The list can be empty, in which case no fixes are applied. [default:
none]. </dd>

<dt><b>print=<i>pattern</i></b> </dt>
<dd>A list of patterns with which a FITS keyword (really:
the first 8 characters on a FITS card image) begins. For these keywords
the value or HISTORY/COMMENT is printed on  lines starting with a <b>#</b> symbol.
Different header sections are separated with the <b>##</b> symbol in the first
column. Note that is either <b>keep=</b> or <b>delete=</b> has been used, the blanked
header cards cannot be seen anymore via the <b>print=</b> keyword. Note that printout
is only active in scanmode. If an output file is created, this keyword is
not active. [Default: not used]. </dd>

<dt><b>blocking=<i>factor</i></b> </dt>
<dd>Positive integer that denotes
the blocking factor with which the input  file was written. The second number
is the blocking factor for output. If the second number if not supplied,
it is taken the same as the first one. The blocking factor is the multiple
of blocks of 2880 bytes with which  the data is to be read/written. The
FITS standard allows the blocking factor to be from 1 to 10. <i>Be aware that
datafiles that need a blocking factor larger than 1, may not need it once
the data is written to disk.</i> [default: <b>1,1</b>]. </dd>

<dt><b>select=header|data</b> </dt>
<dd>Select <b>data</b>,
<b>header</b> or both (separated by comma&rsquo;s) for output. [Default: <b>header,data</b>].
</dd>

<dt><b>split=t|f</b> </dt>
<dd>Boolean (t/f) to designate that when an output file is selected
 (<b>out=</b>) AND multiple files to be copied (<b>file=0</b>) the output file is split
into it&rsquo;s &lsquo;&lsquo;file&rsquo;&rsquo; components. The <i>fits-outfile</i> name will then be a base filename,
and the program generates its own numeric extension. [Default: <b>false</b>]. </dd>
</dl>

<h2><a name='sect4' href='#toc4'>Fixes</a></h2>
This
is a list of the currently supported fixes for the header. Each of them
is applied in the order as  they appear in the <b>fix=</b> keyword. Their names
have to be supplied in full, separated by commas. No spaces. 
<dl>

<dt><b>ING</b> </dt>
<dd>Isaac Newton
Group (ING) uses 9 blanks in the first column, followed by the word <b>ING</b>,
followed by a space, after which an ING specific keywords start. If you
want to promote these to regular keywords, a shift of 13 characters to
the left does the job. The 13 rightmost characters in the card image are
 set to blank. </dd>

<dt><b>TUCSON</b> </dt>
<dd>Certain FITS files coming out of NRAO TUCSON have
card images starting with <b>SINGLDSH</b>. The next 10 characters are used for
another level of identification, and at position 19 the actual FITS-like
keyword starts. By using this option the FITS keyword starting at position
19 is promoted to a real FITS keyword, by  shifting those 18 positions
to the left. The 18 rightmost  characters in the card image are set to blank.
</dd>

<dt><b>LF</b> </dt>
<dd>Character 80 (the last one) in each header card image is patched with
a linefeed (newline) (<i>hexadecimal 0x0A</i>).  This is useful to edit the header
with an ASCII editor on UNIX. It would normally be used with <b>options=header</b>.
See also <a href='fitshead.1.html'><i>fitshead(1NEMO)</i></a>
 if you don&rsquo;t want to see trailing blanks. </dd>

<dt><b>BLANK</b>
</dt>
<dd>Delete all card images which are completeley blank. This is often the result
of either old style FITS files, or when card images had been blanked before
with <b>delete=</b><i>pattern</i> or <b>keep=</b><i>pattern</i>  Since the <i>fix</i> is applied<br>
 <i>after</i> the <i>blank</i> only one run of scanfits is needed to blank out and delete
certain card  images, e.g. <b>scanfits in out delete=ING fix=BLANK</b>. </dd>

<dt><b>ZERO</b> </dt>
<dd>Replace
all zero&rsquo;s in the header by blanks. </dd>

<dt><b>FIRST</b> </dt>
<dd>Retain only the first keyword if
they occur multiple times in the header. The other card images are blanked.
HISTORY and COMMENT and anything that does not have an &rsquo;=&rsquo; in column 9 are
not affected. </dd>

<dt><b>LAST</b> </dt>
<dd>Retain only the last keyword if they occur multiple times
in the header. The other card images are blanked. HISTORY and COMMENT and
anything that does not have an &rsquo;=&rsquo; in column 9 are not affected. </dd>

<dt><b>Y2K</b> </dt>
<dd>If a
keyword <b>DATExxxx</b> is present, and it matches the pattern "dd/mm/yy", it
will be transformed to "yyyy-mm-dd", which makes the file Y2K compliant. 
FYI: the unix <a href='date.1.html'><i>date(1)</i></a>
 command produces Y2K compliant with <b>date +%Y-%m-%dT%H:%M:%S.%N</b>,
where the subsecond <b>.%N</b> portion is optional. The old style is done with 
<b>date +%d/%m/%y<b>,  which does not sort lexically. </dd>

<dt><b>UNY2K</b></b></b> </dt>
<dd>If a keyword <b>DATExxxx</b>
is present, and it matches the pattern "yyyy-mm-dd", it will be transformed
to "dd/mm/yy", which makes the file non-Y2K compliant. This might help you
getting by some old readers. Highly discouraged of course. </dd>

<dt><b>DECORDER</b> </dt>
<dd>If the
keyword <b>DECORDER</b> is present, and it has a value <b>T</b>, it will replace this
keyword by a COMMENT and set a flag such that of all data the bytes are
byte swapped when read (or copied) according to <i>abs(BITPIX)</i>. </dd>

<dt><b>IRAF0</b> </dt>
<dd>Replace
the FITS keyword <b>HISTORY</b> by <b>COMMENT</b>. This has been proven useful to be able
to see al that information by the <i>iraf</i> program <i>imhead</i>.  </dd>

<dt><b>PROMOTE</b> </dt>
<dd>Replace
the first FITS keyword <b>XTENSION</b> with <b>SIMPLE = T</b>, so an extension is promoted
to become the primary HDU. Of course this only makes sense if you are extracting
single HDUs, e.g. via the <b>hdu=</b> or <b>split=t</b> options. </dd>
</dl>

<h2><a name='sect5' href='#toc5'>Processing Order</a></h2>
With all
the possible editing capabilities, it is important to  know the processing
order: <br>
<pre>        select the valid HDU&rsquo;s, 0=all (hdu=)
        delete header items by pattern matching (delete=)
        keep header items by pattern matching (keep=)
        insert new header items before the END card (insert=)
        fix header items (in order of individual fix= components)
</pre>
<h2><a name='sect6' href='#toc6'>Examples</a></h2>
To extract the header in a pleasing manner, such that <a href='more.1.html'><i>more(1)</i></a>
 can
be used, one can use: <br>
<pre>    % scanfits in=junk.fits out=junk.header fix=LF select=header
or
    % fitshead junk.fits  &gt; junk.header
</pre>where the latter example does not contain trailing blanks anymore. 
<h2><a name='sect7' href='#toc7'>See Also</a></h2>
<a href='ccdfits.1.html'>ccdfits(1NEMO)</a>
,
<a href='dd.1.html'>dd(1)</a>
, <a href='fits.5.html'>fits(5NEMO)</a>
, <a href='fitshead.1.html'>fitshead(1NEMO)</a>
 <p>
<br>
<pre>https://heasarc.gsfc.nasa.gov/fitsio/
https://fits.gsfc.nasa.gov/fits_verify.html
</pre>
<h2><a name='sect8' href='#toc8'>Author</a></h2>
Peter Teuben 
<h2><a name='sect9' href='#toc9'>Files</a></h2>
<br>
<pre>~/src/image/fits         scanfits.c
</pre>
<h2><a name='sect10' href='#toc10'>Update History</a></h2>
<br>
<pre>27-mar-90<tt> </tt>&nbsp;<tt> </tt>&nbsp;V1.0 Written                     <tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
17-jul-90<tt> </tt>&nbsp;<tt> </tt>&nbsp;V1.1 added fix=, blank=            <tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
 7-mar-91<tt> </tt>&nbsp;<tt> </tt>&nbsp;V1.3 added split=,keep=, and TUSCON <tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
25-jul-91<tt> </tt>&nbsp;<tt> </tt>&nbsp;V1.4 added the IRAF0 fix - blocking  <tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
30-jul-91<tt> </tt>&nbsp;<tt> </tt>&nbsp;V1.4b added Jeff Hesters brilliant DECORDER fix  <tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
11-apr-92<tt> </tt>&nbsp;<tt> </tt>&nbsp;V1.5 changed name of file= to hdu=<tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
7-aug-92   <tt> </tt>&nbsp;<tt> </tt>&nbsp;fixed ctype/ttype bugs in fits(3NEMO)<tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
13-jan-93    <tt> </tt>&nbsp;<tt> </tt>&nbsp;V1.7 insert= now implemented Arie!<tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
2-dec-98<tt> </tt>&nbsp;<tt> </tt>&nbsp;V1.8 fix=PROMOTE for lgm&rsquo;s nicmos <tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
15-oct-99<tt> </tt>&nbsp;<tt> </tt>&nbsp;V1.8b fix=UNY2K (and Y2K)for Staguhn&rsquo;s GILDAS  <tt> </tt>&nbsp;<tt> </tt>&nbsp;pjt
</pre><p>

<hr><p>
<a name='toc'><b>Table of Contents</b></a><p>
<ul>
<li><a name='toc0' href='#sect0'>Name</a></li>
<li><a name='toc1' href='#sect1'>Synopsis</a></li>
<li><a name='toc2' href='#sect2'>Description</a></li>
<li><a name='toc3' href='#sect3'>Parameters</a></li>
<li><a name='toc4' href='#sect4'>Fixes</a></li>
<li><a name='toc5' href='#sect5'>Processing Order</a></li>
<li><a name='toc6' href='#sect6'>Examples</a></li>
<li><a name='toc7' href='#sect7'>See Also</a></li>
<li><a name='toc8' href='#sect8'>Author</a></li>
<li><a name='toc9' href='#sect9'>Files</a></li>
<li><a name='toc10' href='#sect10'>Update History</a></li>
</ul>
</body>
</html>
