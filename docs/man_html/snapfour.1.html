<!-- manual page source format generated by PolyglotMan v3.2, -->
<!-- available at http://polyglotman.sourceforge.net/ -->

<html>
<head>
<title>SNAPFOUR(1NEMO) manual page</title>
</head>
<body bgcolor='white'>
HTML automatically generated with <A HREF=http://manpages.ubuntu.com/manpages/bionic/man1/rman.1.html>rman</A><br>
<a href='#toc'>Table of Contents</a><p>

<h2><a name='sect0' href='#toc0'>Name</a></h2>
snapfour - fourier analyze a snapshot 
<h2><a name='sect1' href='#toc1'>Synopsis</a></h2>
<b>snapfour in=</b>snapshot_file
 [parameters=values...] 
<h2><a name='sect2' href='#toc2'>Description</a></h2>
<i>snapfour</i> computes a number of requested
fourier (<i>cos</i> and  <i>sin</i>) coefficients in a user determined part of the snapshot
By default the snapshot is divided in a set of concentric cylindrical rings,
and a fourier analysis is done in  cylindrical coordinates. <p>
The observable
quantity <i>f</i> is fitted as <br>
<pre>  f(r,theta) = sum_{cmi..}{A(r)cos(cmi*theta) + sum_{smi..}{B(r)sin(smi*theta)

</pre>where <i>x</i>, <i>y</i> as well as <i>f</i> </pre>  r = sqrt(x*x+y*y) , theta=atan2(y,x)<br>
 </pre>can be any arbitrary <a href='bodytrans.3.html'><i>bodytrans(3NEMO)</i></a>
 expression using the <b>xvar</b>, <b>yvar</b>
and <b>fvar</b> keywords. The least squares is done using normalized equations,
which are known for roundoff problem in case a large number of coefficients
or points are used. <p>
Optionally the cos (A) and sin (B) coefficients can
be transformed into an amplitude (C) and phase (P), see <b>amode=</b> below. 
<h2><a name='sect3' href='#toc3'>Parameters</a></h2>
The
following parameters are recognized in any order if the keyword is also
given: 
<dl>

<dt><b>in=<i>in_file</i></b> </dt>
<dd>Input data file, must be in standard <a href='snapshot.5.html'><i>snapshot(5NEMO)</i></a>

 format [No default]. </dd>

<dt><b>radii=<i>rmin,r1,..,rmax</i></b> </dt>
<dd>Radii of the rings (but see <b>xvar</b>
and <b>yvar</b> below) within which the fourier coefficients are computed. [Default:
<b>0:2:0.2</b>]. </dd>

<dt><b>cos=<i>cm1,cm2,..</i></b> </dt>
<dd>Set of integers for which the cosine amplitudes need
to be computed. [Default: <b>0:4</b>]. </dd>

<dt><b>sin=<i>sm1,sm2,..</i></b> </dt>
<dd>Set of integers for which the
sine amplitudes need to be computed. [Default: <b>1:4</b>]. </dd>

<dt><b>xvar=<i>x-variable</i></b> </dt>
<dd>X-variable
which is used to compute the radius and angle used in the fourier decomposition.
[Default: <b>x</b>]. </dd>

<dt><b>yvar=<i>y-variable</i></b> </dt>
<dd>Y-variable which is used to compute the radius
and angle used in the fourier decomposition. [Default: <b>y</b>]. </dd>

<dt><b>fvar=<i>f-variable</i></b>
</dt>
<dd>Fourier-variable which is the variable used in in the fourier decomposition.
[Default: <b>vy</b>]. </dd>

<dt><b>weight=<i>w-variable</i></b> </dt>
<dd>Weight-variable which is the weight applied
to the observable. [Default: <b>1</b>]. </dd>

<dt><b>amode=t|f</b> </dt>
<dd>Logical; if true it displays the
sin and cos terms, if false, the amplitudes and phases (in degrees). [Default:
<b>t</b>] </dd>

<dt><b>times=</b><i>t1,t2,...</i> </dt>
<dd>Times to select for analysis.  [Default: <b>all</b>]. </dd>
</dl>

<h2><a name='sect4' href='#toc4'>Examples</a></h2>
<br>
<pre>  % mkexpdisk disk1 10000
  % snapfour disk1 amode=f &gt; tab1
  % tabplot tab1 1 4,3,6,8,10 line=1,1 color=2,3,4,5 ycoord=0 
  % tabplot tab1 1 5:11:2 line=1,1 color=2,3,4,5 ycoord=0
</pre>Another case is that of an inclined disk that first needs to be  rectified,
but preserving the position angle of the major axis. Lets assume the <b>$pa</b>
and <b>$inc</b> are known.  Unlike for kinematic  observations (see e.g. <a href='rotcur.1.html'><i>rotcur(1NEMO)</i></a>
)
we don&rsquo;t care which side of the disk is the near side. The rectify operation
to get the galaxy back to a "face-on" view depends if you disk is truely
3D or (as is normally observed) a sky-projected inclined disk. For the former
case we then get: <br>
<pre>  % snaprotate disk1 disk2 theta=-$pa,-$inc,$pa order=zyz
  % snapfour disk2 ...
</pre>and for the latter case <br>
<pre>  % snaprotate disk1 -     theta=-$pa order=z         |\
    snapscale  -     -     rscale="1/cosd($inc),1,0"  |\
    snaprotate -     disk2 theta=$pa  order=z
  % snapfour disk2 ...
</pre>
<h2><a name='sect5' href='#toc5'>See Also</a></h2>
<a href='bodytyrans.1.html'>bodytyrans(1NEMO)</a>
, <a href='orbfour.1.html'>orbfour(1NEMO)</a>
, <a href='snapshot.5.html'>snapshot(5NEMO)</a>
 <p>
Binney, J.J. &amp;
Spergel, D. (1982) ApJ 253, 308. 
<h2><a name='sect6' href='#toc6'>Author</a></h2>
Peter Teuben 
<h2><a name='sect7' href='#toc7'>Files</a></h2>
<br>
<pre>~/src/nbody/reduc<tt> </tt>&nbsp;<tt> </tt>&nbsp;snapfour.c 
</pre>
<h2><a name='sect8' href='#toc8'>Update History</a></h2>
<br>
<pre>3-dec-90<tt> </tt>&nbsp;<tt> </tt>&nbsp;V1.0: written<tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
17-feb-92<tt> </tt>&nbsp;<tt> </tt>&nbsp;V1.1: added weight=<tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
10-nov-93<tt> </tt>&nbsp;<tt> </tt>&nbsp;V1.2: added times=<tt> </tt>&nbsp;<tt> </tt>&nbsp;pjt
