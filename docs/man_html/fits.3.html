<!-- manual page source format generated by PolyglotMan v3.2, -->
<!-- available at http://polyglotman.sourceforge.net/ -->

<html>
<head>
<title>FITS(3NEMO) manual page</title>
</head>
<body bgcolor='white'>
<a href='#toc'>Table of Contents</a><p>

<h2><a name='sect0' href='#toc0'>Name</a></h2>
fts_rhead, fts_whead, fts_rdata, fts_wdata, fts_sdata, fts_zero, fts_dsize
- fits I/O routines 
<h2><a name='sect1' href='#toc1'>Synopsis</a></h2>
<br>
<pre>#include &lt;stdinc.h&gt;#include &lt;fits.h&gt;int fts_zero(fh)int fts_rhead (fh, instr)int
fts_whead (fh, outstr)int fts_rdata(fh, instr, size, buf)int fts_wdata(fh,
outstr, size, buf)int fts_rrow(fh, instr, size, buf)int fts_wrow(fh, instr,
size, buf)int fts_sdata(fh, instr)int fts_cdata(fh, instr, outstr, trailer)int
fts_dsize(fh)int fts_setiblk(factor)int fts_setoblk(factor)
stream instr;stream
outstr;struct fits_header *fh;char *buf;int size, factor;bool trailer
other
miscellanious, not yet documented, routines:
fts_buf

fts_chead, fts_dhead, fts_fhead, fts_ihead, fts_khead, fts_lhead, fts_phead,
fts_thead


fts_wvar, fts_wvarb, fts_wvarb_a, fts_wvarc, fts_wvarc_a, 
fts_wvard, fts_wvard_a, fts_wvarf, fts_wvarf_a, fts_wvari, fts_wvari_a

ftp_read_img_coord 

DescriptionThese routines provide a low-level I/O interface  to the FITS
data structure. For most programs the fitsio(3NEMO) interface will be sufficient;
that package however does not call the fits(3NEMO) package but has it&rsquo;s
own I/O routines. The amount of checking and correction/conversion done
in the fits(3NEMO) routines makes it a more flexible setup. The amount of
work to be done by the application programmer is often however greater.
After a file has been opened with stropen, fts_rhead must be called to
read in the FITS header information into the  struct fits_header *fh; this
structure needs to be cleared with fts_zero before reading is attempted.
Most  essential FITS keywords are placed in this structure, unknown keywords
are skipped, although they can be retrieved using the exact binary image
of the header, of which there is always an exact memory image available
to the application programmer. 
It is the programmers responsibility to keep
track of the position of the file pointer. The FITS headers are always read/written
in one call (fts_rhead, fts_whead), but it is possible to either skip the
data completely (fts_sdata) or read/write (portions of) the data (fts_rdata,
fts_wdata, fts_rrow, fts_wrow).  No buffering is done on the fits-I/O routines,
since system calls fread(3) and fwrite(3)  are used. It is possible to read
and write with different FITS blocking factors using fts_setiblk and fts_setoblk.

ExampleIt is the programmers responsiblity to read in the data  correctly.
The following example shows, without any bells, whistles and error checking,
how a simple data matrix can be read in: 
<tt> </tt>&nbsp;<tt> </tt>&nbsp;instr = stropen(getparam("in"),"r");
<tt> </tt>&nbsp;<tt> </tt>&nbsp;fts_zero(&amp;fh);                   <tt> </tt>&nbsp;<tt> </tt>&nbsp;/* zero the fits header */
<tt> </tt>&nbsp;<tt> </tt>&nbsp;fts_rhead(instr,&amp;fh);              <tt> </tt>&nbsp;<tt> </tt>&nbsp;/* read fits header */
<tt> </tt>&nbsp;<tt> </tt>&nbsp;n = fts_dsize(&amp;fh);              <tt> </tt>&nbsp;<tt> </tt>&nbsp;/* get size of data portion */
<tt> </tt>&nbsp;<tt> </tt>&nbsp;if (fh.bitpix == -32) {          <tt> </tt>&nbsp;<tt> </tt>&nbsp;/* IEEE single precision */
<tt> </tt>&nbsp;<tt> </tt>&nbsp;  fbuf = (float *) malloc(n/sizeof(float));<tt> </tt>&nbsp;<tt> </tt>&nbsp;/* allocate */
<tt> </tt>&nbsp;<tt> </tt>&nbsp;  fts_rdata(instr,&amp;fh,fbuf,n);     <tt> </tt>&nbsp;<tt> </tt>&nbsp;/* read in as single prec. */
<tt> </tt>&nbsp;<tt> </tt>&nbsp;} else if (fh.bitpix == -64) {      <tt> </tt>&nbsp;<tt> </tt>&nbsp;/* IEEE double precision */
<tt> </tt>&nbsp;<tt> </tt>&nbsp;  dbuf = (double *) malloc(n/sizeof(double));  <tt> </tt>&nbsp;<tt> </tt>&nbsp;/* allocate */
<tt> </tt>&nbsp;<tt> </tt>&nbsp;  fts_rdata(instr,&amp;fh,dbuf,n);     <tt> </tt>&nbsp;<tt> </tt>&nbsp;/* read in as double precision */
<tt> </tt>&nbsp;<tt> </tt>&nbsp;} else
<tt> </tt>&nbsp;<tt> </tt>&nbsp;  error("Cannot handle non-IEEE data format0);<tt> </tt>&nbsp;<tt> </tt>&nbsp;/* too bad */
</pre><p>
The program <a href='scanfits.1NEMO.html'><i>scanfits(1NEMO)</i></a>
 provides an excellent example how this package
can be used. The program <a href='ccdfits.1NEMO.html'><i>ccdfits(1NEMO)</i></a>
 is a more common example where <a href='fitsio.3NEMO.html'><i>fitsio(3NEMO)</i></a>

is sufficient. 
<h2><a name='sect4' href='#toc4'>See Also</a></h2>
<a href='fseek.3.html'>fseek(3)</a>
, <a href='ftell.3.html'>ftell(3)</a>
, <a href='fitsio.3NEMO.html'>fitsio(3NEMO)</a>
, <a href='scanfits.1NEMO.html'>scanfits(1NEMO)</a>
,
<a href='fitshead.3NEMO.html'>fitshead(3NEMO)</a>
 
<h2><a name='sect5' href='#toc5'>Author</a></h2>
Peter Teuben 
<h2><a name='sect6' href='#toc6'>Files</a></h2>
<br>
<pre>~/src/image/fits  <tt> </tt>&nbsp;<tt> </tt>&nbsp;fits.[ch]
</pre>
<h2><a name='sect7' href='#toc7'>Bugs</a></h2>
Reading multiple open fits files in parallel has not been secured since
there is only one slot for the memory copy of the FITS header. <p>
No support
for machines whos native format is not floating point IEEE and integer
twos complement, although some byte-swapping is supported. 
<h2><a name='sect8' href='#toc8'>Caveats</a></h2>
Poor support
for endian swapping, current done when output requested, through internal
show_X() functions 
<h2><a name='sect9' href='#toc9'>History</a></h2>
<br>
<pre>xx-mar-90<tt> </tt>&nbsp;<tt> </tt>&nbsp;created  <tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
19-jun-90<tt> </tt>&nbsp;<tt> </tt>&nbsp;more comments <tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
16-mar-91<tt> </tt>&nbsp;<tt> </tt>&nbsp;upgraded plus warnings that fits(3NEMO) should be used<tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
25-jul-91<tt> </tt>&nbsp;<tt> </tt>&nbsp;various blocking factor I/O now done properly<tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
7-aug-92<tt> </tt>&nbsp;<tt> </tt>&nbsp;fixed ctype/ttype reading bugs; more output fts_phead<tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
24-sep-92<tt> </tt>&nbsp;<tt> </tt>&nbsp;fixed more bugs  <tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
18-jan-93<tt> </tt>&nbsp;<tt> </tt>&nbsp;added fts_ihead  <tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
29-jun-94<tt> </tt>&nbsp;<tt> </tt>&nbsp;added fts_rrow/wrow and keep track of all I/O<tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
7-oct-94<tt> </tt>&nbsp;<tt> </tt>&nbsp;added argument to fts_cdata<tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
23-may-95<tt> </tt>&nbsp;<tt> </tt>&nbsp;added argument to fts_chead and fts_thead<tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
29-sep-01<tt> </tt>&nbsp;<tt> </tt>&nbsp;experimental 64 bitpix, removed some lies    <tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
</pre>
<p> <p>

<hr><p>
<a name='toc'><b>Table of Contents</b></a><p>
<ul>
<li><a name='toc0' href='#sect0'>Name</a></li>
<li><a name='toc1' href='#sect1'>Synopsis</a></li>
<li><a name='toc2' href='#sect2'>Description</a></li>
<li><a name='toc3' href='#sect3'>Example</a></li>
<li><a name='toc4' href='#sect4'>See Also</a></li>
<li><a name='toc5' href='#sect5'>Author</a></li>
<li><a name='toc6' href='#sect6'>Files</a></li>
<li><a name='toc7' href='#sect7'>Bugs</a></li>
<li><a name='toc8' href='#sect8'>Caveats</a></li>
<li><a name='toc9' href='#sect9'>History</a></li>
</ul>
</body>
</html>
