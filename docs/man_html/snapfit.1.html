<!-- manual page source format generated by PolyglotMan v3.2, -->
<!-- available at http://polyglotman.sourceforge.net/ -->

<html>
<head>
<title>SNAPFIT(1NEMO) manual page</title>
</head>
<body bgcolor='white'>
HTML automatically generated with <A HREF=http://manpages.ubuntu.com/manpages/bionic/man1/rman.1.html>rman</A><br>
<a href='#toc'>Table of Contents</a><p>

<h2><a name='sect0' href='#toc0'>Name</a></h2>
snapfit - fit <a href='a.6D.html'>a (6D)</a>
 snapshot to <a href='a.3D.html'>a (3D)</a>
 data cube 
<h2><a name='sect1' href='#toc1'>Synopsis</a></h2>
<b>snapfit</b> [parameter=value]

<h2><a name='sect2' href='#toc2'>Description</a></h2>
<i>snapfit</i> attempts to match an observed 3D datacube (where X and
Y are normally positions on the sky, and Z the radial velocity)  with a
6D model snapshot (with the usual <b>x,y,z,vx,vy,vz</b> coordinates, see <a href='bodytrans.1.html'><i>bodytrans(1NEMO)</i></a>
).
It finds the best match by varying the two viewing angles, two scale factors
and three offsets of the model. The scalefactors in X and Y are forced to
be the same,  whereas the one in Z is usually independantly determined
(though this can be changed with the parameter <b>zmode</b>). <p>
Weights can be given
to invidual model points, as well as (to some degree) the data points. 
The weight of the data will be taken as the intensity at the observed pixel,
it&rsquo;s up to pre-processing to set proper weights. The weight of the model can
be modified using a standard <a href='bodytrans.5.html'><i>bodytrans(5)</i></a>
 expression, applied to each particle
individually, using the <b>weight</b> parameter. <p>
Currently the match is done in
a rather primitive way:  with respect to their center of mass  the two
moments of inertia  (see <a href='snapinert.1.html'><i>snapinert(1NEMO)</i></a>
) of the model and data are compared,
after which the rotation matrix for each is derived (see also <a href='snaprect.1.html'><i>snaprect(1NEMO)</i></a>
).
Then the product of one and the inverse of the other is compared with the
unity matrix, and the norm of this difference matrix is going to be minimized
(a perfect fit should return 0). We shall refer to this norm as <b>sum</b>. The
output will contain the <b>log(sum)</b>. 
<h2><a name='sect3' href='#toc3'>Parameters</a></h2>
The following parameters are
recognized in any order if the keyword is also given: 
<dl>

<dt><b>in=</b><i>in_snapshot</i> </dt>
<dd>Input
model <a href='snapshot.5.html'><i>snapshot(5NEMO)</i></a>
. No default. </dd>

<dt><b>cube=</b><i>in_image</i> </dt>
<dd>Input data. This can be either
a 3D datacube in standard <a href='image.5.html'><i>image(5NEMO)</i></a>
 format or an ascii table, with <b>x,y,vz,I</b>
in the first four columns. In the latter case  the intensity <b>I</b> is optional,
a default value of 1.0 will be taken for data with missing intensity. No
default. </dd>

<dt><b>cutoff=</b><i>data_cutoff</i> </dt>
<dd>Cutoff applied to data cube, if needed: data
values less then <i>data_cutoff</i> are ignored. Default: no cutoff given, all
data from image (table) are used. </dd>

<dt><b>weight=</b><i>body_weight</i> </dt>
<dd>Weight (see <a href='bodytrans.1.html'><i>bodytrans(1NEMO)</i></a>
)
given to model particles. Bodies with weight less or equal zero are ignored.
[default: <b>1</b>]. </dd>

<dt><b>out=</b><i>out_snapshot</i> </dt>
<dd>Optional output <a href='snapshot.1.html'><i>snapshot(1NEMO)</i></a>
. It can also
be controlled by the <b>minchi</b> and <b>frame</b> parameters. No name, and this is the
default, there will be no output snapshot. If selected,  of the phase space
coordinates only the <b>x</b>, <b>y</b> and <b>z</b> coordinates are written. <i> ** not implemented
** </i> </dd>

<dt><b>minchi=</b> </dt>
<dd>Minimum <b>log(sum)</b> needed for an output snapshot.  <i> ** not implemented
** <br>
</i> </dd>

<dt><b>frame=model|data</b> </dt>
<dd>Select to output the re-oriented snapshot in <b>model</b> or <b>data</b>
coordinates. [Default: <b>model</b>].  <i> ** not implemented ** <br>
</i> </dd>

<dt><b>zmode=sim|sep</b> </dt>
<dd>Selection if the <b>zvar</b> coordinate should be treated equal
(<b>sim</b>) or seperately (<b>sep</b>) in the minimization. [Default: <b>sep</b>]. </dd>

<dt><b>theta1=</b><i>i1,i2,...</i>
</dt>
<dd>the first rotation angle to fit. Fixed values can be given, in which case
these are tested against. By default no values are given. This angle can
be associated with the inclination of a disk, if this is kept in mind. </dd>

<dt><b>theta2=</b><i>p1,p2,...</i>
</dt>
<dd>the second rotation angle to fit. <i>see comments above.</i> This angle can be associated
with the position angle of a disk, if this is kept in mind. </dd>

<dt><b>contour=</b><i>out_image</i>
</dt>
<dd>Optional output file, in which for all input angles (<i>theta1,theta2</i>) the
values of the logarithm of the norm of the difference matrix (<b>log(sum)</b>)
is stored in standard <a href='image.5.html'><i>image(5NEMO)</i></a>
 format.  Contour plots can be made with
<a href='ccdplot.1.html'><i>ccdplot(1NEMO)</i></a>
 Default: none. </dd>

<dt><b>iter=</b> </dt>
<dd>Number of extra iterations needed for
the best model from choosen values of the matrix of <i>theta1,theta2</i> angles
to narrow down the search. <i> ** not implemented ** </i> </dd>

<dt><b>times=</b><i>t1:t2,t3,...</i> </dt>
<dd>Standard
selection of the (ranges of) times to be selected from the input snapshot
[Default: <b>all</b>].        </dd>
</dl>

<h2><a name='sect4' href='#toc4'>Bugs</a></h2>
A <i>time-scale</i> factor should be absorbed by the
 user into the <b>zvar</b> expression.  This is the factor by which the (model/data?)
velocities are multiplied in order to compute a properly dimensioned for
chi-squared. This problem is only partially overcome by using <b>zmode=separate</b>
<p>
<i>snapfit<i> only works for <b>NDIM=3</b></i></i>: the input data must be a 3D datacube. <p>
May
work reasonably well for single features to fit, for double features a
principle component analysis may have to be done beforehand. 
<h2><a name='sect5' href='#toc5'>See Also</a></h2>
<a href='tablsqfit.1.html'>tablsqfit(1NEMO)</a>
,
<a href='snaprect.1.html'>snaprect(1NEMO)</a>
, <a href='snapinert.1.html'>snapinert(1NEMO)</a>
 
<h2><a name='sect6' href='#toc6'>Author</a></h2>
Peter Teuben 
<h2><a name='sect7' href='#toc7'>Update History</a></h2>
<br>
<pre>30-May-92<tt> </tt>&nbsp;<tt> </tt>&nbsp;V0.0 Prototype created               <tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
15-jul-03<tt> </tt>&nbsp;<tt> </tt>&nbsp;V0.7 documentated some recent changes<tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
</pre><p>

<hr><p>
<a name='toc'><b>Table of Contents</b></a><p>
<ul>
<li><a name='toc0' href='#sect0'>Name</a></li>
<li><a name='toc1' href='#sect1'>Synopsis</a></li>
<li><a name='toc2' href='#sect2'>Description</a></li>
<li><a name='toc3' href='#sect3'>Parameters</a></li>
<li><a name='toc4' href='#sect4'>Bugs</a></li>
<li><a name='toc5' href='#sect5'>See Also</a></li>
<li><a name='toc6' href='#sect6'>Author</a></li>
<li><a name='toc7' href='#sect7'>Update History</a></li>
</ul>
</body>
</html>
