<!-- manual page source format generated by PolyglotMan v3.2, -->
<!-- available at http://polyglotman.sourceforge.net/ -->

<html>
<head>
<title>PERORB(1NEMO) manual page</title>
</head>
<body bgcolor='white'>
<a href='#toc'>Table of Contents</a><p>

<h2><a name='sect0' href='#toc0'>Name</a></h2>
perorb - find periodic orbits in symmetric potentials 
<h2><a name='sect1' href='#toc1'>Synopsis</a></h2>
<p>
<b>perorb
<b>out=</b></b>orbit [parameter=value] 
<h2><a name='sect2' href='#toc2'>Description</a></h2>
<i>perorb</i> searches for periodic orbits
in two ways: <p>
In the iterative mode it will integrate an orbit for a half
or whole period, and iteratively converge towards a periodic orbit assuming
regular phase space where the surface of section is a single point. It uses
a convergence criterion in the surface of section coordinates. It then can
proceed, and attempt to find family members with slightly different energies
or spatial extent. The orbits can be stored in a binary file along the way,
and also a table with major an minor axis rotation curves, period, energy
and average angular momentum can be stored in a table. <p>
In the interactive
mode (ncross&gt;1) the selected orbits are integrated for a specified number
of surface of section (S.O.S.) crossings, and their S.O.S.  coordinates are plotted;
from a visual inspection the central  periodic orbit(s) can then be estimated
at this energy, and used to get good estimates in the iterative mode to
find the periodic orbits. <p>
This technique has been used in various forms
by various researchers,  and is described in its most original form in
 Henon (1965, Ann.Astr. 28, 499). See also El-Sabaa &amp; Sherief (1990) Ap&amp;SS 167,
305 for some more recent work. <p>
Alternatives approaches are the Particle
Swarm Optimization (Skokos et al. 2005). There is also code by T.S.v Albada,
but not yet released in NEMO. 
<h2><a name='sect3' href='#toc3'>Parameters</a></h2>
The following parameters are recognized
in any order if the keyword is also given: 
<dl>

<dt><b>in=<i>in-file</i></b> </dt>
<dd>An optional input
file in standard <a href='orbit.5.html'><i>orbit(5NEMO)</i></a>
 format. If given, the input conditions are
taken from the first phase point in this orbit (using the keyword <b>last=</b>
 you can select the last orbit). Default: none. <b>out=<i>out-file</i></b> output file,
into which the orbits are accumulated. The file is in standard <a href='orbit.5.html'><i>orbit(5NEMO)</i></a>

format. If no filename is given, the iterative mode is followed. [Default:
none]. </dd>

<dt><b>freqout=<i>rate</i></b> </dt>
<dd>Frequency for output of the timeslots for the periodic
orbits.  <i>Only used in iterative mode.</i> [default: <b>1</b>]. </dd>

<dt><b>maxsteps=<i>number</i></b> </dt>
<dd>maximum
number of reserved integration steps. [default: <b>5000</b>]. </dd>

<dt><b>dt=<i>time-step</i></b> </dt>
<dd>time step
(constant) to be taken [default: <b>0.05</b>]. </dd>

<dt><b>phase=<i>trial-phase</i></b> </dt>
<dd>Initial trial phase
space coodinates for orbit. The full 6 phase-space coordinates can specified,
although you can also specify the (x0,v0) for dirint=0 or (y0,u0) for dirint=1.
If a 7th (or 3rd) number is given (optional),  this is taken as the trial
energy for the first orbit. The trial launch velocity is then calculated
from the available potential at the specified launch position. </dd>

<dt><b>step=<i>step,perturb</i></b>
</dt>
<dd>Step in phase space to take to get next orbit (the step is taken in the
direction given by the <b>dir</b> keyword. The second number is the perturbation
in direction <b>dir</b> used to start the first iteration that should result in
finding the periodic orbit. Default: 0.1,0.01 </dd>

<dt><b>dir=x|y</b> </dt>
<dd>Direction in which to
step for next orbit. This also determines in which surface of section the
searching for the periodic orbit is done. Only <b>x</b> and <b>y</b> are allowed for now,
since only planar XY-orbits are handled properly. </dd>

<dt><b>norbit=<i>n</i></b> </dt>
<dd>Number of orbits
to investigate. [Default: 1] </dd>

<dt><b>accuracy=<i>eps</i></b> </dt>
<dd>A relative accuracy parameter
to which the final surface of section coordinate is to be accurate.  <i>Only
used in iterative mode.</i> [Default: 0.001]. </dd>

<dt><b>maxiter=</b> </dt>
<dd>Maximum iterations allowed
to find a periodic orbit. Default: 50. </dd>

<dt><b>ncross=<i>count</i></b> </dt>
<dd>Number of crossings through
surface of section used to plot/iterate. This count does include the  half-period
crossings if the keyword <b>period=2</b> is choosen. If set larger than 1, interactive
mode is used. [default: <b>1</b>] </dd>

<dt><b>period=2|1</b> </dt>
<dd>The number of surface of section coordinates
to generate per period. Must be either 1 or 2. A value of 2 make search faster,
but a bit more difficult for irregular orbits or near resonances. Also non-symmetric
orbits cannot be found this way. [default: <b>2</b>]. </dd>

<dt><b>potname=<i>name</i></b> </dt>
<dd>name of file
of <a href='potential.5.html'><i>potential(5NEMO)</i></a>
 descriptor  [default: <b>plummer</b>]. </dd>

<dt>potpars=<i>par-list</i> </dt>
<dd>List
of parameters to the potential descriptor. The first parameter must be the
pattern speed in the x-y plane, although rotating frames of reference are
not yet supported. The remaining parameters are used by the <i>_inipotential()</i>
routine in the potential descriptor. [default: none - let them be defined
by routine itself]. </dd>

<dt><b>potfile=<i>name</i></b> </dt>
<dd>name of an optional datafile to the potential
descriptor. This might be an N-body snapshot or list of spline fit coefficients
etc. [default: none]. </dd>

<dt><b>tab=<i>table_file</i></b> </dt>
<dd>If set to a filename, a table, which
normally appears on <i>stdout</i> is now written to a file. It contains the two
axes rotation curves, number of steps in the orbit, numer of iterations
in surface of section, the full period and  the energy: <i>pos,vel,pos,vel,nsteps,niter,period,energy</i>.
[Default: none]. </dd>

<dt><b>mode=<i>int_mode</i></b> </dt>
<dd>Specify the integration mode. Any one of <b>euler</b>,
<b>leapfrog</b>, <b>rk2</b> or <b>rk4</b>  can be given. [Default: <b>rk4</b>]. </dd>

<dt><b>last=t|f</b> </dt>
<dd>Controls which
orbit from the input file is used for the initial conditions. By default,
the first one, otherwise the last. Default: <b>f</b>. </dd>

<dt><b>headline=</b> </dt>
<dd>Random user verbiage
added to the output file. Default:none </dd>
</dl>

<h2><a name='sect4' href='#toc4'>Caveats</a></h2>
The potential (potname= etc)
needs to have a proper potential defined for this routine to work. 
<h2><a name='sect5' href='#toc5'>Examples</a></h2>
By
default, perorb will find a circular orbit in a plummer potential near
R=1: <br>
<pre>perorb
INIPOTENTIAL Plummer: [3d version]
### Warning [perorb]: DRY RUN: No output orbit file created
#  x0       v0       y1        x1    NPT NITER PERIOD   ETOT    LZ_MEAN
  ETOT_ERR
1.007320 0.595679 1.007323 -0.595674 533 3 10.625226 -0.527107 -0.600039 4.08912e-06
</pre>The printed columns are pos1(t=0), vel2(t=0), pos2(t=P/2), vel1(t=P/2),
l, iter,  Period, Energy, meanAngMom.  See also <a href='orbstat.1.html'><i>orbstat(1NEMO)</i></a>
 for another
view of the statistics of these orbits, showing the curious property of
the 1:1 resonance orbit in a logarithmic potential  <br>
<pre>% perorb potname=log potpars=0,1,1,0.9 norbit=10 out=log.orb
#  x0      v0        y1        x1    NPT NITER PERIOD   ETOT   LZ_MEAN
   ETOT_ERR
0.956311 0.675829 0.629557 -1.140210 280 5 5.560441 0.984048 -0.679534 -1.4864e-05
1.020431 0.731892 0.706384 -1.174306 290 5 5.761082 1.094431 -0.785260 -1.55914e-06
1.086113 0.781263 0.781720 -1.205717 300 5 5.972464 1.203861 -0.892278 -1.50248e-05
1.153376 0.825038 0.856210 -1.234575 311 5 6.194336 1.312000 -1.000653 -7.58749e-06
1.222193 0.864064 0.930308 -1.260978 323 4 6.426479 1.418565 -1.110458 -1.37877e-05
1.292542 0.898976 1.004360 -1.285151 335 4 6.668597 1.523326 -1.221855 -7.93163e-06
1.364403 0.930272 1.078516 -1.307186 348 4 6.920329 1.626100 -1.334623 -1.17395e-05
1.437707 0.958411 1.153092 -1.327410 361 4 7.181385 1.726745 -1.448891 -8.47802e-06
1.512414 0.983745 1.228047 -1.345782 374 4 7.451368 1.825161 -1.564586 -9.25693e-06
1.588487 1.006573 1.303499 -1.362555 388 4 7.729841 1.921275 -1.681411 -8.9171e-06
% orbstat log.orb
# T<tt> </tt>&nbsp;<tt> </tt>&nbsp;E<tt> </tt>&nbsp;<tt> </tt>&nbsp;x_max<tt> </tt>&nbsp;<tt> </tt>&nbsp;y_max<tt> </tt>&nbsp;<tt> </tt>&nbsp;u_max<tt> </tt>&nbsp;<tt> </tt>&nbsp;v_max<tt> </tt>&nbsp;<tt> </tt>&nbsp;j_mean<tt> </tt>&nbsp;<tt> </tt>&nbsp;j_sigma
0 0.984048 0.629601 0.956311 0.675829 1.14031 -0.679593 0.0252821
0 1.09443 0.706429 1.02043 0.731892 1.1744 -0.785327 0.0292126
0 1.20386 0.781738 1.08611 0.781263 1.20575 -0.892351 0.0331657
0 1.312 0.85621 1.15338 0.825038 1.23457 -1.00073 0.037188
0 1.41857 0.930308 1.22219 0.864064 1.26098 -1.11054 0.0412889
0 1.52333 1.00436 1.29254 0.898976 1.28515 -1.22194 0.0454228
0 1.6261 1.07857 1.3644 0.930272 1.30726 -1.33472 0.0496375
0 1.72675 1.15309 1.43771 0.958411 1.32741 -1.44899 0.0538812
0 1.82516 1.22807 1.51241 0.983745 1.34581 -1.56469 0.0581483
0 1.92128 1.30352 1.58849 1.00657 1.36259 -1.68152 0.0624934
% orbstat log.orb | tabmath - - &rsquo;(%4*%5)/(%3*%6)&rsquo; all
0.900218 
0.900214 
0.900228 
0.900224 
0.900222 
0.90022 
0.900205 
0.900233 
0.900213 
0.900214 
</pre>
<p> The last command  shows the ratio of the angular momentum along the major
and minor axis, and that they equal the axis ratio (q) of the potential.

<p> <p>
In interactive mode the Time,Ycross,VYcross,Energy for each surface of
section are listed, and can be piped into tabplot to get an idea of phase
space and help you getter better initial conditions. <br>
<pre>1% perorb potname=log potpars=0.1,1,1,0.9 phase=0.1,-0.2 ncross=50
#  Time    Ycross    VYcross    Energy
2.36021 0.0947884 -0.0301556 0.0322215
4.70673 0.0817796 -0.0484523 0.0322859
2% perorb potname=log potpars=0.1,1,1,0.9 phase=0.1,-0.2 ncross=50 | tabplot
- 2 3
3% perorb potname=log potpars=0.1,1,1,0.9 phase=0.1,-0.2 ncross=50 | tablsqfit
- 2 3 fit=ellipse

 x-center:        0.0732815
 y-center:        1.0291e-06

4% perorb potname=log potpars=0.1,1,1,0.9 phase=0.1,-0.2,0.0322215
# y0      u0        x1        v1     NPT   NITER PERIOD   ETOT  LZ_MEAN
  ETOT_ERR
0.074508 -0.225473 -0.166434 -0.100333 234 6 4.650688 0.032222 0.029217 -3.71096e-06
</pre>
<p> In the 1st example we establish that energy is roughly conserved (and
the value is 0.0322215). The 2nd example plots the SOS. The 3rd example takes
column 2 and 3 and fits an ellipse and reports the center. The 4th example
tries to reproduce the periodic orbit with that specified energy. 
<p> 
<h2><a name='sect6' href='#toc6'>See Also</a></h2>
<a href='orbstat.1.html'>orbstat(1NEMO)</a>
,
<a href='potlist.1.html'>potlist(1NEMO)</a>
, <a href='orbint.1.html'>orbint(1NEMO)</a>
, <a href='newton0.1.html'>newton0(1NEMO)</a>
, <a href='potential.5.html'>potential(5NEMO)</a>
 <br>
<pre>Particle Swarm Optimization (PSO): Skokos et al. - 2005MNRAS.359..251S
</pre>
<h2><a name='sect7' href='#toc7'>Author</a></h2>
Peter Teuben 
<h2><a name='sect8' href='#toc8'>Files</a></h2>
<br>
<pre>pjt/orbit<tt> </tt>&nbsp;<tt> </tt>&nbsp;original sources
</pre>
<h2><a name='sect9' href='#toc9'>Update History</a></h2>
<br>
<pre>1980s       <tt> </tt>&nbsp;<tt> </tt>&nbsp;V0.x Teuben&rsquo;s thesis work (written in SHELTRAN)<tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
22-may-90<tt> </tt>&nbsp;<tt> </tt>&nbsp;V1.0 created from old Cyber CDC-7600 program &rsquo;PERORB&rsquo;  PJT
24-may-91<tt> </tt>&nbsp;<tt> </tt>&nbsp;V1.1 rotating XY-frames, fixed energy option  PJT
19-apr-95<tt> </tt>&nbsp;<tt> </tt>&nbsp;V1.5 various, rk4 is now default integrator<tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
1-mar-03<tt> </tt>&nbsp;<tt> </tt>&nbsp;minor code cleanup, less lies in the man page, added etot_err<tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
19-aug-04<tt> </tt>&nbsp;<tt> </tt>&nbsp;V1.6 added last= and fixed an allocation problem<tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
29-oct-2019<tt> </tt>&nbsp;<tt> </tt>&nbsp;V1.7 allow phase= with 2 or 3 values<tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
</pre><p>

<hr><p>
<a name='toc'><b>Table of Contents</b></a><p>
<ul>
<li><a name='toc0' href='#sect0'>Name</a></li>
<li><a name='toc1' href='#sect1'>Synopsis</a></li>
<li><a name='toc2' href='#sect2'>Description</a></li>
<li><a name='toc3' href='#sect3'>Parameters</a></li>
<li><a name='toc4' href='#sect4'>Caveats</a></li>
<li><a name='toc5' href='#sect5'>Examples</a></li>
<li><a name='toc6' href='#sect6'>See Also</a></li>
<li><a name='toc7' href='#sect7'>Author</a></li>
<li><a name='toc8' href='#sect8'>Files</a></li>
<li><a name='toc9' href='#sect9'>Update History</a></li>
</ul>
</body>
</html>
