<!-- manual page source format generated by PolyglotMan v3.2, -->
<!-- available at http://polyglotman.sourceforge.net/ -->

<html>
<head>
<title>NBODY5(1NEMO) manual page</title>
</head>
<body bgcolor='white'>
<a href='#toc'>Table of Contents</a><p>

<h2><a name='sect0' href='#toc0'>Name</a></h2>
nbody5 - Regularized AC N-body code with triple &amp; binary collisions. 
<h2><a name='sect1' href='#toc1'>Synopsis</a></h2>
<b>nbody5
 &lt;  parameter_file &gt; log_file</b> 
<h2><a name='sect2' href='#toc2'>Description</a></h2>
<i>nbody5</i> is a regularized Ahmed-Cohen
N-body code with  triple &amp; binary collisions. <p>

<h2><a name='sect3' href='#toc3'>Parameters</a></h2>
The input parameters
are given in a small ASCII <b>parameter_file</b> (which can also be read from
standard input) in the  order as detailed below <p>
Example input <b>parameter_file</b>
for the standard  internal benchmark (a 100-body problem integrated for
20 crossing times): <br>
<pre>1 1000.0                            <tt> </tt>&nbsp;<tt> </tt>&nbsp;KSTART TCOMP
100 5 10 30 35 1                    <tt> </tt>&nbsp;<tt> </tt>&nbsp;N NFIX NCRIT NRAND NNBMAX NRUN
0.02 0.03 0.4 1.0 1.0 20.0 5.0e-05 1.0 0.6<tt> </tt>&nbsp;<tt> </tt>&nbsp;ETAI ETAR RS0 DTADJ DELTAT TCRIT QE RBAR
ZMBAR
1 2 0 0 1 0 1 0 0 0                         <tt> </tt>&nbsp;<tt> </tt>&nbsp;KZ(J), J=1,40
0 0 0 1 1 1 1 0 0 1
1 0 2 0 0 1 0 0 0 1
0 1 0 0 0 0 0 0 0 0
2.0e-05 1.0e-03 0.1 1.0 1.0e-06 0.01       <tt> </tt>&nbsp;<tt> </tt>&nbsp;DTMIN RMIN ETAU ECLOSE GMIN GMAX
2.3 1.1 0.1 0                             <tt> </tt>&nbsp;<tt> </tt>&nbsp;ALPHAS, BODY1, BODYN, NBIN0
0.5 0.0 0.0 0.0                            <tt> </tt>&nbsp;<tt> </tt>&nbsp;Q VXROT VZROT RSPH2
</pre>(for comparison the original NBODY1 default parameter set:) <br>
<pre>1 1.0                             <tt> </tt>&nbsp;<tt> </tt>&nbsp;KSTART TCOMP
25 1 10 1                           <tt> </tt>&nbsp;<tt> </tt>&nbsp;N NFIX NRAND NRUN
0.02 1.0 5.0 2.0E-05 0.03            <tt> </tt>&nbsp;<tt> </tt>&nbsp;ETA DELTAT TCRIT QE EPS
1 0 0 0 1 1 0 0 0 0 0 0 0 0 0      <tt> </tt>&nbsp;<tt> </tt>&nbsp;KZ(J), J=1,15
2.5 5.0 1.0                        <tt> </tt>&nbsp;<tt> </tt>&nbsp;ALPHAS BODY1 BODYN
0.5 0.0 0.0 1.0 1.0                 <tt> </tt>&nbsp;<tt> </tt>&nbsp;Q VXROT VZROT RBAR ZMBAR
</pre>Note: the order of input lines may change depending on previous ones (<b>KSTART</b>
and <b>KZ</b>&rsquo;s in particular) <p>
Here are, for completeness,the READ statements from
the source code <p>
<br>
<pre>binpop.f:      READ (5,*)  NBIN, SEMI0, ECC0, RATIO, RANGE, NSKIP, IDORM
cloud0.f:      READ (5,*)  NCL, RB2, VCL, SIGMA, (CLM(J),J=1,NCL),
data.f:        READ (10,*)  BODY(I), (X(K,I),K=1,3), (XDOT(K,I),K=1,3)
data.f:       - READ (5,*)  ALPHAS, BODY1, BODYN, NBIN0
hotsys.f:      READ (5,*)  SIGMA0
input.f:       READ (5,*)  N, NFIX, NCRIT, NRAND, NNBMAX, NRUN
input.f:      - READ (5,*)  ETAI, ETAR, RS0, DTADJ, DELTAT, TCRIT, QE, RBAR,
ZMBAR
input.f:      - READ (5,*)  (KZ(J),J=1,40)
input.f:      - READ (5,*)  DTMIN, RMIN, ETAU, ECLOSE, GMIN, GMAX
input.f:       READ (5,*)  DELTAS, ORBITS(1), (GPRINT(J),J=1,K)
intide.f:      READ (5,*)  RSTAR, RTSTAR, RSYNC, EPOCH0
intide.f:      READ (5,*)  IMS, IEV, RMS, REV, IMF
modify.f:      READ (5,*)  DTA, DT, TA, TN, TC, QE1, J, K
modify.f:      READ (5,*)  ETA1, ETA2, ETA3, DTM, RM
mydump.f:     - READ (J,ERR=10,END=10)  DUMMY
mydump.f:     - READ (J)   A, B, IC, ID, E, F, G, H, IR
nbody5.f:     - READ (5,*)  KSTART, TCOMP
scale.f:      - READ (5,*)  Q, VXROT, VZROT, RSPH2
scale.f:       READ (5,*)  (X(J,I),J=1,3), (XDOT(J,I),J=1,3)
</pre>
<p> <p>
<i>Definition of input parameters:</i> (parameters with  a <b>*</b> start on a new line;
their type is the implicit FORTRAN specification: [I-N] for integers, [A-H,O-Z]
for floating point parameters) <p>

<dl>

<dt><b>* KSTART</b> </dt>
<dd>Control index (1: new run; &gt;1: restart;
&gt;2: new params). </dd>

<dt><b>  TCOMP   </b> </dt>
<dd>Maximum computing time in minutes, if the software
knows how to compute it. </dd>

<dt><b>* N       </b> </dt>
<dd>Total particle number (the program is
compiled with a maximum, NMAX) </dd>

<dt><b>  NFIX    </b> </dt>
<dd>Output frequency, in terms of
<b>DELTAT</b>, of data save or binaries (option 3 &amp; 6). </dd>

<dt><b>  NRAND   </b> </dt>
<dd>Random number
sequence skip. </dd>

<dt><b>  NRUN    </b> </dt>
<dd>Run identification index. </dd>

<dt><b>* ETA     </b> </dt>
<dd>Time-step accuracy
parameter for total force polynomial. </dd>

<dt><b>  DELTAT  </b> </dt>
<dd>Output time interval in
units of the crossing time. </dd>

<dt><b>  TCRIT   </b> </dt>
<dd>Termination time in units of the
crossing time. </dd>

<dt><b>  QE      </b> </dt>
<dd>Energy tolerance (stop if DE/E &gt; 5*QE &amp; <a href='KZ.2.html'>KZ(2)</a>
 &lt;=
1; restart if <a href='KZ.2.html'>KZ(2)</a>
 &gt; 1)  </dd>

<dt><b>  EPS     </b> </dt>
<dd>Softening parameter. </dd>

<dt><b>* KZ(J)   </b> </dt>
<dd>Non-zero
options for alternative paths (see table below). </dd>

<dt><b>* ALPHAS  </b> </dt>
<dd>Power-law index
for initial mass function. (option 4 not 2) </dd>

<dt><b>  BODY1   </b> </dt>
<dd>Maximum particle
mass (before scaling, if scaling option KJ(10) choosen). </dd>

<dt><b>  BODYN   </b> </dt>
<dd>Minimum
particle mass before scaling. </dd>

<dt><b>* Q       </b> </dt>
<dd>Virial ratio (Q = 0.5 for equilibrium).
</dd>

<dt><b>  VXROT   </b> </dt>
<dd>XY-velocity scaling factor (&gt; 0 for solid-body rotation). </dd>

<dt><b>  VZROT
  </b> </dt>
<dd>Z-velocity scaling factor (not used if VXROT = 0). </dd>

<dt><b>  RBAR    </b> </dt>
<dd>Virial radius
in pc (for scaling to physical units). </dd>

<dt><b>  ZMBAR   </b> </dt>
<dd>Mean mass in solar units.
</dd>

<dt><b>* NFRAME  </b> </dt>
<dd>Maximum number of movie frames (option 7). </dd>

<dt><b>  DELTAF  </b> </dt>
<dd>Time interval
for movie output (in units of crossing time). </dd>

<dt><b>* XCM     </b> </dt>
<dd>Displacement for
subsystem (option 8). </dd>

<dt><b>  ECC     </b> </dt>
<dd>Eccentricity of relative motion for subsystem
(ECC =&lt; 1). </dd>

<dt><b>* SEMI    </b> </dt>
<dd>Semi-major axis of binary orbit (options 10 &amp; 12). </dd>

<dt><b> 
ECC     </b> </dt>
<dd>Eccentricity of binary. </dd>
</dl>
<p>
<i>Definition of options KZ:</i> 
<dl>

<dt><b>KZ(J)   </b> </dt>
<dd><br>
<pre>  1  COMMON save on unit 1 if TCOMP &gt; CPU or if TIME &gt; TCRIT.
  2  COMMON save on unit 2 at output (=1); restart if DE/E &gt; 5*QE &lt;=2).
  3  Basic data written to unit 3 at output time (frequency NFIX). File:
OUT3
  4  Initial conditions on unit 4 (=1: output; =2: input; 3=input+output).
  5  Initial conditions (=0: uniform &amp; isotropic; =1: Plummer law).
  6  Output of significant binaries on printout.
  7  Output of movie frames on unit 7 (read NFRAME, DELTAF).
  8  Generation of two subsystems (merger experiment) (read XCM, ECC).
  9  Individual bodies printed at output time (MIN(5**KZ9,N)).
 10  No scaling of initial conditions to physical units.
 11  Modification of ETA by tolerance QE.
 12  Initial parameters for binary orbit (read SEMI, ECC).
 13  Escaper removal (R &gt; 2*RTIDE; RTIDE = 10*RSCALE).
 14  Adjustment of coordinates &amp; velocities to c.m. condition.
 15  --read but not used--
</pre><br>
</dd>
</dl>

<h2><a name='sect4' href='#toc4'>Input Order</a></h2>
The order of the input lines is very important,  and can depend
on previous lines. Here&rsquo;s a sketch that hopefully helps you in creating input
parameter files. Basically there are two types of input files: 1) a new
run, and 2) restart of an unfinished run. <br>
<pre>read: KSTART, TCOMP
if KSTART=1 then          new run
    read: N, NFIX, NRAND, NRUN                        <tt> </tt>&nbsp;<tt> </tt>&nbsp;input.f
    read: ETA, DELTAT, TCRIT, QE, EPS                 <tt> </tt>&nbsp;<tt> </tt>&nbsp;input.f
    read: KZ(J),J=1,15                                <tt> </tt>&nbsp;<tt> </tt>&nbsp;input.f
    if KZ(4)=2 then
        read(unit 4)                                  <tt> </tt>&nbsp;<tt> </tt>&nbsp;data.f
    else
        read: ALPHAS, BODY1, BODYN                    <tt> </tt>&nbsp;<tt> </tt>&nbsp;data.f
    endif
    if KZ(12)&gt;0 then
        read: SEMI, ECC                               <tt> </tt>&nbsp;<tt> </tt>&nbsp;data.f
    endif
    read: Q, VXROT, VZROT, RBAR, ZMBAR                <tt> </tt>&nbsp;<tt> </tt>&nbsp;scale.f
    if KZ(7)&gt;0 then
        read: NFRAME, DELTAF                          <tt> </tt>&nbsp;<tt> </tt>&nbsp;scale.f
    endif
    
    if KZ(8)&gt;0 then
        read: XCM, ECC                                <tt> </tt>&nbsp;<tt> </tt>&nbsp;subsys.f
    endif
else 
    read (unit=1)       restart             <tt> </tt>&nbsp;<tt> </tt>&nbsp;nbody1.f
    if (KSTART&gt;2)       restart with new parameters
        if KSTART=4 then
            ...
        else
            read: DELTAT, TNEXT, TCRIT, QE, J, KZ(J)   <tt> </tt>&nbsp;<tt> </tt>&nbsp;modify.f
        endif
        if KSTART&gt;=4 then
            read: ETA                                 <tt> </tt>&nbsp;<tt> </tt>&nbsp;modify.f
        endif
    endif
endif
</pre>
<h2><a name='sect5' href='#toc5'>Benchmark</a></h2>
The above benchmark 100-body 20 crossing time experiment takes:
<br>
<pre>486dx2-66 linux 1.2.3      <tt> </tt>&nbsp;<tt> </tt>&nbsp;433"<tt> </tt>&nbsp;<tt> </tt>&nbsp;-O
sparc 10/30 (bootes)      <tt> </tt>&nbsp;<tt> </tt>&nbsp;250"<tt> </tt>&nbsp;<tt> </tt>&nbsp;-O
sparc 20/50? (phoenix)      <tt> </tt>&nbsp;<tt> </tt>&nbsp; 90"<tt> </tt>&nbsp;<tt> </tt>&nbsp;-O
sparc 20/50? (phoenix)      <tt> </tt>&nbsp;<tt> </tt>&nbsp; 96"!!<tt> </tt>&nbsp;<tt> </tt>&nbsp;-O4 -libmil -cg92 (bizarre!)
</pre>
<h2><a name='sect6' href='#toc6'>Nemo</a></h2>
For NEMO the following modifications would have to be made in order
for other programs to work: 
<dl>

<dt><b>Ncode/output.fP </b></dt>
<dd>The INTEGER*2 NAME(NMAX) array,
defined in common5.h should not be output to OUT3, instead a local INTEGER
NAMEO(NMAX) is used for this. This in order for <a href='u3tos.1NEMO.html'><i>u3tos(1NEMO)</i></a>
 to work. </dd>

<dt>xxx
</dt>
<dd>Various as yet undocumented changes by pjtl (and es). </dd>
</dl>

<h2><a name='sect7' href='#toc7'>Author</a></h2>
Sverre Aarseth
- sverre@mail.ast.cam.ac.uk 
<h2><a name='sect8' href='#toc8'>Files</a></h2>
<br>
<pre>fort.1<tt> </tt>&nbsp;<tt> </tt>&nbsp;common block restart dump file (option 1)
fort.2<tt> </tt>&nbsp;<tt> </tt>&nbsp;common block restart dump file (option 2)
OUT3<tt> </tt>&nbsp;<tt> </tt>&nbsp;output file (option 3)
fort.4<tt> </tt>&nbsp;<tt> </tt>&nbsp;initial conditions input or output file  (option 4) *** not in nbody5
***
fort.7<tt> </tt>&nbsp;<tt> </tt>&nbsp;formatted frame files (option 7) *** not in nbody5 ***
OUT9<tt> </tt>&nbsp;<tt> </tt>&nbsp;???
ESC<tt> </tt>&nbsp;<tt> </tt>&nbsp;ascii file containing the times of each escaper
STOP<tt> </tt>&nbsp;<tt> </tt>&nbsp;control file, when exists, program will prematurely stop.
</pre>
<h2><a name='sect9' href='#toc9'>See Also</a></h2>
<a href='u1tos.1NEMO.html'>u1tos(1NEMO)</a>
, <a href='u3tos.1NEMO.html'>u3tos(1NEMO)</a>
, <a href='u4tos.1NEMO.html'>u4tos(1NEMO)</a>
, <a href='stou4.1NEMO.html'>stou4(1NEMO)</a>
 <p>
<i>Direct Methods
for N-Body Simulations</i> by S.J. Aarseth in:  <i>Multiple Time Scales</i>, eds. J.U. Brackbill
&amp; B.L. Cohen,  Academic Press, p. 377 (1984). <p>
NBODY0 source code in Binney &amp;
Tremaine&rsquo;s <i>Galactic Dynamics</i>  (Princeton University Press, 1987). pp.678. <p>
<i>Small-N
Systems</i> by S.J. Aarseth in: <i>XXX</i> eds. Benz, Barnes and XXX (<i>to be published</i>,
1994) 
<h2><a name='sect10' href='#toc10'>History</a></h2>
<br>
<pre>22-may-95<tt> </tt>&nbsp;<tt> </tt>&nbsp;manual page written<tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
</pre><p>

<hr><p>
<a name='toc'><b>Table of Contents</b></a><p>
<ul>
<li><a name='toc0' href='#sect0'>Name</a></li>
<li><a name='toc1' href='#sect1'>Synopsis</a></li>
<li><a name='toc2' href='#sect2'>Description</a></li>
<li><a name='toc3' href='#sect3'>Parameters</a></li>
<li><a name='toc4' href='#sect4'>Input Order</a></li>
<li><a name='toc5' href='#sect5'>Benchmark</a></li>
<li><a name='toc6' href='#sect6'>Nemo</a></li>
<li><a name='toc7' href='#sect7'>Author</a></li>
<li><a name='toc8' href='#sect8'>Files</a></li>
<li><a name='toc9' href='#sect9'>See Also</a></li>
<li><a name='toc10' href='#sect10'>History</a></li>
</ul>
</body>
</html>
