<!-- manual page source format generated by PolyglotMan v3.2, -->
<!-- available at http://polyglotman.sourceforge.net/ -->

<html>
<head>
<title>TABLSQFIT(1NEMO) manual page</title>
</head>
<body bgcolor='white'>
<a href='#toc'>Table of Contents</a><p>

<h2><a name='sect0' href='#toc0'>Name</a></h2>
tablsqfit - general purpose least squares fitting program 
<h2><a name='sect1' href='#toc1'>Synopsis</a></h2>
<p>
<b>tablsqfit
in=</b>table-file [parameter=value] 
<h2><a name='sect2' href='#toc2'>Description</a></h2>
<b>tablsqfit</b> takes a least squares
fit (minimized ChiSquared) of a set of datapoints (x(i),y(i)) where a functional
form y=f(x;a1,a2,...,an) is assumed. The functional form to be fitted has to
be specified by name at this stage. A number of options are possible. <p>
The
inputfile is an ascii file in a tabular format, where on every line there
must be an assigned column for the X- and Y-coordinates. An optional column
can be assigned to the errors in Y (the DY-coordinates). If no DY-column is
assigned, it is assumed that the errors in Y are all the same and equal
to 1. Lines starting with the &rsquo;#&rsquo; symbol are comment  lines. Certain models
(see <b>fit=</b> below) allow multiple X or Y columns. For <b>fit=line</b> a proper goodness-of-fit
is also  computed in a second fit an error column (<b>dycol=</b>) is given. <p>
For
most linear functions the non-linear version of this program will also work
fine, and has the added power that certain parameters can be fixed, and
error estimates are returned. See <a href='tabnllsqfit.1NEMO.html'><i>tabnllsqfit(1NEMO)</i></a>
. 
<h2><a name='sect3' href='#toc3'>Parameters</a></h2>
The following
parameters are recognized in any order if the keyword is also given: 
<dl>

<dt><b>in=<i>in-file</i></b>
</dt>
<dd>(ascii) input file, a table of values from which data is taken. No default.
</dd>

<dt><b>xcol=<i>col,...</i></b> </dt>
<dd>The column(s) from which the (independant)  X-values are taken.
The first column is called 1 by definition [default: <b>1</b>]. </dd>

<dt><b>ycol=<i>col,...</i></b> </dt>
<dd>The column(s)
from which the (dependant)  Y-values are taken [default: <b>2</b>]. </dd>

<dt><b>dxcol=<i>int</i></b> </dt>
<dd>Optional
column from which the DX-values (errors in X) are taken.  Currently only
a straight line fit can use this option. See below. </dd>

<dt><b>dycol=<i>int</i></b> </dt>
<dd>Optional column
from which the DY-values (errors in Y) are taken. The inverse square of the
errors are uses as weights for those fits where these are used  [default:
none assigned]. </dd>

<dt><b>xrange=<i>xmin:xmax</i></b> </dt>
<dd>Range in X-values for which the fit is done.
If only one number is given, the other one is considered zero. [default:
no entry, i.e. all]. </dd>

<dt><b>fit=</b><i>model</i> </dt>
<dd>Model name what to fit. Currently implemented
are <i>line</i>, <i>plane</i>, <i>poly</i>, <i>ellipse</i>, <i>peak</i>, <i>zero</i>, <i>imageshift</i>, <i>area</i>,  <i>gauss1d</i>,
and <i>gauss2d</i>. [default: <b>line</b>]. </dd>

<dt><b>order=</b><i>order</i> </dt>
<dd>Highest order of the polynomial
fit (<b>fit=poly</b>) or  dimension of the hyper-plane fit (<b>fit=plane</b>). 0 would
fit a constant. 0 and 1 would have the same meaning in both the <b>plane</b> and
<b>poly</b> cases [Default: <b>0</b>]. </dd>

<dt>out=<i>filename</i> </dt>
<dd>Optional output filename (only active
under certain options) where the data and residuals are stored. Column 1,
2 and 3 will contain the X, Y and residuals F(X)-Y respectively. A future
release will also store the errors (if it was given, see  keyword <b>dycol</b>
above) in the 4th column. [default: empty, no output file created]. </dd>

<dt>nsigma=<i>sigma_factor</i>
</dt>
<dd>A positive number will delete points more than <i>sigma_factor</i> from the fit,
and fit again. [Default: <b>-1</b>]. </dd>

<dt><b>estimate=</b> </dt>
<dd>Optional estimate for parameters of
non-linear fits </dd>

<dt><b>nmax=</b><i>max_lines</i> </dt>
<dd>Maximum number of lines allocated if the
input file was being read from a pipe. If not, the routine <a href='file_lines.3NEMO.html'><i>file_lines(3NEMO)</i></a>

is used to allocate space for the table. [Default: <b>10000</b>]. </dd>

<dt><b>mpfit=</b><i>mode</i> </dt>
<dd>The
fitting mode in which <a href='mpfit.3NEMO.html'><i>mpfit(3NEMO)</i></a>
 is used. 0=no errors. 1=only errors in
X used  (dxcol=), 2=only errors in Y used (dycol=), 3=errors in both X
and Y used. See also <a href='linreg.1NEMO.html'><i>linreg(1NEMO)</i></a>
. </dd>

<dt><b>tab=t|f</b> </dt>
<dd>Output results in simple tabular
format. Default: false. </dd>
</dl>

<h2><a name='sect4' href='#toc4'>Example</a></h2>
Here is an example of creating an on-the-fly
table with a straight line, with some added noise and random weights between
1 and 2: <br>
<pre>% nemoinp 1:100 | tabmath - - "%1+rang(0,10),ranu(1,2)" seed=123 | tablsqfit
-
      a  =    0.974146       uncertainty:  0.039389 
      b  =    1.755022       uncertainty:  2.291149 
      x0 =   -1.801599       uncertainty:  2.353083
      y0 =    1.755022       uncertainty:  2.291149
      chi-squared:    12668.983284 
      goodness-of-fit:    1.000000 (no Y errors supplied [dycol=])
      r:  0.92923
      prob:  3.65557e-44
      z:  1.65272
</pre>The fitted line is written either as <b>y=ax+b</b> or alternatively with their
(x0,y0) intercepts as <b>x/x0 + y/y0=1</b>. 
<h2><a name='sect5' href='#toc5'>See Also</a></h2>
<a href='tabhist.1NEMO.html'>tabhist(1NEMO)</a>
, <a href='tabmath.1NEMO.html'>tabmath(1NEMO)</a>
,
<a href='gaussfit.1NEMO.html'>gaussfit(1NEMO)</a>
, <a href='linreg.1NEMO.html'>linreg(1NEMO)</a>
, <a href='tabnllsqfit.1NEMO.html'>tabnllsqfit(1NEMO)</a>
 <i>Numerical Recipies in
C, Ch.14</i> <p>
mpfit: <a href='http://www.physics.wisc.edu/~craigm/idl/cmpfit.html'>http://www.physics.wisc.edu/~craigm/idl/cmpfit.html</a>
 (author:
Craig B. Markwardt) <p>
<a href='http://arxiv.org/abs/1008.4686:'>http://arxiv.org/abs/1008.4686:</a>
 <i>Data analysis recipes:
Fitting a model to data P (Hogg, Bovy &amp; Lang 2010) 
<h2><a name='sect6' href='#toc6'></i>Author</a></h2>
Peter Teuben 
<h2><a name='sect7' href='#toc7'>Files</a></h2>
<br>
<pre>~/src/kernel/tab<tt> </tt>&nbsp;<tt> </tt>&nbsp;tablsqfit.c
</pre>
<h2><a name='sect8' href='#toc8'>Update History</a></h2>
<br>
<pre> 5-Aug-87<tt> </tt>&nbsp;<tt> </tt>&nbsp;V1.0 created                     <tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
18-May-88<tt> </tt>&nbsp;<tt> </tt>&nbsp;V1.4 various new options        <tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
31-May-88<tt> </tt>&nbsp;<tt> </tt>&nbsp;V2.0 &rsquo;float&rsquo;-&gt; &rsquo;double&rsquo; for NumRec<tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
14-nov-91<tt> </tt>&nbsp;<tt> </tt>&nbsp;V2.4 ellips fit and various others <tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
13-Mar-92<tt> </tt>&nbsp;<tt> </tt>&nbsp;V2.5 added imageshift option    <tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
15-nov-93<tt> </tt>&nbsp;<tt> </tt>&nbsp;V2.6 added nmax=                <tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
13-jun-94<tt> </tt>&nbsp;<tt> </tt>&nbsp;V2.7 code overhaul to add line/poly<tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
8-jun-95 <tt> </tt>&nbsp;<tt> </tt>&nbsp;V2.8 added option fit=peak      <tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
26-jan-98<tt> </tt>&nbsp;<tt> </tt>&nbsp;V2.9 added goodness-of-fit for fit=line <tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
4-feb-98<tt> </tt>&nbsp;<tt> </tt>&nbsp;V2.9a compute r (corr.coeff.) for line fit<tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
14-aug-00<tt> </tt>&nbsp;<tt> </tt>&nbsp;V3.0 added tab=                            <tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
8-aug-01<tt> </tt>&nbsp;<tt> </tt>&nbsp;V3.1c added area, using natof, error in ellipse<tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
24-feb-03<tt> </tt>&nbsp;<tt> </tt>&nbsp;V3.4: added fit=zero<tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
21-nov-05<tt> </tt>&nbsp;<tt> </tt>&nbsp;V3.4b: added fit=gauss1d,gauss2d<tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
9-dec-09<tt> </tt>&nbsp;<tt> </tt>&nbsp;V4.0: added xcol= and mpfit=<tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
</pre>
<p> <p>

<hr><p>
<a name='toc'><b>Table of Contents</b></a><p>
<ul>
<li><a name='toc0' href='#sect0'>Name</a></li>
<li><a name='toc1' href='#sect1'>Synopsis</a></li>
<li><a name='toc2' href='#sect2'>Description</a></li>
<li><a name='toc3' href='#sect3'>Parameters</a></li>
<li><a name='toc4' href='#sect4'>Example</a></li>
<li><a name='toc5' href='#sect5'>See Also</a></li>
<li><a name='toc6' href='#sect6'>Author</a></li>
<li><a name='toc7' href='#sect7'>Files</a></li>
<li><a name='toc8' href='#sect8'>Update History</a></li>
</ul>
</body>
</html>
