<!-- manual page source format generated by PolyglotMan v3.2, -->
<!-- available at http://polyglotman.sourceforge.net/ -->

<html>
<head>
<title>NEMOVAR(1NEMO) manual page</title>
</head>
<body bgcolor='white'>
This HTML automatically generated with <A HREF=http://manpages.ubuntu.com/manpages/bionic/man1/rman.1.html>rman</A> for <A HREF=https://astronemo.readthedocs.io>NEMO</A><br>
<a href='#toc'>Table of Contents</a><p>

<p> 
<h2><a name='sect0' href='#toc0'>Name</a></h2>
nemovar - get and set NEMOVAR variables 
<p> 
<h2><a name='sect1' href='#toc1'>Synopsis</a></h2>
<b>nemovar</b> [parameter=value]

<p> 
<h2><a name='sect2' href='#toc2'>Description</a></h2>
<b>nemovar</b> maintains a NEMO key/val storage server.  It will providing
another method to communicate (textual) information between tasks using
key/val pairs. These are persistent variables, and  can cross different
sessions, much like SHELL variables. <p>
The current implementation uses a simple
text file, but future implementation may also be able to switch to shared
memory, or whatever the operating system and environment provides, or what
the users&rsquo; workflow prefers. 
<p> 
<h2><a name='sect3' href='#toc3'>Parameters</a></h2>
 The following parameters are recognized
in order; they may be given in any order if the keyword is also given. Use
<b>--help</b> to confirm this man page is up to date.  
<dl>

<dt><b>var=</b> </dt>
<dd>Name of the variable.
<br>
Default: not used. </dd>

<dt><b>val=</b> </dt>
<dd>If used, the variable is getting a new value. <br>
Default: not used. </dd>

<dt><b>**delete=f|t</b> </dt>
<dd>Delete the named variable in <b>var=</b>. <br>
**<i>not implemented yet</i> </dd>

<dt><b>**load=</b> </dt>
<dd>Load from a file. Need a replace/merge option?
<br>
**<i>not implemented yet</i> </dd>

<dt><b>**save=</b> </dt>
<dd>Save to a file. <br>
**<i>not implemented yet</i> </dd>
</dl>

<h2><a name='sect4' href='#toc4'>Examples</a></h2>
The <b>NEMOVAR</b> environment variable is used
to set the interprocess communication, though currently only files are
supported. For example on linux we might be able to use the shared memory
as follows:  
<p>     export NEMOVAR=/dev/shm/nemovar.$USER<br>
     nemovar a 10<br>
     <br>
  to set the value of 10 to a. Then  
<p>     nemovar a<br>
     <br>
  retrieves the value of a. And finally  
<p>     nemovar <br>
     <br>
  just shows all variables. Output is always to <i>stdout</i>.  
<p> 
<h2><a name='sect5' href='#toc5'>Format</a></h2>
Currently
the format of the text file is a simple ASCII file, where all named variables
are explictly shown as strings:  
<p>     a="10"<br>
     b="hello world"<br>
     c="3.141592"<br>
     <br>
  to make it compatible with possible future <a href='bash.1.html'><i>bash(1)</i></a>
 and <a href='python.1.html'><i>python(1)</i></a>
 clients.
The data type interpretation is left to the client. This also opens the
option for small lists, e.g.  
<p>     d="1,2,10:20:2"<br>
 
<p>  which again leaves the client to parse the string, much like <a href='getparam.3.html'><i>getparam(3NEMO)</i></a>
.
Here is the way it can be done using <a href='nemoinp.1.html'><i>nemoinp(1NEMO)</i></a>
      nemoinp $(nemovar
d)<br>
  
<p> 
<h2><a name='sect6' href='#toc6'>Background</a></h2>
There are several ways already to pass small textual information
(outside of the large simulations files) between NEMO programs, usually
aided by the shell. 
<p> <p>
First of all, shell variables can be an effective way
to control a script, but sometimes they need to be extracted from a program,
e.g. with some awk/grep/sed, or in this example with <a href='txtpar.1.html'><i>txtpar(1NEMO)</i></a>
      
 ccdstat foo.ccd &gt; foo.log<br>
       mean=$(txtpar foo.log p0=Mean,1,5)<br>
       disp=$(txtpar foo.log p0=Mean,1,6)<br>
       ccdplot foo.ccd $mean-$disp,$mean,$mean+$disp<br>
  here we extracted the mean and dispersion from a map, and plotted contours
of the mean, and one dispersion around the mean. Assuming these variables
from the previous example happen to be in a file called <b>nemopars.rc</b>, the
following will work        mean=$(nemopars mean)<br>
       disp=$(nemopars disp)<br>
  <p>
Simulations can store results in a <i>keyword=value</i> textual database, something
that can be easily read by the shell, or python, or <a href='nemopars.1.html'><i>nemopars(1NEMO)</i></a>
. <p>
With
the first version of nemovar you can do the following:        export NEMOVAR=nemopars.rc<br>
       mean=$(nemovar mean)<br>
       disp=$(nemovar disp)<br>
  
<p> <p>
The power of nemovar will come when the user interface shortcuts the
use of the shell, as in this hypothetical example       ccdstat foo.ccd
nemovar=mean,disp<br>
      ccdplot foo.ccd %mean-%disp,%mean,%mean+%disp&rsquo;<br>
  
<p> 
<h2><a name='sect7' href='#toc7'>Future</a></h2>
1. A future implementation will allow direct retrieval of NEMO
variables is possible via the command line (see <a href='getparam.3.html'><i>getparam(3NEMO)</i></a>
). For example,
compare the two styles, <i>nemovar</i> on the left, shell variables on the right:
 
<p>      nemovar eps 0.05                 eps=0.05<br>
      hackcode1 eps=%eps               hackcode1 eps=$eps<br>
      <br>
  Note that some <a href='table.5.html'><i>table(5NEMO)</i></a>
 programs use %0, %1, %2, .... to refer to column
numbers, so variable names cannot start with a digit. Upper and Lower case
should be allowed, and be different. <p>
Recall that the current command line
interface can already refer to other keywords, e.g.  
<p>     foobar a=1 b=&rsquo;$a&rsquo;<br>
     <br>
  would assign the same value to both a and b. 
<p> 2. An option should exist
to remove a variable from the database. 
<p> 3. In case there is true shared
memory not associated with a filename, there needs to be a way to save
and load true files. 
<p> 4. When <i>outkeys/savevars</i> are implemented, the following
style of IPC is possible: 
<p>  
<p>      ccdstat ccd1 outkeys=mean,rms<br>
      ccdplot ccd1 %mean<br>
     <br>
  plotting a single contour of the mean value in the image. 
<p> 
<h2><a name='sect8' href='#toc8'>Caveat</a></h2>
It is
not possible to use nemovar&rsquo;s in a pipe, e.g. this is NOT reliable:      program1
- outkeys=bar | program2 - foo=%bar<br>
  
<p> 
<p> 
<h2><a name='sect9' href='#toc9'>See Also</a></h2>
<a href='txtpar.1.html'>txtpar(1NEMO)</a>
, <a href='nemopars.8.html'>nemopars(8NEMO)</a>
, <a href='getparam.3.html'>getparam(3NEMO)</a>
, <a href='table.3.html'>table(3NEMO)</a>

<p>
redis/valkey  <a href='https://github.com/valkey-io/valkey'>https://github.com/valkey-io/valkey</a>
 
<p> 
<h2><a name='sect10' href='#toc10'>Files</a></h2>
$NEMOVAR - currently
the filename, but could be used to set a more generic IPC method. 
<p> 
<h2><a name='sect11' href='#toc11'>Author</a></h2>
Peter

<p>Teuben 
<p> 
<h2><a name='sect12' href='#toc12'>History</a></h2>
<br>
<pre>7-mar-2024<tt> </tt>&nbsp;<tt> </tt>&nbsp;Created for NEMO2024<tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
24-jun-2024<tt> </tt>&nbsp;<tt> </tt>&nbsp;0.4:    write dummy if NEMOVAR does not exist<tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
15-feb-2025<tt> </tt>&nbsp;<tt> </tt>&nbsp;0.6:<tt> </tt>&nbsp;<tt> </tt>&nbsp;remove quotes when single variables requested<tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
</pre><p>

<hr><p>
<a name='toc'><b>Table of Contents</b></a><p>
<ul>
<li><a name='toc0' href='#sect0'>Name</a></li>
<li><a name='toc1' href='#sect1'>Synopsis</a></li>
<li><a name='toc2' href='#sect2'>Description</a></li>
<li><a name='toc3' href='#sect3'>Parameters</a></li>
<li><a name='toc4' href='#sect4'>Examples</a></li>
<li><a name='toc5' href='#sect5'>Format</a></li>
<li><a name='toc6' href='#sect6'>Background</a></li>
<li><a name='toc7' href='#sect7'>Future</a></li>
<li><a name='toc8' href='#sect8'>Caveat</a></li>
<li><a name='toc9' href='#sect9'>See Also</a></li>
<li><a name='toc10' href='#sect10'>Files</a></li>
<li><a name='toc11' href='#sect11'>Author</a></li>
<li><a name='toc12' href='#sect12'>History</a></li>
</ul>
</body>
</html>
