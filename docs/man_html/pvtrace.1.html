<!-- manual page source format generated by PolyglotMan v3.2, -->
<!-- available at http://polyglotman.sourceforge.net/ -->

<html>
<head>
<title>PVTRACE(1NEMO) manual page</title>
</head>
<body bgcolor='white'>
<a href='#toc'>Table of Contents</a><p>

<h2><a name='sect0' href='#toc0'>Name</a></h2>
pvtrace - PV diagram envelope tracing  
<h2><a name='sect1' href='#toc1'>Synopsis</a></h2>
<b>pvtrace</b> in=image [parameter=value]
 
<h2><a name='sect2' href='#toc2'>Description</a></h2>
<b>pvtrace</b> tries to recover the rotation curve from a single 
position-velocity (PV) diagram, by tracing the outer edges of the signal
that, after correction for a velocity dispersion factor, is the material
with the maximum amount of tangential motion. This is particularly appropriate
for high-inclination  galaxies, where significant amounts of gas is observed
below the rotation speed, due to line-of-sight integrations and simple moments
in velocity or gaussian fits fail to recover the appropriate rotation speed.
<p>
The rotation velocity, V, is determined from a terminal velocity V_t in
the usual way: <br>
<pre><tt> </tt>&nbsp;<tt> </tt>&nbsp;V = (V_t - V_sys)/sin(i) - sigma
</pre>but corrected for a dispersion factor sigma. The terminal velocity is defined
by the velocity at which the intensity becomes equal to <br>
<pre><tt> </tt>&nbsp;<tt> </tt>&nbsp;I_t = sqrt( (eta*I_max)^2 + (I_lc)^2 )
</pre>where I_max is the maximum intensity in the map, and I_lc the lowest contour
(usually 3 times the noise in the PV diagram). Both eta and I_lc can be
set via parameters to the program. Typical values for eta = 0.2 - 0.5. <p>
In addition,
this program will also perform the usual peak fit, gaussian fit, and simple
first moment analysis. See OUTPUT below for the output format. For lower
inclinations, the envelope tracing method should give simular results to
the other methods. <p>
MET = Modified Envelope Tracing method  (Gentile et al.,
see below) <br>
<pre><tt> </tt>&nbsp;<tt> </tt>&nbsp;V = [ |V_t - V_sys| - 0.5 sqrt(sigma^2 * 8ln2) ] / sin(i)
</pre>where sigma is really the quadrature sum of three components representing
the ISM, instrumental resolution and beam smearing. <p>
WAMET = WArped Modified

<p>Envelope-Tracing method 
<p> 
<h2><a name='sect3' href='#toc3'>Parameters</a></h2>

<dl>

<dt><b>in=</b> </dt>
<dd>Input image file - must be an PV <a href='image.5NEMO.html'><i>image(5NEMO)</i></a>

with position along the 1st axis, and velocity along the 2nd. Units are
not important. Use <b>ccdsub reorder=xzy</b> for an X-Y-VZ cube to  be properly reordered.
No default. </dd>

<dt><b>eta=</b> </dt>
<dd>[0..1] weight factor for I_max adding to I_lc. [Default: 0.2]
</dd>

<dt><b>ilc=</b> </dt>
<dd>Lowest Contour value. Normally taken as something like 3 times the
noise level.  [Default: 0] </dd>

<dt><b>sign=-1|1</b> </dt>
<dd>Designates rotation of the galaxy. This
is only important for tracing the &rsquo;right&rsquo; part of the PV diagram. sign=1 is
meant for PV diagrams where the approaching side is for positive positions.
By using the "wrong" value of sign you can find out something about the
radial extent of the tracer, as for large radii this would cause small
values of dV/dR. For a known rotation curve using sign=1 one could determine
the radial extent from sign=-1. [Default: 1] </dd>

<dt><b>sigma=</b> </dt>
<dd>Velocity dispersion correction
factor. This includes both the observational resolution as well as the velocity
dispersion of the tracer component that is being observed. [Default: 0]
</dd>

<dt><b>clip=</b> </dt>
<dd>Clipping values to aid removing noisy values around 0.  If value(s)
given, signal will be clipped as follows: if one value given, clipping
occurs between -clip and clip. If two numbers given, clipping occurs between
<a href='clip.1.html'>clip(1)</a>
 and <a href='clip.2.html'>clip(2)</a>
. Default: None </dd>

<dt><b>vsys=</b> </dt>
<dd>Systemic velocity of the galaxy.
Since the velocity axis (assumed to be the 2nd or Y-axis), this number is
simply subtraced from each velocity determination. [Default: 0] </dd>

<dt><b>inc=</b> </dt>
<dd>Inclination
of the galaxy. Each rotation speed is corrected by sin(inc). [Default: 90]
</dd>

<dt><b>center=</b> </dt>
<dd>Center of the galaxy along the Position axis.  [Default: 0] </dd>

<dt><b>rotcur=t|f</b>
</dt>
<dd>Should a folded rotation curve be tabulated? If so, negative positions
will have both position and velocity with a positive sign, thus creating
two rotation curves, receding and approaching, which can be plotted on
top of each other and compared. [Default: false] </dd>

<dt><b>out=</b> </dt>
<dd>Output file in case
input file was a cube and output is now a map, not a table. </dd>

<dt><b>mode=</b> </dt>
<dd>Which
of the output modes (see OUTPUT below) will be used for the output map.
[Default: 2] </dd>
</dl>

<h2><a name='sect4' href='#toc4'>Output</a></h2>
Output of the program will be an ASCII table, with various
derived velocities as function of position along the P axis in the PV-diagram.
The following columns are returned (see also <b>mode=</b> above): <p>
<br>
<pre>1<tt> </tt>&nbsp;<tt> </tt>&nbsp;position from the P-axis of the PV diagram
2<tt> </tt>&nbsp;<tt> </tt>&nbsp;envelope tracing (corrected with vsys, sini, and sigma)
3<tt> </tt>&nbsp;<tt> </tt>&nbsp;first moment (sum(I*v)/sum(I))  (corrected with vsys, sini)
4<tt> </tt>&nbsp;<tt> </tt>&nbsp;velocity at peak of signal
5<tt> </tt>&nbsp;<tt> </tt>&nbsp;velocity at peak of parabolic fit of 3 points at peak signal
6<tt> </tt>&nbsp;<tt> </tt>&nbsp;gaussian fit
7<tt> </tt>&nbsp;<tt> </tt>&nbsp;half gaussian fit
8<tt> </tt>&nbsp;<tt> </tt>&nbsp;half gaussian fit, with for MET correction
</pre>
<h2><a name='sect5' href='#toc5'>Caveats</a></h2>
Position axis must be carefully created such that the galaxy center
is at P=0, whereas for velocity it can be corrected with VSYS=. This is
easy for theoretical data, but cumbersome for real data. <p>
The MET mode is
still not very robust, clipping helps. 
<h2><a name='sect6' href='#toc6'>See Also</a></h2>
<a href='rotcur.1NEMO.html'>rotcur(1NEMO)</a>
, <a href='runvelfitss07.1NEMO.html'>runvelfitss07(1NEMO)</a>
,
<a href='ccdvel.1NEMO.html'>ccdvel(1NEMO)</a>
, <a href='snapgrid.1NEMO.html'>snapgrid(1NEMO)</a>
, <a href='ccdmom.1NEMO.html'>ccdmom(1NEMO)</a>
, <a href='ccdsub.1NEMO.html'>ccdsub(1NEMO)</a>
 <p>
<br>
<pre>Sancisi &amp; Allen 1979
Sofue, Y. 1996 ApJ 458, 120
Sofue et al 1997 PASJ 49, 17
Sofue et al 523, 136 
Sofue et al (1997AJ....114.2428S)
Gentile et al. (2004MNRAS.351..903G) - MET/WAMET method
</pre>
<h2><a name='sect7' href='#toc7'>Files</a></h2>
<br>
<pre>src/image/rotcur<tt> </tt>&nbsp;<tt> </tt>&nbsp;sources
</pre>
<h2><a name='sect8' href='#toc8'>Author</a></h2>
Peter Teuben 
<h2><a name='sect9' href='#toc9'>Update History</a></h2>
<br>
<pre>5-May-01<tt> </tt>&nbsp;<tt> </tt>&nbsp;V1.0 Created<tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
6-may-01<tt> </tt>&nbsp;<tt> </tt>&nbsp;V1.1 clip=, interpolated to find trace  <tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
18-mar-09<tt> </tt>&nbsp;<tt> </tt>&nbsp;V1.3 added rotcur=<tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
9-jun-09<tt> </tt>&nbsp;<tt> </tt>&nbsp;V1.4 implemented MET=<tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
</pre><p>

<hr><p>
<a name='toc'><b>Table of Contents</b></a><p>
<ul>
<li><a name='toc0' href='#sect0'>Name</a></li>
<li><a name='toc1' href='#sect1'>Synopsis</a></li>
<li><a name='toc2' href='#sect2'>Description</a></li>
<li><a name='toc3' href='#sect3'>Parameters</a></li>
<li><a name='toc4' href='#sect4'>Output</a></li>
<li><a name='toc5' href='#sect5'>Caveats</a></li>
<li><a name='toc6' href='#sect6'>See Also</a></li>
<li><a name='toc7' href='#sect7'>Files</a></li>
<li><a name='toc8' href='#sect8'>Author</a></li>
<li><a name='toc9' href='#sect9'>Update History</a></li>
</ul>
</body>
</html>
