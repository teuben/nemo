<!-- manual page source format generated by PolyglotMan v3.2, -->
<!-- available at http://polyglotman.sourceforge.net/ -->

<html>
<head>
<title>CCDVEL(1NEMO) manual page</title>
</head>
<body bgcolor='white'>
HTML automatically generated with <A HREF=http://manpages.ubuntu.com/manpages/bionic/man1/rman.1.html>rman</A><br>
<a href='#toc'>Table of Contents</a><p>

<h2><a name='sect0' href='#toc0'>Name</a></h2>
ccdvel - create a velocity field; grid or retrace 
<h2><a name='sect1' href='#toc1'>Synopsis</a></h2>
<b>ccdvel out=</b>velfie
[parameters=values ...] 
<p> 
<h2><a name='sect2' href='#toc2'>Description</a></h2>
<i>ccdvel</i> creates a model velocity field
for a disk with material in circular orbits. The user supplies the program
with a table of a rotation curve (see also <a href='rotcurshape.3.html'><i>rotcurshape(3NEMO)</i></a>
 for another
approach) with a set of radii and rotation velocities. The position angle
and inclination of each &rsquo;ring&rsquo; can also be varied to simulate  geometrical
warps. <p>
Two gridding methods exist:  <p>
<i>retracing:</i> the GIPSY  method retraces
each pixel in the sky plane to its (smallest)  radius in the (warped) galactic
disk: its ring parameters  (velocity, position angle, and inclination)
are then (linearly) <i>interpolated</i> from the input arrays, and that point
is appropriately projected into that pixel (<i> bug? it might still wind up
in the next pixel</i>) <p>
<i>gridding:</i> the NEMO method places particles in rings,
as prescribed by the input values, and computes a properly intensity weighted
(number of particles in this case) mean velocity per pixel. This may however
results in a &rsquo;meaningless&rsquo; mean velocity in areas where rings are projected
on top of each other. <i>Note:</i> This mode, originally the only one,  merely
served as a shortcut between  the various N-body creators, followed by subsequent
gridding with  <i>snapgrid</i>. It may not work anymore, since it is not well 
maintained. <p>
The center coordinates and systemic velocity are currently fixed
for all rings. <p>
Using keywords <b>mexp=</b> and <b>phexp=</b> a circular orbit  can have
its expansion velocity modulated: <br>
<pre><tt> </tt>&nbsp;<tt> </tt>&nbsp;vexp*cos(mexp*(phi-phiexp))
</pre>instead of a constant vexp (i.e. mexp=0), where phi is measured from the
major axis in the plane of the disk (check!). This only works for the retracing
method though. Although the rotation speed has a similar modulation implemented,
it is not a good idea to use that. Instead, it will probably be better to
re-define this as <br>
<pre><tt> </tt>&nbsp;<tt> </tt>&nbsp;vrot+vexp*sin(mexp*(phi-phiexp))
</pre>though this would suggest the local velocity ellipsoid to be isotropic
(cf. Binney &amp; Tremaine ....) 
<p> 
<h2><a name='sect3' href='#toc3'>Parameters</a></h2>
 The following parameters are recognized
in order; they may be given in any order if the keyword is also given. Use
--help to confirm this man page is up to date.  
<dl>

<dt><b>out=</b><i>image_out</i> </dt>
<dd>Output velocity
field map, will be in <a href='image.5.html'><i>image(5NEMO)</i></a>
 format. No default. </dd>

<dt><b>radii=</b><i>r1,r2,...</i> </dt>
<dd>Radii
(arcsec). Note they must be sorted by increasing radius. The default is taken
from the <i>rotcur_table</i> table below, or from this keyword. </dd>

<dt><b>vrot=</b><i>v1,v2,...</i> </dt>
<dd>Array
of rotation velocities, one for each radius, If less than the number of
radii is given, the trailing ones are filled with the last supplied value.
The default values from the <i>rotcur_table</i> table below can be also  be overridden
with this keyword. </dd>

<dt><b>vexp=</b><i>v1,v2,...</i> </dt>
<dd>Array of expansion velocities, one for each
radius. If less than the number of radii is given, the trailing ones are
filled with the last supplied value. Default: 0 </dd>

<dt><b>inc=</b><i>i1,i2,...</i> </dt>
<dd>Array of inclinations
(degrees), one for each radius. The default values from the <i>rotcur_table</i>
table below can be also  be overridden with this keyword. </dd>

<dt><b>pa=</b><i>p1,p2,...</i> </dt>
<dd>Array
of  position angles (degrees), one for each radius. The default values from
the <i>rotcur_table</i> table below can be also  be overridden with this keyword.
</dd>

<dt><b>phrot=</b><i>p1,p2,p3,...</i> </dt>
<dd>Array of rotation phase angles (degrees), one for each
radius. Don&rsquo;t use this right now. Default: 0 </dd>

<dt><b>phexp=</b><i>p1,p2,p3,...</i> </dt>
<dd>Array of expansion
phase angles (degrees), one for each radius, for the modulation of the
expansion velocities. </dd>

<dt><b>mrot=</b><i>m</i> </dt>
<dd>Fourier mode for the rotation speed modulation.
Currently not a good idea to use this, since we would modulate the whole
rotation, not a tiny bit on top of rotation. Use mexp=,phexp=. Default: 0
</dd>

<dt><b>mexp=</b><i>m</i> </dt>
<dd>Fourier mode for the expansion speed modulation.  Default: 0 </dd>

<dt><b>size=</b><i>nx,ny</i>
</dt>
<dd>Size of map, up to two numbers. If one number supplied, the map will be
square.  Note that in NEMO (0-based) coordinates, the center of rotation
will be at <i>((nx-1)/2,(ny-1)/2)</i>. [Default: <b>128</b>]. </dd>

<dt><b>cell=</b><i>dx,dy</i> </dt>
<dd>Cell size, up to
two numbers. If one number supplied, the cells will be square. [Default:
<b>1</b>]. </dd>

<dt><b>center=</b><i>x0,y0</i> </dt>
<dd>Rotation center (grids with lower left corner being 0,0).
 Default: center of map if <i>rotcur_table</i> is not used, else the <i>center_ring</i>
entry from the <i>rotcur_table</i>.  </dd>

<dt><b>blc=</b><i>xmin,ymin</i> </dt>
<dd>Lower left corner of the grid.
Default: 0,0. </dd>

<dt><b>vsys=</b><i>vsys</i> </dt>
<dd>Systemic velocity.  Default: <b>0</b> if <i>rotcur_table</i> is
not used, else the <i>center_ring</i> entry from the <i>rotcur_table</i>. </dd>

<dt><b>rotcurfit=</b><i>rotcur_table</i>
</dt>
<dd>All ring parameters can also be read from this table,  that is normally
output by <a href='rotcur.1.html'><i>rotcur(1NEMO)</i></a>
&rsquo;s <b>tab=</b> keyword. That table needs to be commented
with <a href='tabcomment.1.html'><i>tabcomment(1NEMO)</i></a>
. </dd>

<dt><b>fixring=</b><i>center_ring</i> </dt>
<dd>Ring number (1..Nring), from the
<i>rotcur_table</i>, of which  the center (<b>vsys, center</b>) is used. If <b>0</b> is used,
they must have been given by the appropriate keywords. If a large number
is given, the last table entry is used.  </dd>

<dt><b>noise=</b><i>v_sigma</i> </dt>
<dd>Dispersion of the
gaussian noise added to the map. Default: 0 </dd>

<dt><b>amp=</b><i>t|f</i> </dt>
<dd>If set to true (or 1)
it will create an amplitude (surface brightness) map, instead of a velocity
field. In this case, the rotation speed is taken as the amplitude of the
density map. See also <a href='ccdgen.1.html'><i>ccdgen(1NEMO)</i></a>
.   Default: false </dd>

<dt><b>seed=</b> </dt>
<dd>Initial seed
for random number generator. See <a href='xrandom.3.html'><i>xrandom(3NEMO)</i></a>
 for defaults. Default: 0
</dd>

<dt><b>in=</b><i>ccd-file</i> </dt>
<dd><a href='Template.2d.html'>Template (2d)</a>
 image to provide the WCS for a cube. (deprecated)
</dd>

<dt><b>intpol=linear|constant</b> </dt>
<dd>Interpolation method used for rings in retrace method.
For <b>linear</b> each computed galactic radius has linearly interpolated values
for the rotation curve, inclincation, position angle etc., whereas for <b>constant</b>
the starting value of ring is used. Default: <b>linear</b>. </dd>

<dt><b>headline=</b><i>comments</i> </dt>
<dd>Random
verbiage added to the output image [Default: none]. 
<p> </dd>
</dl>

<h2><a name='sect4' href='#toc4'>Example</a></h2>
A velocity field
in a file <i>map1</i> is fitted with <i>rotcur</i>,  starting at the outskirts of the
galaxy, 100", and working on inwards to 10", the table is commented to
feed it into <i>ccdvel</i> (note the numeric sort) and compute a model velocity
field, after which that is subtracted from the observations  (only in points
were both model and observations are not undefined, i.e. 0.0): 
<p> <br>
<pre>    1% rotcur in=map1 radii=100:10:-5 vrot=100 pa=20 inc=45 vsys=1200 \
         center=100,110 fixed=center,vsys,inc tab=map1.tmp units=arcsec
    2% tabcomment map1.rotcur - | sort -n &gt; map1.rotcur
    3% ccdvel out=map1.model rotcurfit=map1.rotcur
    4% ccdmath in=map1,map1.model out=map1.diff \
            fie="ifeq(%1,0.0,0.0,ifeq(%2,0.0,0.0,%1-%2))"
</pre><p>
One can also use ccdvel to create a surface brightness. Creating a functional
form for the density can be done using <a href='tabmath.1.html'><i>tabmath(1NEMO)</i></a>
. E.g. the following
example creates an exponential surface density profile: <br>
<pre>    5% set rad=&lsquo;nemoinp 0:100:5&lsquo;
    6% set den=&lsquo;nemoinp 0:100:5 | tabmath - - "exp(-%1/20)" all&lsquo;
    7% ccdvel out=map1.den radii="$rad" vrot="$den" pa=30 inc=60 amp=t
or
    8% nemoinp 0:100:5 &gt; map1.radt
    9% nemoinp 0:100:5 | tabmath - - "exp(-%1/20)" all &gt; map1.dent
   10% ccdvel out=map1.den radii=@map1.radt vrot=@map1.dent pa=30 inc=60 amp=t

Now one can create a velocity field in a simular way, 
</pre>
<p>    11% nemoinp 0:100:5 | tabmath - - "%1/sqrt(40+%1*%1)" all &gt; map1.velt<br>
    12% ccdvel out=map1.vel radii=@map1.radt vrot=@map1.velt pa=30 inc=60
<br>
 <br>
<pre>and with simulated beamsmearing create a beam smeared velocity field:
   13% ccdsmooth map1.den map1.dens 4
   13% ccdmath map1.den,map1.vel - "%1*%2" | ccdsmooth - map1.dvels 4
   14% ccdmath map1.den,map1.dvels map1.vels "%2/%1"
</pre>Note however that this method of beamsmearing is only approximate,  and
ignores the internal velocity dispersion, which can be very important in
areas of large velocity gradients. 
<h2><a name='sect5' href='#toc5'>Rotcurfit</a></h2>
The table <b>rotcurfit</b> assumes
the radius, systemic velocity, rotation velocity,  position angle, inclination,
x center and y center  are in columns 1, 2, 4, 6, 8, 10 and 12 resp. 
<h2><a name='sect6' href='#toc6'>See
Also</a></h2>
<a href='snapgrid.1.html'>snapgrid(1NEMO)</a>
, <a href='ccdgrid.1.html'>ccdgrid(1NEMO)</a>
, <a href='snapslit.1.html'>snapslit(1NEMO)</a>
, <a href='ccdgen.1.html'>ccdgen(1NEMO)</a>
, <a href='rotcur.1.html'>rotcur(1NEMO)</a>
,
<a href='rotcurshape.1.html'>rotcurshape(1NEMO)</a>
, <a href='velcube.1.html'>velcube(1NEMO)</a>
, velfi(GIPSY) 
<h2><a name='sect7' href='#toc7'>Author</a></h2>
Peter Teuben 
<h2><a name='sect8' href='#toc8'>Bugs</a></h2>
The
output map is patched with the undefined value 0.0 where-ever no information
is requested for these pixels. <p>
The <i>gridding</i> method is currently not available.
The retracing (GIPSY) method will be used. <p>
Different versions of rotcur
exist (NEMO, Gipsy) that use different columns, so the <b>rotcurfit=</b> tables
should be used with caution. 
<h2><a name='sect9' href='#toc9'>Update History</a></h2>
<br>
<pre>20-may-91<tt> </tt>&nbsp;<tt> </tt>&nbsp;original program                     <tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
31-jul-92<tt> </tt>&nbsp;<tt> </tt>&nbsp;V1.3 new rotcurfit=; rings are now radii    <tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
3-aug-92<tt> </tt>&nbsp;<tt> </tt>&nbsp;(b) fixed mapsize bug; override center=   <tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
12-aug-92  <tt> </tt>&nbsp;<tt> </tt>&nbsp;(d) added headline=                      <tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
oct-99       <tt> </tt>&nbsp;<tt> </tt>&nbsp;doc additions                               <tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
apr-01<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;V1.5b added in=, but deprecated it<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
1-may-01<tt> </tt>&nbsp;<tt> </tt>&nbsp;V1.6 added amp= for CARMA simulations<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT/LGM
3-may-01<tt> </tt>&nbsp;<tt> </tt>&nbsp;V1.7 added vexp=                            <tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
29-jun-02<tt> </tt>&nbsp;<tt> </tt>&nbsp;V1.8 added blc= keyword (Joshua Simon)<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
6-feb-03<tt> </tt>&nbsp;<tt> </tt>&nbsp;V2.0 modulated orbits (mexp,phexp,mrot,phrot)<tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
11-sep-03<tt> </tt>&nbsp;<tt> </tt>&nbsp;V2.1 added intpol=<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
</pre><p>

<hr><p>
<a name='toc'><b>Table of Contents</b></a><p>
<ul>
<li><a name='toc0' href='#sect0'>Name</a></li>
<li><a name='toc1' href='#sect1'>Synopsis</a></li>
<li><a name='toc2' href='#sect2'>Description</a></li>
<li><a name='toc3' href='#sect3'>Parameters</a></li>
<li><a name='toc4' href='#sect4'>Example</a></li>
<li><a name='toc5' href='#sect5'>Rotcurfit</a></li>
<li><a name='toc6' href='#sect6'>See Also</a></li>
<li><a name='toc7' href='#sect7'>Author</a></li>
<li><a name='toc8' href='#sect8'>Bugs</a></li>
<li><a name='toc9' href='#sect9'>Update History</a></li>
</ul>
</body>
</html>
