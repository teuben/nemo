<!-- manual page source format generated by PolyglotMan v3.2, -->
<!-- available at http://polyglotman.sourceforge.net/ -->

<html>
<head>
<title>TREECODE1(1NEMO) manual page</title>
</head>
<body bgcolor='white'>
<a href='#toc'>Table of Contents</a><p>

<h2><a name='sect0' href='#toc0'>Name</a></h2>
treecode1 - Hierarchical N-body code (theta scan) 
<h2><a name='sect1' href='#toc1'>Synopsis</a></h2>
<b>treecode1</b> [parameter=value]

<h2><a name='sect2' href='#toc2'>Description</a></h2>
<b>treecode1</b> is NEMO&rsquo;s adaptation of treecode, a  a program for
self-consistent N-body simulation. It is faster than previous codes, and generally
provides better error control.  Preliminary timing tests show that treecode
is indeed about a factor of two faster than the BH86 code  (see <a href='hackcode1.1.html'><i>hackcode1(1NEMO)</i></a>
)
 <i>at a fixed level of accuracy</i>; it also outperforms other versions of that
algorithm (Barnes 1998). Moreover,  it is significantly more robust when
 presented with &lsquo;perverse&rsquo; mass distributions (Salmon &amp; Warren 1994). 
<h2><a name='sect3' href='#toc3'>Parameters</a></h2>
The
following parameters are recognized in any order if the keyword is also
given: 
<dl>

<dt><b>in=</b> </dt>
<dd>if given, names an input file containing initial conditions
for the calculation. The format of this file is described below.  </dd>

<dt><b>out=</b> </dt>
<dd>If
given, is a pattern naming output files for N-body snapshots taken at regular
intervals. This pattern is used as an argument to sprintf, along with the
integration step number, to generate an actual file name. If the resulting
file already exists, the new data is appended. The format used is similar
to the format used for input files.  See below. </dd>

<dt><b>dtime=</b> </dt>
<dd>is the integration
time-step. It&rsquo;s convenient to use a timestep which has an exact representation
as a floating-point number; for example, a value n/d, where n is an integer
and d is a power of two. To simplify specification of such timesteps, the
code accepts fractions as well as ordinary floating-point values. If dtime=0,
treecode does a single force calculation, outputs the result, and exits.
[1/32]     </dd>

<dt><b>eps=</b> </dt>
<dd>is the smoothing length used in the gravitational force
calculation. In effect, the mass distribution is smoothed by replacing each
body by a Plummer sphere with scale length eps, and the gravitational field
of this smoothed distribution is calculated. [0.025]     </dd>

<dt><b>theta=</b> </dt>
<dd>is the opening
angle used to adjust the accuracy of the force calculation. Values less
than unity produce more accurate forces, albeit at greater computational
expense. The QUICKSCAN version does not use or accept this parameter.  [1.0]
    </dd>

<dt><b>usequad=</b> </dt>
<dd>determines if quadrupole corrections are used when calculating
gravitational fields. These corrections can significantly improve the accuracy
of force calculation at a fairly modest computational cost.  [false]   </dd>

<dt><b>options=</b>
</dt>
<dd>is a list of comma-separated key words used to obtain various run-time options.
The options available are : <b>reset-time:</b> set the time to zero, regardless
of the  value in the input file;  <b>new-tout:</b> reschedule the first snapshot
output;  <b>out-phi:</b> include potential values in the output files;  <b>out-acc:</b>
include acceleration vectors in the output files;  <b>bh86:</b> use the BH86 criterion
to set critical cell radii;  <b>sw94:</b> use Salmon &amp; Warren&rsquo;s (1994) bmax criterion
 to set critical cell radii.  </dd>

<dt><b>tstop=</b> </dt>
<dd>is the time at which the N-Body integration
terminates.  [2.0]    </dd>

<dt><b>dtout=</b> </dt>
<dd>is the time interval between output files.  To
insure that outputs are performed when expected, dtout should be a multiple
of dtime. Like dtime, this parameter may be specified as a fraction.   [1/4]
    </dd>

<dt><b>nbody=</b> </dt>
<dd>is the number of bodies used to self-generate initial conditions.
This parameter is only used if no input or restore file is given.  [4096]
 </dd>

<dt><b>seed=</b> </dt>
<dd>is the random number seed used to self-generate initial conditions.
This parameter is only used if no input or restore file is given. [123]
 </dd>

<dt><b>save=</b> </dt>
<dd>Write state file as code runs. Not used in NEMO yet. </dd>

<dt><b>restore=</b> </dt>
<dd>Continue
run from state file. Not used in NEMO yet. </dd>
</dl>

<h2><a name='sect4' href='#toc4'>Examples</a></h2>
For example, to run a
test calculation using a Plummer model with 32768 bodies and an opening
angle of 0.75, type  <br>
<pre>    % treecode nbody=32768 theta=0.75
</pre>To compute forces and potentials for a N-body configuration in the input
file input.data, writing the result to output file forces.data, type    
 % treecode input.data forces.data dtime=0 options=out-phi,out-acc<br>
 </pre>To run the initial conditions in input.data with a timestep of 1/64, writing
results at intervals of 1/16 to separate files run_000.data, run_004.data,
..., type  <br>
<pre>    % treecode input.data run_%03d.data dtime=1/64 dtout=1/16
</pre>
<p> To perform the same calculation using the QUICKSCAN version, while saving
the program&rsquo;s state after each step, type  <br>
<pre>    % treecode_q input.data run_%03d.data dtime=1/64 dtout=1/16 save=state.data
</pre>To continue this calculation until time 4, type  <br>
<pre>    % treecode_q restore=state.data out=run_%03d.data tstop=4
</pre>
<h2><a name='sect5' href='#toc5'>Performance</a></h2>
The standard benchmark uses <b>nbody=4096</b> bodies, a timestep of
<b>dtime=1/32</b>, a smoothing length of <b>eps=0.025</b>,  an accuracy parameter <b>theta=1.0</b>,
and no quadrupole moments. A log of the calculation is sent to standard
output; no other output is generated. On a 500 MHz Pentium, this test calculation
takes about 1.2 minutes. <br>
<pre>    mkplummer std4k 4096 seed=123
    stoa std4k std4k.tab
    time treecode1 std4k.tab &gt; std4k.log
</pre>
<h2><a name='sect6' href='#toc6'>Data Format</a></h2>
The data format used for in= and out= depends on the compilation
option. If compiled with the USE_NEMO_IO flag, the dataformat is in <a href='snapshot.5.html'><i>snapshot(5NEMO)</i></a>

format, with a separate <i>Position</i> and <i>Velocity</i>, instead of the original
<i>PhaseSpace</i> 
<h2><a name='sect7' href='#toc7'>Compilation</a></h2>
The code can be compiled with various flags that
will change the behavior of the code: <br>
<pre>USE_NEMO_IO<tt> </tt>&nbsp;<tt> </tt>&nbsp;use NEMO I/O, thus snapshots (default in NEMO), instead of the
"205" format (atos) 
BINARYIO<tt> </tt>&nbsp;<tt> </tt>&nbsp;use binary output, complementary to the non-NEMO ascii I/O (default:
none)
USEFREQ<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;use freq,freqout instead of dtime,dtout (the default)
QUICKSCAN<tt> </tt>&nbsp;<tt> </tt>&nbsp;use the theta= accuracy parameter (the default) instead of a theta-scan
</pre>
<h2><a name='sect8' href='#toc8'>See Also</a></h2>
<br>
<pre>hackcode1(1NEMO), treecode(1NEMO), atos(1NEMO), snapshot(5NEMO)
http://www.ifa.hawaii.edu/faculty/barnes/treecode/treeguide.html
</pre>
<h2><a name='sect9' href='#toc9'>Files</a></h2>
src/nbody/evolve/hackcode/treecode1 
<h2><a name='sect10' href='#toc10'>Author</a></h2>
Joshua Barnes, Peter Teuben
(NEMO adaptation) 
<h2><a name='sect11' href='#toc11'>Update History</a></h2>
<br>
<pre>1999       <tt> </tt>&nbsp;<tt> </tt>&nbsp;written, Tokyo, Japan<tt> </tt>&nbsp;<tt> </tt>&nbsp;JEB
22-jun-01<tt> </tt>&nbsp;<tt> </tt>&nbsp;V1.4 NEMO adaptation<tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
25-apr-04<tt> </tt>&nbsp;<tt> </tt>&nbsp;V1.4.2 added USE_NEMO_IO to do snapshot I/O<tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
</pre><p>

<hr><p>
<a name='toc'><b>Table of Contents</b></a><p>
<ul>
<li><a name='toc0' href='#sect0'>Name</a></li>
<li><a name='toc1' href='#sect1'>Synopsis</a></li>
<li><a name='toc2' href='#sect2'>Description</a></li>
<li><a name='toc3' href='#sect3'>Parameters</a></li>
<li><a name='toc4' href='#sect4'>Examples</a></li>
<li><a name='toc5' href='#sect5'>Performance</a></li>
<li><a name='toc6' href='#sect6'>Data Format</a></li>
<li><a name='toc7' href='#sect7'>Compilation</a></li>
<li><a name='toc8' href='#sect8'>See Also</a></li>
<li><a name='toc9' href='#sect9'>Files</a></li>
<li><a name='toc10' href='#sect10'>Author</a></li>
<li><a name='toc11' href='#sect11'>Update History</a></li>
</ul>
</body>
</html>
