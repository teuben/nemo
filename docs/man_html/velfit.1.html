<!-- manual page source format generated by PolyglotMan v3.2, -->
<!-- available at http://polyglotman.sourceforge.net/ -->

<html>
<head>
<title>VELFIT(1NEMO) manual page</title>
</head>
<body bgcolor='white'>
<a href='#toc'>Table of Contents</a><p>

<h2><a name='sect0' href='#toc0'>Name</a></h2>
velfit - fit rotation curve to coplanar disk (WWB73 method) 
<h2><a name='sect1' href='#toc1'>Synopsis</a></h2>
<b>velfit</b>
[parameter=value] 
<h2><a name='sect2' href='#toc2'>Description</a></h2>
VELFIT fits a theoretical velocity pattern
(<b>vmod</b>) to an observed isovelocity image (<b>vobs</b>), optionally weighted by
an intensity image and a geometric factor specified by model input parameters.
The default option is to fit a rotation curve to an isovelocity image of
a rotating disk. The rotation curve and rms for the fit are tabulated and
can be used to find the best fit to the other parameters. For more details
see  Warner, Wright and Baldwin (1973MNRAS.163..163W).  This may not be  the
best method to fit a rotation curve (see also <a href='rotcur.1NEMO.html'><i>rotcur(1NEMO)</i></a>
), but it is
very simple and elegant to program. <p>
Optionally an output map can be generated
with amusing quantities,  as well an output table that contains, amongst,
the rotation curve. For additional map manipulations, see also <a href='velmap.1NEMO.html'><i>velmap(1NEMO)</i></a>
.
<p>
The name of this program, <b>velfit</b>, unfortunately collides with the same
written by Spekkens &amp; Sellwood, and a frontend in NEMO is available as <a href='runvelfitss07.1NEMO.html'><i>runvelfitss07(1NEMO)</i></a>
.
However, their program was updated, and is now available as <b>diskfit</b>, with
a NEMO frontend called <a href='rundiskfit.1NEMO.html'><i>rundiskfit(1NEMO)</i></a>
. 
<h2><a name='sect3' href='#toc3'>Parameters</a></h2>
The following parameters
are recognized in any order if the keyword is also given: 
<dl>

<dt><b>in=</b> </dt>
<dd>input observed
velocity field, in <a href='image.5NEMO.html'><i>image(5NEMO)</i></a>
 format. We refer to this as <b>vobs</b>. No default.
</dd>

<dt><b>radii=</b> </dt>
<dd>radii of the ring boundaries. For N rings, N+1 values need to be
given. They need to be sorted by increasing radius.   See <a href='nemoinp.1NEMO.html'><i>nemoinp(1NEMO)</i></a>

for syntax, though <i>rmin:rmax:rstep</i> is a common shortcut. It uses units from
the image, usually degrees if you come from a FITS file  (see EXAMPLE below)
 No default. </dd>

<dt><b>pa=</b> </dt>
<dd>position angle of disk, in degrees. [0] </dd>

<dt><b>inc=</b> </dt>
<dd>inclination
angle of disk, in degrees [45]    </dd>

<dt><b>vsys=</b> </dt>
<dd>systemic velocity [0]      </dd>

<dt><b>center=</b>
</dt>
<dd>rotation center. Default is the mapcenter ((Nx-1)/2,Ny-1)/2) where 0,0=center
of lower left pixel. </dd>

<dt><b>den=</b> </dt>
<dd>input density image, used to weigh the velocities.
If missing, weights are uniform (but see <b>coswt=</b> below). Default: none. </dd>

<dt><b>frang=</b>
</dt>
<dd>free angle around minor axis (2*frang is the total angle around the minor
axis used), where data are ignored. [Default: 0] </dd>

<dt><b>blank=</b> </dt>
<dd>Value of the blank
pixel to be ignored. Default: 0.0 </dd>

<dt><b>coswt=</b> </dt>
<dd>power of cos(theta) weighting [1]
   </dd>

<dt><b>wwb73=</b> </dt>
<dd>use the classic WWB73 method? Currently there is no other  method.
 See <a href='rotcur.1NEMO.html'><i>rotcur(1NEMO)</i></a>
 and <a href='rotcurshape.1NEMO.html'><i>rotcurshape(1NEMO)</i></a>
 for alternate discussions. [t]
  </dd>

<dt><b>mode=</b> </dt>
<dd>Output mode for the output image data file. Valid are: <b>vtan</b> (=(vobs-vsys)/(cost*sini)),
<b>vmod</b>,  <b>vres</b> (=vobs-vmod),  <b>vtan/r</b>,  <b>ome</b> (=vtan/r),  <b>vrad</b> (=vres/(sint*sini)),
or <b>dv/dr</b> (spline derivative of rotation curve) </dd>

<dt><b>out=</b> </dt>
<dd>Optional output image,
if selected. See <b>mode=</b> what this image contains. Default: none. </dd>

<dt><b>tab=</b> </dt>
<dd>Optional
output table file. This will contain the  radius, rotation speed, dispersion
in the ring and some other values.  Default: none </dd>
</dl>

<h2><a name='sect4' href='#toc4'>See Also</a></h2>
<a href='rotcur.1NEMO.html'>rotcur(1NEMO)</a>
,
<a href='runvelfitss07.1NEMO.html'>runvelfitss07(1NEMO)</a>
, <a href='rotcurshape.1NEMO.html'>rotcurshape(1NEMO)</a>
, <a href='velmap.1NEMO.html'>velmap(1NEMO)</a>
, <a href='velfitpatch.1NEMO.html'>velfitpatch(1NEMO)</a>


<h2><a name='sect5' href='#toc5'>Files</a></h2>
src/image/rotcur :  velfit.c 
<h2><a name='sect6' href='#toc6'>Examples</a></h2>
The following example fits a velocity
field for NGC 6503, produces a table and  plots the rotation curve with
error bars <br>
<pre>% fitsccd N6503.xmom1.fits - | ccdmath - n6503.vel %1/1000.0
% velfit n6503.vel 0:1:0.002 -57 71.5 20 467,543 frang=0 tab=n6503.vtab
% tabplot n6503.vtab dycol=3 xmin=0 xmax=0.2
</pre>The N6503 example was taken from the 1996 VLA data, published  in 2009
by Greisen et al. (2009AJ....137.4718G) and generally available. 
<h2><a name='sect7' href='#toc7'>Author</a></h2>
Mel Wright
(Fortran version), Peter Teuben (C version) 
<h2><a name='sect8' href='#toc8'>Update History</a></h2>
<br>
<pre>30-sep-92<tt> </tt>&nbsp;<tt> </tt>&nbsp;new task in MIRIAD<tt> </tt>&nbsp;<tt> </tt>&nbsp;MCHW
5-oct-2003<tt> </tt>&nbsp;<tt> </tt>&nbsp;V1.0 : C version in NEMO<tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
22-oct-2005<tt> </tt>&nbsp;<tt> </tt>&nbsp;V1.1 : added out=<tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
4-feb-2011<tt> </tt>&nbsp;<tt> </tt>&nbsp;V1.2 : added tab= and mode=<tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
10-apr-2011<tt> </tt>&nbsp;<tt> </tt>&nbsp;V1.4 : added mode=dv/dr <tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
</pre><p>

<hr><p>
<a name='toc'><b>Table of Contents</b></a><p>
<ul>
<li><a name='toc0' href='#sect0'>Name</a></li>
<li><a name='toc1' href='#sect1'>Synopsis</a></li>
<li><a name='toc2' href='#sect2'>Description</a></li>
<li><a name='toc3' href='#sect3'>Parameters</a></li>
<li><a name='toc4' href='#sect4'>See Also</a></li>
<li><a name='toc5' href='#sect5'>Files</a></li>
<li><a name='toc6' href='#sect6'>Examples</a></li>
<li><a name='toc7' href='#sect7'>Author</a></li>
<li><a name='toc8' href='#sect8'>Update History</a></li>
</ul>
</body>
</html>
