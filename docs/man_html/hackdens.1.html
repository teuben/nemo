<!-- manual page source format generated by PolyglotMan v3.2, -->
<!-- available at http://polyglotman.sourceforge.net/ -->

<html>
<head>
<title>HACKDENS(1NEMO) manual page</title>
</head>
<body bgcolor='white'>
<a href='#toc'>Table of Contents</a><p>

<h2><a name='sect0' href='#toc0'>Name</a></h2>
hackdens - local density estimator using tree algorithm 
<h2><a name='sect1' href='#toc1'>Synopsis</a></h2>
<b>hackdens
in=</b>snapshot <b>out=</b>image [parameter=value] 
<h2><a name='sect2' href='#toc2'>Description</a></h2>
<i>hackdens</i> calculates
the local density in the configuration space using the hierarchical N-body
algorithm (J. Barnes and P. Hut, <i>Nature</i> <b>324</b>, 446). For small N or systems
with complex geometry <a href='snapdens.1NEMO.html'><b>snapdens(1NEMO)</b></a>
 may be preferred. For even more performance,
<a href='density.1falcON.html'><b>density(1falcON)</b></a>
 can be used. <p>
The density can be writtin in the slot normally
used for Potentials (the default), or if <b>write_at_phi=f</b> be written to a
tag named <i>Density</i>. 
<h2><a name='sect3' href='#toc3'>Parameters</a></h2>
The following parameters are recognized; they
may be given in any order. 
<dl>

<dt><b>in</b>=<i>in-file</i> </dt>
<dd>Input data will be read from <i>in-file</i>
in snapshot format. </dd>

<dt><b>out</b>=<i>out-file</i> </dt>
<dd>Output data are written to <i>out-file</i> in snapshot
format. </dd>

<dt><b>neib</b>=<i>value</i> </dt>
<dd>Number of neighbors used to determine the local density
[default: 6]. 
<p> </dd>

<dt><b>rneib</b>=<i>value</i> </dt>
<dd>Initial radius to search the neighbors. <i>Hackdens</i>
adaptively change this search radius during the calculation. Therefore it
is definitely required that particles in the snapshot are arranged so that
the neighboring particles have similar local density. (See NOTES) [default:
0.1]. </dd>

<dt><b>write_at_phi</b>=<i>t|f</i> </dt>
<dd>Logical if the density data is written in the "Potential"
slot of the snapshot file. If false, the density will be written with tag
"Density". [default: f] </dd>

<dt><b>rsize</b>=<i>value</i> </dt>
<dd>Intial size of the root box. Box will
automatically expanded to keep all particles in it [defaults:4.0] </dd>

<dt><b>rmin</b>=<i>value</i>
</dt>
<dd>If given, the coordinates of the lower left corner of the initial box. If
not given, the center of the root box will lie at the origin. [defaults:none]
</dd>

<dt><b>options</b>=<i>option-string</i> </dt>
<dd>Output control options, specified as a comma-separated
list of keywords. Currently recognized keywords are: <b>mass</b>, <b>phase</b>: output
mass, phase space data with major data outputs [defaults:mass,phase]. </dd>

<dt><b>fcells</b>=<i>value</i>
</dt>
<dd>Ratio of cells to bodies, used  when allocating cells [defaults:0.9]. </dd>

<dt><b>nudge</b>=<i>size</i>
</dt>
<dd>
<p> </dd>

<dt><b>verbose</b>=<i>t|f</i> </dt>
<dd>Logical if print out the number of particles processed during
the calculation [defaults:f]. </dd>
</dl>

<h2><a name='sect4' href='#toc4'>Notes</a></h2>
Since the search radius is adaptively
changed during the calculation, the local density of particles which are
close in the position in the snapshot file should be similar. <p>
Ideally, it
is best if particles are sorted by the local density itself. Since the local
density is not available, the second choice is to sort particles with some
quantity that has strong correlation with the local density. For example,
if the potential is available, sort particles by potential. <p>
In many cases
the system is roughly spherically symmetric. That means the density has
strong correlation with the distance from the center of the cluster. Then
sorting particles by the distance from the center will improve the speed
significantly. 
<h2><a name='sect5' href='#toc5'>Examples</a></h2>
The following example takes an N-body snapshot, sort
the particles in the order of the distance from the C.M., and calculate local
density. <br>
<pre>
   snapcenter nbody.dat nbody.centered
   snapsort nbody.centered nbody.sorted rank="x*x+y*y+z*z"
   hackdens nbody.sorted nbody.density

</pre>
<h2><a name='sect6' href='#toc6'>See Also</a></h2>
<a href='hackforce.1NEMO.html'>hackforce(1NEMO)</a>
, <a href='snapdens.1NEMO.html'>snapdens(1NEMO)</a>
, <a href='density.1falcON.html'>density(1falcON)</a>
 
<h2><a name='sect7' href='#toc7'>Bugs</a></h2>
The local
density is calculated using (neib-1)th neighbor. Calculation can become very
slow if the input snap shot is not well-formed. There should exist an option
that forces the density will be written in the "Aux" slot of the snapshot
file. Current version does not use standard <i>get_snap/put_snap</i> macros. KEY
and AUX will be lost from the output snapshot.  
<h2><a name='sect8' href='#toc8'>Timing</a></h2>
N=4096, merger remnant
<p>
Presorted snapshot: 5 minutes on Sun-3/60, particles are presorted by the
distance from the center of mass of the system. <p>
Random snapshot: 60 minutes
Sun-3/60 
<h2><a name='sect9' href='#toc9'>Author</a></h2>
Jun Makino 
<h2><a name='sect10' href='#toc10'>Update History</a></h2>
<br>
<pre>2-Dec-88  <tt> </tt>&nbsp;<tt> </tt>&nbsp;V1.0:Created  <tt> </tt>&nbsp;<tt> </tt>&nbsp;Jun
6-jul-89<tt> </tt>&nbsp;<tt> </tt>&nbsp;doc updated?<tt> </tt>&nbsp;<tt> </tt>&nbsp;Jun
23-oct-90<tt> </tt>&nbsp;<tt> </tt>&nbsp;doc updated<tt> </tt>&nbsp;<tt> </tt>&nbsp;Peter
18-jul-92<tt> </tt>&nbsp;<tt> </tt>&nbsp;printf -&gt; dprintf to make it pipable<tt> </tt>&nbsp;<tt> </tt>&nbsp;Peter
24-may-02<tt> </tt>&nbsp;<tt> </tt>&nbsp;fixed running out of bits for large-N systems<tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
</pre>
<p> <p>

<hr><p>
<a name='toc'><b>Table of Contents</b></a><p>
<ul>
<li><a name='toc0' href='#sect0'>Name</a></li>
<li><a name='toc1' href='#sect1'>Synopsis</a></li>
<li><a name='toc2' href='#sect2'>Description</a></li>
<li><a name='toc3' href='#sect3'>Parameters</a></li>
<li><a name='toc4' href='#sect4'>Notes</a></li>
<li><a name='toc5' href='#sect5'>Examples</a></li>
<li><a name='toc6' href='#sect6'>See Also</a></li>
<li><a name='toc7' href='#sect7'>Bugs</a></li>
<li><a name='toc8' href='#sect8'>Timing</a></li>
<li><a name='toc9' href='#sect9'>Author</a></li>
<li><a name='toc10' href='#sect10'>Update History</a></li>
</ul>
</body>
</html>
