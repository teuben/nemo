<!-- manual page source format generated by PolyglotMan v3.2, -->
<!-- available at http://polyglotman.sourceforge.net/ -->

<html>
<head>
<title>WORLDPOS(3NEMO) manual page</title>
</head>
<body bgcolor='white'>
<a href='#toc'>Table of Contents</a><p>

<h2><a name='sect0' href='#toc0'>Name</a></h2>
worldpos, xypix - astronomical coordinate conversions 
<h2><a name='sect1' href='#toc1'>Synopsis</a></h2>
<b>int worldpos(</b>
<b>double </b> <i>xpix,</i>  <b>double </b> <i>ypix,</i>  <b>double </b> <i>xref,</i>  <b>double </b> <i>yref,</i> <b>double </b> <i>xrefpix,</i>
 <b>double </b> <i>yrefpix,</i>  <b>double </b> <i>xinc,</i>  <b>double </b> <i>yinc,</i>  <b>double </b> <i>rot,</i> <b>char </b> <i>*type,</i>
 <b>double </b> <i>*xpos,</i>  <b>double </b> <i>*ypos);</i> <p>
<b>int xypix(</b> <b>double </b> <i>xpos,</i>  <b>double </b> <i>ypos,</i>
 <b>double </b> <i>xref,</i>  <b>double </b> <i>yref,</i>  <b>double </b> <i>xrefpix,</i>  <b>double </b> <i>yrefpix,</i>  <b>double
</b> <i>xinc,</i>  <b>double </b> <i>yinc,</i>  <b>double </b> <i>rot,</i> <b>char </b> <i>*type,</i>  <b>double </b> <i>*xpix,</i>  <b>double
</b> <i>*ypix);</i> 
<h2><a name='sect2' href='#toc2'>Description</a></h2>
<b>worldpos</b> and <b>xypix</b>, perform forward and reverse Wold
Coordinate System (WCS) computations for 8 common types of projective geometries
("-SIN", "-TAN", "-ARC", "-NCP", "-GLS", "-MER", "-AIT" and "-STG"): <br>
<pre>        worldpos() converts from pixel location to RA,Dec 
        xypix()    converts from RA,Dec         to pixel location   
</pre>where "(RA,Dec)" are more generically (long,lat). These functions are based
on the WCS implementation of Classic AIPS, an implementation which has
been in production use for more than ten years. See the two memos by Eric
Greisen <p>
        ftp://fits.cv.nrao.edu/fits/documents/wcs/aips27.ps.Z<br>
 <p>
        ftp://fits.cv.nrao.edu/fits/documents/wcs/aips46.ps.Z<br>
 <p>
for descriptions of the 8 projective geometries and the algorithms.  Footnotes
in these two documents describe the differences between these algorithms
and the 1993-94 WCS draft proposal (see URL below). In particular, these
algorithms support ordinary field rotation, but not skew geometries (CD
or PC matrix cases). Also, the MER and AIT algorithms work correctly only
for CRVALi=(0,0). Users should note that GLS projections with yref!=0 will
behave differently in this code than in the draft WCS proposal.  The NCP
projection is now obsolete (it is a special case of SIN).  WCS syntax and
semantics for various advanced features is discussed in the draft WCS proposal
by Greisen and Calabretta at: <p>
        ftp://fits.cv.nrao.edu/fits/documents/wcs/wcs.all.ps.Z<br>
 <p>
<b>worldpos</b> determines accurate position for pixel coordinates. It returns
0 if successful, 1 if the angle too large for projection. <br>
<pre>Input:
xpix<tt> </tt>&nbsp;<tt> </tt>&nbsp;x pixel number  (RA or long without rotation)
ypiy<tt> </tt>&nbsp;<tt> </tt>&nbsp;y pixel number  (dec or lat without rotation)
xref<tt> </tt>&nbsp;<tt> </tt>&nbsp;x reference coordinate value (deg)
yref<tt> </tt>&nbsp;<tt> </tt>&nbsp;y reference coordinate value (deg)
xrefpix<tt> </tt>&nbsp;<tt> </tt>&nbsp;x reference pixel
yrefpix<tt> </tt>&nbsp;<tt> </tt>&nbsp;y reference pixel
xinc<tt> </tt>&nbsp;<tt> </tt>&nbsp;x coordinate increment (deg)
yinc<tt> </tt>&nbsp;<tt> </tt>&nbsp;y coordinate increment (deg)
rot<tt> </tt>&nbsp;<tt> </tt>&nbsp;rotation (deg)  (from N through E)
*type<tt> </tt>&nbsp;<tt> </tt>&nbsp;projection type code e.g. "-SIN"
<tt> </tt>&nbsp;<tt> </tt>&nbsp;Valid are: -SIN, -TAN, -ARC, -NCP, -GLS, -MER, -AIT projections,
<tt> </tt>&nbsp;<tt> </tt>&nbsp;anything else is linear.
Output:
*xpos<tt> </tt>&nbsp;<tt> </tt>&nbsp;x (RA) coordinate (deg)
*ypos<tt> </tt>&nbsp;<tt> </tt>&nbsp;y (dec) coordinate (deg)
</pre><p>
<br>
<pre>xypix determines accurate pixel coordinates for an RA and Dec.
It returns 0 if successful otherwise: 
1 if the angle too large for projection; 
2 if bad values 

Input: 
xpos<tt> </tt>&nbsp;<tt> </tt>&nbsp;x (RA) coordinate (deg)
ypos<tt> </tt>&nbsp;<tt> </tt>&nbsp;y (dec) coordinate (deg)
xref<tt> </tt>&nbsp;<tt> </tt>&nbsp;x reference coordinate value (deg)
yref<tt> </tt>&nbsp;<tt> </tt>&nbsp;y reference coordinate value (deg)
xrefpix<tt> </tt>&nbsp;<tt> </tt>&nbsp;x reference pixel
yrefpix<tt> </tt>&nbsp;<tt> </tt>&nbsp;y reference pixel
xinc<tt> </tt>&nbsp;<tt> </tt>&nbsp;x coordinate increment (deg)
yinc<tt> </tt>&nbsp;<tt> </tt>&nbsp;y coordinate increment (deg)
rot<tt> </tt>&nbsp;<tt> </tt>&nbsp;rotation (deg)  (from N through E)
*type<tt> </tt>&nbsp;<tt> </tt>&nbsp;projection type code e.g. "-SIN";
<tt> </tt>&nbsp;<tt> </tt>&nbsp;Valid are: -SIN, -TAN, -ARC, -NCP, -GLS, -MER, -AIT projections,
<tt> </tt>&nbsp;<tt> </tt>&nbsp;anything else is linear.
Output:                                  
*xpix<tt> </tt>&nbsp;<tt> </tt>&nbsp;x pixel number  (RA or long without rotation)
*ypiy<tt> </tt>&nbsp;<tt> </tt>&nbsp;y pixel number  (dec or lat without rotation)
</pre>
<h2><a name='sect3' href='#toc3'>History</a></h2>
The original version of this code was Emailed to D.Wells on Friday,
23 September by Bill Cotton &lt;bcotton@gorilla.cv.nrao.edu&gt;, who described it
as a "..more or less.. exact translation from the AIPSish..". Changes were made
by Don Wells &lt;dwells@nrao.edu&gt; during the period October 11-13, 1994: <br>
<pre>    1) added GNU license and header comments
    2) added testpos.c program to perform extensive circularity tests
    3) changed float--&gt;double to get more than 7 significant figures
    4) testpos.c circularity test failed on MER and AIT. B.Cotton
       found that "..there were a couple of lines of code [in] the wrong
       place as a result of merging several Fortran routines." 
    5) testpos.c found 0h wraparound in xypix() and worldpos().
    6) E.Greisen recommended removal of various redundant if-statements,
       and addition of a 360d difference test to MER case of
</pre>
<h2><a name='sect4' href='#toc4'>Error Return Code</a></h2>
<br>
<pre>0   <tt> </tt>&nbsp;<tt> </tt>&nbsp;no error
-1
-2
Coordinate SystemsThe following table is a list of the currently described
coordinate systems. The ones implements in these routines are marked with
a *. 
FITS <tt> </tt>&nbsp;<tt> </tt>&nbsp;Number<tt> </tt>&nbsp;<tt> </tt>&nbsp;Name                 <tt> </tt>&nbsp;<tt> </tt>&nbsp;Comments
code <tt> </tt>&nbsp;<tt> </tt>&nbsp;code
----<tt> </tt>&nbsp;<tt> </tt>&nbsp;------<tt> </tt>&nbsp;<tt> </tt>&nbsp;-----------------------<tt> </tt>&nbsp;<tt> </tt>&nbsp;-----------------------------------
DEF<tt> </tt>&nbsp;<tt> </tt>&nbsp;0   <tt> </tt>&nbsp;<tt> </tt>&nbsp;Default = Cartesian
AZP<tt> </tt>&nbsp;<tt> </tt>&nbsp;1   <tt> </tt>&nbsp;<tt> </tt>&nbsp;Zenithal perspective<tt> </tt>&nbsp;<tt> </tt>&nbsp;projp1 required
TAN*<tt> </tt>&nbsp;<tt> </tt>&nbsp;2    <tt> </tt>&nbsp;<tt> </tt>&nbsp;Gnomic                <tt> </tt>&nbsp;<tt> </tt>&nbsp;AZP w/ projp1 = 0
SIN*   <tt> </tt>&nbsp;<tt> </tt>&nbsp;3    <tt> </tt>&nbsp;<tt> </tt>&nbsp;Orthographic          <tt> </tt>&nbsp;<tt> </tt>&nbsp;AZP w/ projp1 = Infinity (&gt;10^14)
STG*   <tt> </tt>&nbsp;<tt> </tt>&nbsp;4    <tt> </tt>&nbsp;<tt> </tt>&nbsp;Stereographic         <tt> </tt>&nbsp;<tt> </tt>&nbsp;AZP w/ projp1 = 1
ARC*   <tt> </tt>&nbsp;<tt> </tt>&nbsp;5    <tt> </tt>&nbsp;<tt> </tt>&nbsp;Zenithal Equidistant
ZPN   <tt> </tt>&nbsp;<tt> </tt>&nbsp;6    <tt> </tt>&nbsp;<tt> </tt>&nbsp;Zenithal polynomial   <tt> </tt>&nbsp;<tt> </tt>&nbsp;prop1-projp9 required, useless
ZEA   <tt> </tt>&nbsp;<tt> </tt>&nbsp;7    <tt> </tt>&nbsp;<tt> </tt>&nbsp;Zenithal equal area
AIR   <tt> </tt>&nbsp;<tt> </tt>&nbsp;8    <tt> </tt>&nbsp;<tt> </tt>&nbsp;Airy                  <tt> </tt>&nbsp;<tt> </tt>&nbsp;projp1 required
CYP   <tt> </tt>&nbsp;<tt> </tt>&nbsp;9    <tt> </tt>&nbsp;<tt> </tt>&nbsp;Cylindrical perspective<tt> </tt>&nbsp;<tt> </tt>&nbsp;projp1 and projp2 required
CAR  <tt> </tt>&nbsp;<tt> </tt>&nbsp;10    <tt> </tt>&nbsp;<tt> </tt>&nbsp;Cartesian
MER*   <tt> </tt>&nbsp;<tt> </tt>&nbsp;11    <tt> </tt>&nbsp;<tt> </tt>&nbsp;Mercator
CEA   <tt> </tt>&nbsp;<tt> </tt>&nbsp;12    <tt> </tt>&nbsp;<tt> </tt>&nbsp;Cylindrical equal area <tt> </tt>&nbsp;<tt> </tt>&nbsp;projp1 required
COP   <tt> </tt>&nbsp;<tt> </tt>&nbsp;13    <tt> </tt>&nbsp;<tt> </tt>&nbsp;Conical perspective    <tt> </tt>&nbsp;<tt> </tt>&nbsp;projp1 and projp2 required
COD   <tt> </tt>&nbsp;<tt> </tt>&nbsp;14    <tt> </tt>&nbsp;<tt> </tt>&nbsp;Conical equidistant    <tt> </tt>&nbsp;<tt> </tt>&nbsp;projp1 and projp2 required
COE   <tt> </tt>&nbsp;<tt> </tt>&nbsp;15    <tt> </tt>&nbsp;<tt> </tt>&nbsp;Conical equal area     <tt> </tt>&nbsp;<tt> </tt>&nbsp;projp1 and projp2 required
COO   <tt> </tt>&nbsp;<tt> </tt>&nbsp;16    <tt> </tt>&nbsp;<tt> </tt>&nbsp;Conical orthomorphic   <tt> </tt>&nbsp;<tt> </tt>&nbsp;projp1 and projp2 required
BON   <tt> </tt>&nbsp;<tt> </tt>&nbsp;17    <tt> </tt>&nbsp;<tt> </tt>&nbsp;Bonne&rsquo;s equal area     <tt> </tt>&nbsp;<tt> </tt>&nbsp;projp1 required
PCO   <tt> </tt>&nbsp;<tt> </tt>&nbsp;18    <tt> </tt>&nbsp;<tt> </tt>&nbsp;Polyconic
GLS*   <tt> </tt>&nbsp;<tt> </tt>&nbsp;19    <tt> </tt>&nbsp;<tt> </tt>&nbsp;Sinusoidal
PAR   <tt> </tt>&nbsp;<tt> </tt>&nbsp;20    <tt> </tt>&nbsp;<tt> </tt>&nbsp;Parabolic
AIT*   <tt> </tt>&nbsp;<tt> </tt>&nbsp;21    <tt> </tt>&nbsp;<tt> </tt>&nbsp;Hammer-Aitoff
MOL   <tt> </tt>&nbsp;<tt> </tt>&nbsp;22    <tt> </tt>&nbsp;<tt> </tt>&nbsp;Mollweide
CSC   <tt> </tt>&nbsp;<tt> </tt>&nbsp;23    <tt> </tt>&nbsp;<tt> </tt>&nbsp;Cobe Quadrilateralized <tt> </tt>&nbsp;<tt> </tt>&nbsp;convergence of inverse is poor
             <tt> </tt>&nbsp;<tt> </tt>&nbsp;Spherical Cube
QSC   <tt> </tt>&nbsp;<tt> </tt>&nbsp;24    <tt> </tt>&nbsp;<tt> </tt>&nbsp;Quadrilateralized 
             <tt> </tt>&nbsp;<tt> </tt>&nbsp;Spherical Cube
TSC   <tt> </tt>&nbsp;<tt> </tt>&nbsp;25    <tt> </tt>&nbsp;<tt> </tt>&nbsp;Tangential Spherical Cube
Copyright
Copyright (C) 1994
Associated Universities, Inc. Washington DC, USA.
</pre>   <br>
 This library is free software; you can redistribute it and/or modify it
under the terms of the GNU Library General Public License as published
by the Free Software Foundation; either version 2 of the License, or (at
your option) any later version.    <br>
 This library is distributed in the hope that it will be useful, but WITHOUT
ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU Library General Public License for
more details.    <br>
 You should have received a copy of the GNU Library General Public License
along with this library; if not, write to the Free Software Foundation,
Inc., 675 Massachusetts Ave, Cambridge, MA 02139, USA. 
<p> Correspondence concerning
AIPS should be addressed as follows: <br>
<pre>           Internet email: aipsmail@nrao.edu
           Postal address: AIPS Group
                           National Radio Astronomy Observatory
                           520 Edgemont Road
                           Charlottesville, VA 22903-2475 USA
</pre>
<h2><a name='sect7' href='#toc7'>See Also</a></h2>
aips <p>
Mark Calabretta&rsquo;s WCSLIB:  <a href='http://www.atnf.csiro.au/people/mcalabre/WCS/index.html'>http://www.atnf.csiro.au/people/mcalabre/WCS/index.html</a>


<h2><a name='sect8' href='#toc8'>Author</a></h2>
Mark Calabretta (code), Peter Teuben (man page) 
<h2><a name='sect9' href='#toc9'>Update History</a></h2>
<br>
<pre>13-oct-94<tt> </tt>&nbsp;<tt> </tt>&nbsp;doc written PJT
</pre><p>

<hr><p>
<a name='toc'><b>Table of Contents</b></a><p>
<ul>
<li><a name='toc0' href='#sect0'>Name</a></li>
<li><a name='toc1' href='#sect1'>Synopsis</a></li>
<li><a name='toc2' href='#sect2'>Description</a></li>
<li><a name='toc3' href='#sect3'>History</a></li>
<li><a name='toc4' href='#sect4'>Error Return Code</a></li>
<li><a name='toc5' href='#sect5'>Coordinate Systems</a></li>
<li><a name='toc6' href='#sect6'>Copyright</a></li>
<li><a name='toc7' href='#sect7'>See Also</a></li>
<li><a name='toc8' href='#sect8'>Author</a></li>
<li><a name='toc9' href='#sect9'>Update History</a></li>
</ul>
</body>
</html>
