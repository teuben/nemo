<!-- manual page source format generated by PolyglotMan v3.2, -->
<!-- available at http://polyglotman.sourceforge.net/ -->

<html>
<head>
<title>CSG(1NEMO) manual page</title>
</head>
<body bgcolor='white'>
<a href='#toc'>Table of Contents</a><p>

<h2><a name='sect0' href='#toc0'>Name</a></h2>
CGS, runCGS-  Collisionless Galactic Simulator N-body code 
<h2><a name='sect1' href='#toc1'>Synopsis</a></h2>
<b>CGS</b>
 <p>
<b>runCGS</b>  [parameter=value] 
<h2><a name='sect2' href='#toc2'>Description</a></h2>
<i>CGS</i>  (Collisionless Galactic Simulator)
is a spherical harmonics Particle-Mesh code originally presented by van
Albada (1982), and recently partially rewritten and improved by Michele
Trenti. The radial grid is adaptive, and keeps constant mass shells. The
angular dependance of the force is expressed in terms of Legendre polynomials.
The code is highly suitable to evolve quasi-spherical smooth initial condition.
<p>
The code computes the potential on an (adaptive) grid, by expanding the
density in spherical harmonics. Forces are then computed by numerical differentiation,
and particles are advanced by a global but variable time-step using a leap-frog
scheme. <p>
The code consists of an original (fortran based) executable, <b>CGS</b>,
 plus a NEMO style wrapper, named <b>runCGS</b>. Since the  fortran executable
assumes files with a fixed name, it can be somewhat cumbersome to run multiple
sets of simulations with different input parameters. A simple frontend organizes
a directories structure and places their output in these run directories,
as well as optionally handles I/O to/from NEMO <a href='snapshot.5.html'><i>snapshot(5NEMO)</i></a>
 files. <p>
A
detailed code description can be found in Trenti M. (2005),   PhD Thesis,
Scuola Normale Superiore Pisa (Italy) [mainly Chapter 3]. A copy of the
thesis is in $NEMO/usr/trenti/CGS/doc/. 
<p> 
<h2><a name='sect3' href='#toc3'>Parameter</a></h2>
There are the NEMO command
line parameters for <b>runCGS</b>: 
<dl>

<dt><b>out=</b><i>directory</i> </dt>
<dd>Output directory. Must not exist
yet.  In this directory a number of files will be produced by the code. See
below.  No Default. </dd>

<dt><b>nbody=</b> </dt>
<dd>Number of bodies. Only needed if a model from scratch
when for <b>flag=1</b> (see below). This parameter is limited by the compiled NPMAX
parameter in the fortran code (see below). [Default: 40000] </dd>

<dt><b>nrad=</b> </dt>
<dd>Number
of radial zones. This number is limited by the compiled NRGMAX parameter
(see below). ??? what about angular, not as parameter ??? [Default: 80]
</dd>

<dt><b>maxstep=</b> </dt>
<dd>Maximum number of integration steps. [Default: 1000] </dd>

<dt><b>dt=</b> </dt>
<dd>Initial
integration step. [Default: 0.025] </dd>

<dt><b>tstart=</b> </dt>
<dd>Start time of integration. [Default:
0.0] </dd>

<dt><b>tstop=</b> </dt>
<dd>Stop time of integration. [Default: 4.0] </dd>

<dt><b>dtmin=</b> </dt>
<dd>Minimum allowed
integration step. [Default: 0.001] </dd>

<dt><b>dtmax=</b> </dt>
<dd>Maximum allowed integration step.
[Default: 0.01] </dd>

<dt><b>flag=</b> </dt>
<dd>Input Creation flag. 1=Plummer sphere from scratch
(needs <b>nbody=</b>). 2=<i>clumpy homogeneous</i> from scratch (needs <b>virial=</b>) 3=initial
conditions from a POS and VEL file.  [Default: 1] </dd>

<dt><b>mass=</b> </dt>
<dd>Total mass of the
system.  [Default: 1.0] </dd>

<dt><b>virial=</b> </dt>
<dd>Initial virial ratio for <b>flag=2</b>. [Default:
1.0] </dd>

<dt><b>ndtcmss=</b> </dt>
<dd>Number of timesteps between CMSS (center of mass of bound
particles adjustment) call. For simulations where the coordinates of the
center of mass of bound particles are not expected to change (e.g. for simulations
starting from quasi-equilibrium configurations) consider setting <b>ndtcmss</b>
&gt;= <b>maxstep</b>. In this case a frequent recentering of the center of expansion
of the potential might in fact introduce artificial stochastic heating.
If starting from out of equilibrium conditions, e.g. for  simulating a cold
collapse, then it is recommended to set <b>ndtcmss</b> to a number sufficiently
small that several recenterings are performed in a dynamical time. [Default:
2000] </dd>

<dt><b>ndtdiag=</b> </dt>
<dd>Number of timesteps between diagnostics call. Note that each
diagnostics call  has some overhead associated with it. [Default: 50] </dd>

<dt><b>ndtout=</b>
</dt>
<dd>Number of time steps between writing snapshots. Note that each call has
some overhead associated with it if the potential is selected for output
[Default: 10] </dd>

<dt><b>in=</b><i>file</i> </dt>
<dd>Input data is read from <i>file</i>, which must be a structured
binary file. If left blank, it is assumed that the (plummer) flag parameter
is set to 1 or 2. Note that masses are ignored. Files must be given in an
absolute directory notation, no relative patchs. </dd>

<dt><b>exe=</b><i>executable</i> </dt>
<dd>Name of
the (fortran) executable. Needs to be in your search $PATH, or else the
full absolute path needs to be supplied here. [Default: CGS.exe] </dd>

<dt><b>nemo=t|f</b>
</dt>
<dd>Should the snapshot data be converted to NEMO format? If so, the ASCII
snapshot is removed. NOTE: Using this option requires extra diskspace. Default:
[<b>t</b>] </dd>
</dl>

<h2><a name='sect4' href='#toc4'>Files</a></h2>
<br>
<pre>PARAMETER.DAT<tt> </tt>&nbsp;<tt> </tt>&nbsp;basic input parameters (see below for details)
initPOS.dat<tt> </tt>&nbsp;<tt> </tt>&nbsp;input positions if flag=3
initVEL.dat<tt> </tt>&nbsp;<tt> </tt>&nbsp;input velocities if flag=3
init_virial.dat<tt> </tt>&nbsp;<tt> </tt>&nbsp;input virial ratio if flag=2
fort.2<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;various diagnostics output (heritage from the original van Albada
1982 version)
fort.11<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;inner lagrangian radii vs time
fort.12<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;outer lagrangian radii vs time
fort.13<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;radial and tangential velocity dispersions
fort.14<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;total radial and tangential kinetic energy
fort.16<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;inertia tensor eigenvalues vs. time
fort.17<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;ellipticity ratios b/a and c/a vs. time
fort.18 <tt> </tt>&nbsp;<tt> </tt>&nbsp;density computed over the radial grid vs. time
fort.19 <tt> </tt>&nbsp;<tt> </tt>&nbsp;time, angular momentum components, and mean shape parameter or orbits
fort.20 <tt> </tt>&nbsp;<tt> </tt>&nbsp;time, total energy, virial ratio -2K/W, total angular momentum
fort.28<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;same as fort.18, but for bound particles
fort.33<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;same as fort.13, but for bound particles
fort.34<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;same as fort.14, but for bound particles
fort.90<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;one or more snapshots (one line header plus index,pc/os,vel data
in a table)
snap.out<tt> </tt>&nbsp;<tt> </tt>&nbsp;Output snapshots, in NEMO&rsquo;s snapshot(5NEMO) format. Note no masses
present!
</pre><p>
Sample <i>PARAMETER.DAT</i> initialization file (the default benchmark): <br>
<pre> 80<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;!RADIAL GRID NUMBER
 40000<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;!NUMBER OF PARTICLES
 1000<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;!NUMBER OF STEPS (MAX)
 2000<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;!NUMBER OF TIME STEPS FOR CMSS CALL
 50<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;!NUMBER OF TIME STEPS FOR DIAGNOSTIC CALL
 10<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;!NUMBER OF TIME STEPS FOR WRITING SNAPSHOTS 
 0.0025<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;!TIME STEP OF INTEGRATION
 0.<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;!START TIME OF SIMULATION
 4.<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;!END TIME OF SIMULATION
 1.<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;!TOTAL MASS OF SYSTEM
 1<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;!PLUMMER INIT CONDITION FLAG (1=true)
 0.01<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;!MAX ALLOWED DT --&gt; MDT
 0.001<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;!MIN ALLOWED DT
</pre>
<h2><a name='sect5' href='#toc5'>Examples</a></h2>
The following example uses runCGS to run the standard benchmark:
<br>
<pre>   % runCGS out=bench1 
</pre>
<h2><a name='sect6' href='#toc6'>Compilation</a></h2>
Note that various parameters (maximum grid size, maximum number
of particles) are hardcoded during compilation, though easily changed in
the right file: <br>
<pre>common.blk:<tt> </tt>&nbsp;<tt> </tt>&nbsp;parameter(NPMAX=2000000)<tt> </tt>&nbsp;<tt> </tt>&nbsp;Max number of particles
common.blk:<tt> </tt>&nbsp;<tt> </tt>&nbsp;parameter(NRGMAX=501)<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;Max number of radial grids
common.blk:<tt> </tt>&nbsp;<tt> </tt>&nbsp;parameter(NHAR=4)        <tt> </tt>&nbsp;<tt> </tt>&nbsp;Number of harmonics used [NHAR &lt;= LMAX-1]
common.blk:<tt> </tt>&nbsp;<tt> </tt>&nbsp;parameter(LMAX=7)        <tt> </tt>&nbsp;<tt> </tt>&nbsp;Legendre Polynomials (do not modify)
common.blk:<tt> </tt>&nbsp;<tt> </tt>&nbsp;parameter(NCE=28)        <tt> </tt>&nbsp;<tt> </tt>&nbsp;Max number of Spherical Harmonics Coefficients
(do not modify)
</pre>
<h2><a name='sect7' href='#toc7'>Benchmarks</a></h2>
The standard benchmark is 40000 particles and runs for 832 steps.
The user CPU is listed (in sec) in the 2nd column.  <br>
<pre>P4/1.6<tt> </tt>&nbsp;<tt> </tt>&nbsp;325.9 (g77 3.2.3)
P4/1.6<tt> </tt>&nbsp;<tt> </tt>&nbsp;292.7 (gfortran 4.0.1)
P4/1.6<tt> </tt>&nbsp;<tt> </tt>&nbsp;195.9 (intel 8.1)
G5/1.6<tt> </tt>&nbsp;<tt> </tt>&nbsp;218.5 (g77 3.5.0)
AMD64/<tt> </tt>&nbsp;<tt> </tt>&nbsp;130.3 (g77 3.4.2)
Xeon-X5660@2.80GHz<tt> </tt>&nbsp;<tt> </tt>&nbsp;79.4 (gfortran_4.4.7 -O3) - gaia
i7-8550U @ 1.80GHz<tt> </tt>&nbsp;<tt> </tt>&nbsp;43.4 (gfortran_7.3.0 -O3) - T480
i7-3820 CPU @ 3.60GHz<tt> </tt>&nbsp;<tt> </tt>&nbsp;52.5 (gfortran_4.4.7 -O3) - dante
i7-3820 CPU @ 3.60GHz<tt> </tt>&nbsp;<tt> </tt>&nbsp;31.7 (ifort_12.1.0 -O3) - dante
</pre>You can run the command either as: <br>
<pre>   % time runCGS out=bench1 nemo=f
or
   % time CGS
</pre>
<h2><a name='sect8' href='#toc8'>Data Conversion</a></h2>
If output <a href='snapshot.5.html'><i>snapshot(5NEMO)</i></a>
 are requested, CGS will create
a file <b>fort.90</b>, which can be converted to NEMO&rsquo;s <a href='snapshot.5.html'><i>snapshot(5NEMO)</i></a>
, viz. <br>
<pre>   tabtos $old/fort.90 snap90 nbody,time skip,pos,vel,acc,phi
</pre>
<p> 
<h2><a name='sect9' href='#toc9'>Units</a></h2>
Although all particles are equally massive (by the nature of the
code), the total mass of the system can be choosen as an input parameter.
The gravitation constant is 4.4971, which is appropriate for a galactic
scale system where the units (see also <a href='units.5.html'><i>units(5NEMO)</i></a>
) are 10^11 solar mass,
10 kpc and 10^8 years. This gives a unit of velocity of about 97.8 km/s. 
<h2><a name='sect10' href='#toc10'>See
Also</a></h2>
<a href='scfm.1.html'>scfm(1NEMO)</a>
, <a href='quadcode.1.html'>quadcode(1NEMO)</a>
, <a href='snapshot.5.html'>snapshot(5NEMO)</a>
, <a href='units.1.html'>units(1NEMO)</a>
, <a href='units.5.html'>units(5NEMO)</a>

<p>
<br>
<pre>Trenti, M. (2005), PhD Thesis, Pisa (see Chapter 3 for many details on the
code)
Trenti, M. Bertin, G. and van Albada, T.S. (2005) A&amp;A 433, 57
van Albada, T.S. (1982), MNRAS, 201, 939. Dissipationless galaxy formation
and the R to the 1/4-power law 
van Albada, T.S. &amp; van Gorkum, J.H. (1977) A&amp;A,54,121. Experimental Stellar Dynamics
for Systems with Axial Symmetry
</pre>
<h2><a name='sect11' href='#toc11'>Author</a></h2>
Michele Trenti &amp; Tjeerd van Albada (NEMO adaptation: Peter Teuben)

<h2><a name='sect12' href='#toc12'>Credit</a></h2>
Any scientific publication or presentation which has benefited from
using CGS should quote the paper <br>
<pre>   Trenti, M. Bertin, G. and van Albada, T.S. (2005) A&amp;A 433, 57
</pre>(please find this paper and the PhDthesis.pdf file in the subdirectory CGS/doc).

<h2><a name='sect13' href='#toc13'>History</a></h2>
<br>
<pre>2003<tt> </tt>&nbsp;<tt> </tt>&nbsp;original version<tt> </tt>&nbsp;<tt> </tt>&nbsp;M. Trenti &amp; T.van Albada
3-nov-05<tt> </tt>&nbsp;<tt> </tt>&nbsp;V0.1 alpha release testing<tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
12-dec-05<tt> </tt>&nbsp;<tt> </tt>&nbsp;V0.2 writing simple pos/vel snapshots using freqout=<tt> </tt>&nbsp;<tt> </tt>&nbsp;MT/PJT
22-mar-06<tt> </tt>&nbsp;<tt> </tt>&nbsp;V0.5 writing potential and forces to output<tt> </tt>&nbsp;<tt> </tt>&nbsp;MT
22-may-06<tt> </tt>&nbsp;<tt> </tt>&nbsp;V1.0 released within NEMO<tt> </tt>&nbsp;<tt> </tt>&nbsp;MT/PJT
</pre><p>

<hr><p>
<a name='toc'><b>Table of Contents</b></a><p>
<ul>
<li><a name='toc0' href='#sect0'>Name</a></li>
<li><a name='toc1' href='#sect1'>Synopsis</a></li>
<li><a name='toc2' href='#sect2'>Description</a></li>
<li><a name='toc3' href='#sect3'>Parameter</a></li>
<li><a name='toc4' href='#sect4'>Files</a></li>
<li><a name='toc5' href='#sect5'>Examples</a></li>
<li><a name='toc6' href='#sect6'>Compilation</a></li>
<li><a name='toc7' href='#sect7'>Benchmarks</a></li>
<li><a name='toc8' href='#sect8'>Data Conversion</a></li>
<li><a name='toc9' href='#sect9'>Units</a></li>
<li><a name='toc10' href='#sect10'>See Also</a></li>
<li><a name='toc11' href='#sect11'>Author</a></li>
<li><a name='toc12' href='#sect12'>Credit</a></li>
<li><a name='toc13' href='#sect13'>History</a></li>
</ul>
</body>
</html>
