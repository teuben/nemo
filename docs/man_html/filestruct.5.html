<!-- manual page source format generated by PolyglotMan v3.2, -->
<!-- available at http://polyglotman.sourceforge.net/ -->

<html>
<head>
<title>FILESTRUCT(5NEMO) manual page</title>
</head>
<body bgcolor='white'>
HTML automatically generated with <A HREF=http://manpages.ubuntu.com/manpages/bionic/man1/rman.1.html>rman</A><br>
<a href='#toc'>Table of Contents</a><p>

<h2><a name='sect0' href='#toc0'>Name</a></h2>
filestruct - binary structured file format  
<h2><a name='sect1' href='#toc1'>Synopsis</a></h2>
<br>
<pre>#include &lt;stdinc.h&gt;
#include "filesecret.h"         only for local code
#include &lt;filestruct.h&gt;
</pre>
<h2><a name='sect2' href='#toc2'>Format</a></h2>
<br>
<pre> struct _disk_item {<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;Note: DOES NOT EXIST!!
    short int magic;
    char *tag;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;(zero terminated)
    char *type;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;(zero terminated)
    int  *dim;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;(4 byte zero terminated, optional)
    char *data;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;(optional)
 };
 struct item {
    string itemtyp;
    int    itemlen;
    string itemtag;
    int   *itemdim;
    byte  *itemdat;
    long   itempos;
 };

 struct strstk {
    stream  ss_str;
    item   *ss_stk[SetStkLen];
    int     ss_stp;
    bool    ss_seek;
    long    ss_pos;            /* only if RANDOM access allowed */
    itemptr ss_ran;            /* only if RANDOM access allowed */
 };
</pre>
<h2><a name='sect3' href='#toc3'>Description</a></h2>
<i>filestruct</i> is a method for storing data files largely consisting
of character strings, booleans, and possible multi-dimensional arrays of
data.  This data may be structured in a hierarchical form similar to the
Unix directory structure, although there are additional constraints imposed
by the essentially linear nature of the storage media. <p>
In modern parlor,
the format resembles XML but where the data are stores in binary form. Libraries
such as <a href='netcdf.3.html'><i>netcdf(3)</i></a>
 and HDF5 overlap in ideas in this NEMO library. When NEMO
was developed, in 1986, these libraries were not available yet. <p>
The external
data format (visualized by an otherwise non-existing <b>struct _disk_item</b>)
is a tagged list of data <i>item</i>s,  each containing a magic number (also containing
information if the item is a single number or an array), a tag name for
identification and search purposes,  a data type and optionally a dimension
followed by a contiguous data  stream. Certain data types (such as <b>set</b>s)
 do not have a dimension and data associated with them, but merely aid
in structuring the data in hierarchical sets. <p>
The is optional integer array
<b>*dim</b>  is zero terminated, it&rsquo;s presence depends on the value of the <b>magic</b>
header number. As said before, if the data type is a <b>set</b> or <b>tes</b> (see below),
no data is present either. <p>
The intermediary internal format is also called
an <i>item</i>, and is defined by the <b>struct item</b>. In addition to the data-type
the basic length of a data chunk, <b>itemlen</b>, within this item is obtained
from a look-up table. Deferred input is achieved by storing the data in a
block pointed to by <b>itemdat</b> if it is small enough, and keeping track of
the file position where the data started otherwise. This is essentially
the reason why pipes cannot be used in <i>filestruct</i>. <p>
The actual internal format
is governed how the application programmer  uses the <i>get_XXX</i> and put_XXX
routines (see  <a href='filestruct.3.html'><i>filestruct(3NEMO)</i></a>
). 
<h2><a name='sect4' href='#toc4'>Experimental Features</a></h2>
If compiled with
<b>-DRANDOM</b>  some limited random access to data within a data-item is possible.
<p>
If compiled with <b>-DCHKSWAP</b> the disk format is checked against little/big
endian machines. Otherwise, data on disk exist in the host format, and no
effort has been made to make it machine independant (e.g. IEEE floating points
and twos-compliment integers). This is however expected in some future release.

<h2><a name='sect5' href='#toc5'>Zeno Format</a></h2>
The <a href='zeno.1.html'><i>zeno(1NEMO)</i></a>
 package also used this format, but there are
some subtle differences to be described. 
<h2><a name='sect6' href='#toc6'>Files</a></h2>
<br>
<pre>~/src/kernel/io   <tt> </tt>&nbsp;<tt> </tt>&nbsp;filesecret.[ch] filestruct.h
~/inc              <tt> </tt>&nbsp;<tt> </tt>&nbsp;filestruct.h
</pre>
<h2><a name='sect7' href='#toc7'>See Also</a></h2>
<a href='tsf.1.html'>tsf(1NEMO)</a>
, <a href='rsf.1.html'>rsf(1NEMO)</a>
, <a href='csf.1.html'>csf(1NEMO)</a>
, <a href='filestruct.3.html'>filestruct(3NEMO)</a>
, <a href='zeno.1.html'>zeno(1NEMO)</a>


<h2><a name='sect8' href='#toc8'>Author</a></h2>
Joshua Barnes, Lyman Hurd, Peter Teuben 
<h2><a name='sect9' href='#toc9'>Update History</a></h2>
<br>
<pre>dark-ages<tt> </tt>&nbsp;<tt> </tt>&nbsp;V0.0 precurser (filestr)<tt> </tt>&nbsp;<tt> </tt>&nbsp;JEB
xx-apr-87<tt> </tt>&nbsp;<tt> </tt>&nbsp;V1.0 basic operators     <tt> </tt>&nbsp;<tt> </tt>&nbsp;JEB
xx-jul-87<tt> </tt>&nbsp;<tt> </tt>&nbsp;V1.x added f-d coercion, deferred output<tt> </tt>&nbsp;<tt> </tt>&nbsp;Lyman Hurd
xx-xxx-87<tt> </tt>&nbsp;<tt> </tt>&nbsp;V2.0 new types, operators, external fmt  <tt> </tt>&nbsp;<tt> </tt>&nbsp;JEB
9-oct-90<tt> </tt>&nbsp;<tt> </tt>&nbsp;V2.2 created man page, adding random access<tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
20-nov-90<tt> </tt>&nbsp;<tt> </tt>&nbsp;V2.2a merged old man page from Lyman into this one <tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
16-may-92<tt> </tt>&nbsp;<tt> </tt>&nbsp;V3.0 finalized random access                        <tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
6-jul -01<tt> </tt>&nbsp;<tt> </tt>&nbsp;documented the new uNEMO   <tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
27-dec-2019<tt> </tt>&nbsp;<tt> </tt>&nbsp;documented ZENO<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
</pre><p>

<hr><p>
<a name='toc'><b>Table of Contents</b></a><p>
<ul>
<li><a name='toc0' href='#sect0'>Name</a></li>
<li><a name='toc1' href='#sect1'>Synopsis</a></li>
<li><a name='toc2' href='#sect2'>Format</a></li>
<li><a name='toc3' href='#sect3'>Description</a></li>
<li><a name='toc4' href='#sect4'>Experimental Features</a></li>
<li><a name='toc5' href='#sect5'>Zeno Format</a></li>
<li><a name='toc6' href='#sect6'>Files</a></li>
<li><a name='toc7' href='#sect7'>See Also</a></li>
<li><a name='toc8' href='#sect8'>Author</a></li>
<li><a name='toc9' href='#sect9'>Update History</a></li>
</ul>
</body>
</html>
