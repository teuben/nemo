<!-- manual page source format generated by PolyglotMan v3.2, -->
<!-- available at http://polyglotman.sourceforge.net/ -->

<html>
<head>
<title>MOMENT(3NEMO) manual page</title>
</head>
<body bgcolor='white'>
HTML automatically generated with <A HREF=http://manpages.ubuntu.com/manpages/bionic/man1/rman.1.html>rman</A><br>
<a href='#toc'>Table of Contents</a><p>

<h2><a name='sect0' href='#toc0'>Name</a></h2>
ini_moment, accum_moment, decr_moment,  reset_moment, show_moment,
n_moment, sum_moment, sratio_moment, mean_moment, sigma_moment, skewness_moment,
kurtosis_moment, mad_moment, mard_moment, robust_moment, min_moment, max_moment
- various (moving) moment and minmax routines 
<h2><a name='sect1' href='#toc1'>Synopsis</a></h2>
<br>
<pre>#include &lt;moment.h&gt;
void ini_moment(m, mom, ndat)void accum_moment(m, x, w)void decr_moment(m,
x, w)void reset_moment(m)
real show_moment(m, mom)int n_moment(m)real sum_moment(m)real
sratio_moment(m)real mean_moment(m)real median_moment(m)real sigma_moment(m)real
skewness_moment(m)real kurtosis_moment(m)real h3_moment(m)real h4_moment(m)real
mad_moment(m)real mard_moment(m)
real min_moment(m);real max_moment(m);
void
compute_robust_moment(m);int n_robust_moment(m);real min_robust_moment(m);real
max_robust_moment(m);real mean_robust_moment(m);real median_robust_moment(m);real
sigma_robust_moment(m);
Moment *m;int mom, ndat;real x, w;</pre>
<h2><a name='sect2' href='#toc2'>Description</a></h2>
<i>moment</i>
is a set of functions to compute the moments of  a set of real values,
but also keep track of the datamin and datamax. The routines are written
in C but in  an object-oriented fashion as to try and keep the use from
the internal data-structures. The <b>Moment</b> can (and should) be treated as an
opaque datastructure. All information should be obtained through the interface
routines described below. <p>
If only a datamin/max is needed, setting <b>mom&lt;0</b>
can be used to prevent the more expensive moment calculations.  <p>
Moving or
running averages (or moments) can be done by supplying <b>ndat&gt;0</b> to ini_moment.
It will keep a memory of the last <b>ndat</b> data values and the moments now
become running moments. <p>
Note that the <i>median_moment</i> can only be used in
<b>x</b> (the weights are ignored) and moving moment where <b>ndat&gt;0</b>. <p>
<b>mean_moment</b> returns
the mean value, where <b>sigma_moment</b> returns the square root of the variance
<p>
<b>sratio_moment</b> returns a measure of how much signal there is compared to
the noise, by compting (SumP+SumN)/(SumP-SumN). For pure noise  this should
be near 0, and for pure signal, where SumN=0, near 1. <p>
<b>robust_moment&rsquo;s</b> can
also be computed. These are based on an algorithm to remove the outliers.
It first computes the distance between the 1st and 3rd quartile, then removes
all points further than 1.5 times that distance from the 1st and  3rd quartile.
After calling <b>compute_robust_moment</b>, the mean, median and sigma can be
retrieved as those computations are done in a temporary Moment structure.
Caveat: for large datasets and/or moving moments,  robust_moment&rsquo;s can become
expensive because of the need for sorting to get the quartiles. <p>
<b>mad_moment</b>
computes the Median Absolute Deviation (MAD), arguably a better measure
for the Standard Deviation. As with the robust moments, it needs to keep
a copy of the data available. MAD is formally RMS/1.4826.  Related is <b>mard_moment</b>,
the Mean Absolute Relative Difference (MARD). 
<h2><a name='sect3' href='#toc3'>Moments</a></h2>
A note on the h3 and
h4 moments, somewhat peculiar to astronomy. See S2.4 in van der Marel &amp; Franx
(1993)  
<h2><a name='sect4' href='#toc4'>Examples</a></h2>
The following code computes a weighted mean and dispersion
of a set of points: <br>
<pre>    real x[100], w[100];
    int  i,n=100;
    Moment m;
    ...
    ini_moment(&amp;m,2,0);      /* up to 2nd order moment, and using no circular
buffer */
    for (i=0; i&lt;n; i)
<tt> </tt>&nbsp;<tt> </tt>&nbsp;accum_moment(&amp;m,x[i],w[i]);
    printf("Mean: %g   Dispersion: %g\n",
<tt> </tt>&nbsp;<tt> </tt>&nbsp;mean_moment(&amp;m), sigma_moment(&amp;m));
    compute_robust_moment(&amp;m);
    printf("Robust Mean: %g   Dispersion: %g\n",
<tt> </tt>&nbsp;<tt> </tt>&nbsp;mean_robust_moment(&amp;m), sigma_robust_moment(&amp;m));
</pre>
<h2><a name='sect5' href='#toc5'>Moment Structure</a></h2>
A simple data structure (referred to as <i>moment</i> in the above
SYNOPSIS) is used to communicate between different routines: <br>
<pre>typedef struct { 
<tt> </tt>&nbsp;<tt> </tt>&nbsp;int mom;
<tt> </tt>&nbsp;<tt> </tt>&nbsp;int n;
<tt> </tt>&nbsp;<tt> </tt>&nbsp;real *sum;
<tt> </tt>&nbsp;<tt> </tt>&nbsp;real datamin, datamax;
<tt> </tt>&nbsp;<tt> </tt>&nbsp;int ndat;
<tt> </tt>&nbsp;<tt> </tt>&nbsp;int idat;
<tt> </tt>&nbsp;<tt> </tt>&nbsp;real *dat;
<tt> </tt>&nbsp;<tt> </tt>&nbsp;real *sum;
} Moment;
</pre>from the standard include file <i>moment.h</i>. 
<h2><a name='sect6' href='#toc6'>Bugs</a></h2>
When <i>decr_moment</i> is used, the
data min/max is not correct.  Only with <b>ndat&gt;0</b> for moving moments can it
be recomputed correctly. 
<h2><a name='sect7' href='#toc7'>See Also</a></h2>
<a href='grid.3.html'>grid(3NEMO)</a>
 <br>
<pre>http://apophenia.info
</pre>
<h2><a name='sect8' href='#toc8'>Author</a></h2>
Peter Teuben 
<h2><a name='sect9' href='#toc9'>Files</a></h2>
<br>
<pre>~/src/kernel/misc<tt> </tt>&nbsp;<tt> </tt>&nbsp;moment.c
</pre>
<h2><a name='sect10' href='#toc10'>Update History</a></h2>
<br>
<pre>30-oct-93<tt> </tt>&nbsp;<tt> </tt>&nbsp;Created   <tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
8-nov-93<tt> </tt>&nbsp;<tt> </tt>&nbsp;fixed init bug <tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
13-jun-95<tt> </tt>&nbsp;<tt> </tt>&nbsp;added decr_moment<tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
2-feb-05<tt> </tt>&nbsp;<tt> </tt>&nbsp;added moving moments<tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
2-mar-11<tt> </tt>&nbsp;<tt> </tt>&nbsp;added h3,h4<tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
24-apr-13<tt> </tt>&nbsp;<tt> </tt>&nbsp;documented robust statistics<tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
16-jan-14<tt> </tt>&nbsp;<tt> </tt>&nbsp;added MAD<tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
11-jun-14<tt> </tt>&nbsp;<tt> </tt>&nbsp;clarified MAD and MARD (the old MAD was really MARD)<tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
12-jul-20<tt> </tt>&nbsp;<tt> </tt>&nbsp;added min/max for robust moment<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
14-nov-21<tt> </tt>&nbsp;<tt> </tt>&nbsp;added sratio<tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
</pre><p>

<hr><p>
<a name='toc'><b>Table of Contents</b></a><p>
<ul>
<li><a name='toc0' href='#sect0'>Name</a></li>
<li><a name='toc1' href='#sect1'>Synopsis</a></li>
<li><a name='toc2' href='#sect2'>Description</a></li>
<li><a name='toc3' href='#sect3'>Moments</a></li>
<li><a name='toc4' href='#sect4'>Examples</a></li>
<li><a name='toc5' href='#sect5'>Moment Structure</a></li>
<li><a name='toc6' href='#sect6'>Bugs</a></li>
<li><a name='toc7' href='#sect7'>See Also</a></li>
<li><a name='toc8' href='#sect8'>Author</a></li>
<li><a name='toc9' href='#sect9'>Files</a></li>
<li><a name='toc10' href='#sect10'>Update History</a></li>
</ul>
</body>
</html>
