<!-- manual page source format generated by PolyglotMan v3.2, -->
<!-- available at http://polyglotman.sourceforge.net/ -->

<html>
<head>
<title>FLOWCODE(1NEMO) manual page</title>
</head>
<body bgcolor='white'>
<a href='#toc'>Table of Contents</a><p>

<h2><a name='sect0' href='#toc0'>Name</a></h2>
flowcode - evolve an N-body system based on a given flow (2D only) 
<h2><a name='sect1' href='#toc1'>Synopsis</a></h2>
<b>flowcode</b>
[<i>parameter</i>=<i>value</i>] ... 
<h2><a name='sect2' href='#toc2'>Description</a></h2>
<i>flowcode</i> is an equal-timestep N-body integrator
which evolves the particles based on the computed flow (currently only
in 2D) at their current position. The flow is obtained from a standard potential
descriptor, given by the three keywords <b>potname=,potpars=,potfile=</b> (See
also <i>potential(3,5NEMO)</i>), except that flow velocity must be returned instead
of forces. The potential returns the density, if this is meaningful for
that flow-potential. 
<p> <p>
In addition to integrating the equations of motion,
the particles are allowed to loose some (<b>eta</b>) of their random energy (smoothed
over a certain &lsquo;&lsquo;box&rsquo;&rsquo; size (<b>cell</b>)), and turn it into mean orbital motion. (NOT
IMPLEMENTED - see <a href='potcode.1.html'><i>potcode(1NEMO)</i></a>
. <p>
Orbits can also be diffused: at regular
intervals the velocity vector  can be rotated over a randomly gaussian
distributed angle (<b>sigma</b>). 
<h2><a name='sect3' href='#toc3'>Parameters</a></h2>
The following parameters are recognized;
they may be given in any order. 
<dl>

<dt><b>in</b>=<i>in-file</i> </dt>
<dd>Initial conditions will be read
from <i>in-file</i> in snapshot format [default: none - but is required]. </dd>

<dt><b>out</b>=<i>out-file</i>
</dt>
<dd>If given, results are written to <i>out-file</i> in snapshot format [default: empty,
no snapshot output file produced]. </dd>

<dt><b>potname=<i>name</i></b> </dt>
<dd>name of file of <a href='potential.5.html'><i>potential(5NEMO)</i></a>

descriptor  [no default]. </dd>

<dt>potpars=<i>par-list</i> </dt>
<dd>List of parameters to the potential
descriptor. The first parameter must be the pattern speed in the x-y plane
(rotating frames of reference are not  supported for all integration modes).
The remaining parameters are used by the <i>inipotential()</i> routine in the
potential descriptor. [default: none - let them be defined by routine itself].
</dd>

<dt><b>potfile=<i>file-name</i></b> </dt>
<dd>name of an optional datafile to the potential descriptor.
This might be an N-body snapshot or list of spline fit coefficients etc.
[default: none]. </dd>

<dt><b>freq</b>=<i>integ-freq</i> </dt>
<dd>Inverse time-step, to be used with the time
integrator. [Default: <b>64.0</b> (64 steps per unit time)]. </dd>

<dt><b>mode</b>=<i>mode-number</i> </dt>
<dd>Integration
mode number:  0=Euler,  1=PC (Predictor Corrector), 2=modified PC, 3=Runge-Kutta
(JEB modified), 4=4th order Runge-Kutta, 5=LeapFrog. [default: <b>4]. </dd>

<dt><b>tstop</b></b>=<i>stop-time</i>
</dt>
<dd>Time to stop integration in N-body model units. Default is <b>2.0</b>. </dd>

<dt><b>freqout</b>=<i>out-freq</i>
</dt>
<dd>Frequency of major N-body data outputs. Default is <b>4.0</b> (4 frames per unit
time). </dd>

<dt><b>minor_freqout</b>=<i>out-freq</i> </dt>
<dd>Frequency of minor diagnostic outputs. Default
is <b>32.0</b> (32 diagnostic measurements per unit time). </dd>

<dt><b>options</b>=<i>option-string</i>
</dt>
<dd>Miscellaneous control options, specified as a comma-separated list of keywords.
Currently recognized keywords are: <b>reset_time</b>: when reading initial data,
set <i>tnow</i> to zero; <b>new_tout</b>: when restarting, set new output times; <b>mass</b>,
<b>phi</b>, <b>acc</b>, <b>aux</b>:  output mass, potential (density really) acceleration data
and auxilliary (the deflection angle from diffusion is stored here) with
major data outputs. </dd>

<dt><b>eta</b>=<i>loss-fraction</i> </dt>
<dd>*** Fraction of random energy that
is dissipated [Default: <b>0.0</b>]. </dd>

<dt><b>cell</b>=<i>box-size</i> </dt>
<dd>*** Cell size in which dissipation
is performed after every timestep. Dissipation is current performed on a
cartesian grid, in which  cells are <a href='square.2D.html'>square (2D)</a>
 or a <a href='cube.3D.html'>cube (3D)</a>
. [Default:
<b>0.1</b>]. </dd>

<dt><b>rmax</b>=<i>max_box-size</i> </dt>
<dd>*** Maximum size of the "box" (actually cube) within
which dissipation is performed. If a negative number is given, the box is
allow to grow as large as is needed, though this may consume a lot of memory.
Default: <b>-1</b>, i.e. box can grow indefinite. </dd>

<dt><b>fheat=</b><i>fheat</i> </dt>
<dd>*** The ratio of diffusion
angle to rms velocity dispersion in a cell. If <i>fheat&gt;0</i>, each time dissipation
is applied, the rms velocity dispersion in a cell is computed, and a diffusion
angle computed. The velocity vector of each particle is then rotated with
a gaussian distributed value with rms <i>fheat*velsig</i>. This in effect gives
a dissipation dependant heating source. See also <b>sigma=</b>, which is position
independant. [Default: <b>0</b>]. </dd>

<dt><b>sigma</b>=<i>angle</i> </dt>
<dd>Diffusion angle, gaussian distributed
with this sigma, about which each velocity vector is rotated after each
timestep. Diffusion is used only when <i>sigma &gt; 0</i>. [Default: <b>0</b>]. </dd>

<dt><b>freqdiff</b>=<i>diffusion-out-freq</i>
</dt>
<dd>Frequency of diffusion. Currently the same diffusion angle is used between
changes, instead of during a single integration step Default is the same
as the integration frequency (<b>freq=</b>). </dd>

<dt><b>seed</b>=<i>random-seed</i> </dt>
<dd>Random number seed,
only used when diffusion (<b>sigma=</b>) is used. 0 must be used to get the random
seed from the time of the day. [Default: <b>0</b>]. </dd>

<dt><b>headline</b>= </dt>
<dd>Identifying text for
this run. Default: not used. </dd>
</dl>

<h2><a name='sect4' href='#toc4'>Bugs</a></h2>
RK, PC and PC1 don&rsquo;t work in rotating potentials
- use EULER or RK4. <p>
Since <b>cell</b> is a fixed number throughout the execution,
is doesn&rsquo;t deal well with systems who&rsquo;s lenght-scale changes, in particular,
expanding systems will allocate more and more space to hold the dissipation
grid. 
<h2><a name='sect5' href='#toc5'>Concepts</a></h2>
Normally a distinction is made between a <i>streamline</i> and <i>streakline</i>.
A <i>streamline</i> is what we compute here: with a "frozen" field we compute
how a tracer particle would have flown through space. A <i>streamline</i> also
takes into  account that the flow could be a function of time, and now
it computes how a tracer particle would have streamed  through space in
the fluid that changed its flow. 
<h2><a name='sect6' href='#toc6'>Dissipation</a></h2>
Various schemes of dissipation
can be invoked. Here&rsquo;s one, see also Lin &amp; Pringle (1974): <p>
For each cell the
relative position and velocity for each particle within that cell is computed:
<br>
<pre>        R   =  r  - &lt;r &gt;
         i      i     i
        V   =  v  - &lt;v &gt;
         i      i     i
</pre>after which the dimensionless viscosity parameter &rsquo;alpha&rsquo; controls the new
velocity for each particle after a timestep: <br>
<pre>                                 &lt; R  x  V &gt;
                                    j     j
        u  =  &lt;v&gt;  - alpha  R  x ------------   +  (1-alpha) V
         i      i            i                                i
                                 &lt; R  .  R &gt;
                                    j     j  
</pre>
<h2><a name='sect7' href='#toc7'>See Also</a></h2>
<a href='mkflowdisk.1.html'>mkflowdisk(1NEMO)</a>
, <a href='potcode.1.html'>potcode(1NEMO)</a>
 
<h2><a name='sect8' href='#toc8'>Author</a></h2>
Peter Teuben 
<h2><a name='sect9' href='#toc9'>Update History</a></h2>
<br>
<pre>10-apr-96<tt> </tt>&nbsp;<tt> </tt>&nbsp;V0.1 cloned of potcode<tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
7-feb-04<tt> </tt>&nbsp;<tt> </tt>&nbsp;V0.6 implemented diffusion for modes 0,1,4<tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
</pre><p>

<hr><p>
<a name='toc'><b>Table of Contents</b></a><p>
<ul>
<li><a name='toc0' href='#sect0'>Name</a></li>
<li><a name='toc1' href='#sect1'>Synopsis</a></li>
<li><a name='toc2' href='#sect2'>Description</a></li>
<li><a name='toc3' href='#sect3'>Parameters</a></li>
<li><a name='toc4' href='#sect4'>Bugs</a></li>
<li><a name='toc5' href='#sect5'>Concepts</a></li>
<li><a name='toc6' href='#sect6'>Dissipation</a></li>
<li><a name='toc7' href='#sect7'>See Also</a></li>
<li><a name='toc8' href='#sect8'>Author</a></li>
<li><a name='toc9' href='#sect9'>Update History</a></li>
</ul>
</body>
</html>
