<!-- manual page source format generated by PolyglotMan v3.2, -->
<!-- available at http://polyglotman.sourceforge.net/ -->

<html>
<head>
<title>EPIC5(1NEMO) manual page</title>
</head>
<body bgcolor='white'>
<a href='#toc'>Table of Contents</a><p>

<p> 
<h2><a name='sect0' href='#toc0'>Name</a></h2>
epic5 -  Lindblad orbits in ovally perturbed potentials 
<p> 
<h2><a name='sect1' href='#toc1'>Synopsis</a></h2>
<b>epic5</b>
<p>

<p><b>epibin</b> 
<p> 
<h2><a name='sect2' href='#toc2'>Description</a></h2>
<b>epic5</b> computes positions, velocities and densities along
closed orbits of interstellar matter, including frictional forces, in a
galaxy with an arbitrary perturbing potential. Radial velocities are computed
for chosen lines of sight.  These are analytic gas orbits in an arbitrary
rotating galactic potential using the linear epicyclic approximation. 
<p> The
direction of rotation is defined according to the sign of the pattern speed
(positive: counter clock wise rotation, negative: clock wise rotation).

<p> <p>
For theory and description see Per A.B. Lindblad, thesis Stockholm  Observatory
1996, Chapt. 2.2 and Paper V (Lindblad &amp; Lindblad 1994,  ASPC 66, p.29), and
the "EPIC5 manual". <p>
<b>epibin</b> ... bins the LOS velocities from EPIRV, but in the
EXAMPLES section below, some NEMO alternatives are given by converting
the tables to a <a href='snapshot.5.html'><i>snapshot(5NEMO)</i></a>
. 
<p> 
<p> 
<h2><a name='sect3' href='#toc3'>Running</a></h2>
Running <b>epic5</b> is very different
from running a NEMO <i>keyword=value</i> command line program. All input has to
be given interactively from the terminal, and at a number of places you
can re-run an option and stay within the program "looping forever". The first
question will be the name of the input parameter file. An example, <b>epar</b>
is supplied with the package. Three output files (EPIRV, EPIDEN, EPITEST)
need to be present so the program can write on top. This appears to be a
fortran quirck in the way the program was written. <p>
<b>Parameter file:</b> Input
parameters must be given in a parameter file with the following content
(file names are a string with max 10 characters): <br>
<pre>    Name of file with rotation curve                    (&rsquo;VFILE&rsquo;) &rsquo;vrot&rsquo;
    Name of file with perturbing potential              (&rsquo;BFILE&rsquo;) &rsquo;perpot&rsquo;
    Pattern velocity in km/s/kpc                        (OMEGAP)  -18
    Coefficient of friction at 0 kpc                    (BLAMBD0)   7
    Coefficient of friction at RMAX kpc                 (BLAMBDf)   7
    Soft corotation coefficient in km/s/kpc             (EOMEG)     5
    Minimum value for R in the computations in kpc      (R0)        0.01
    Interval of R in the computations in kpc            (DR)        0.5
    Maximum value for R in the computations in kpc      (RMAX)     22
    Number of THETA values (&lt;60) for each R             (NTHETA)   32
</pre>
<p> The rotation curve and the perturbing potential are both ascii files:
<p>
The &rsquo;VFILE&rsquo; must have the following format: <br>
<pre>    NFRAD DRFRAD
    FRAD(I), (I=1,NFRAD)
</pre>
<p> where NFRAD (&lt;NRAD) is the number of velocities and DRFRAD is the radial
increment between velocities in the rotation curve, and FRAD the  velocities.
The first point, I=1, corresponds to a radius R = 0. <p>
The &rsquo;BFILE&rsquo; must have
the following format: <br>
<pre>    NPER DRP MMAX NTH NC
    AMPC(M), (M=1,10) 
    AMPS(M), (M=1,10)
    for M=1,MMAX:
       CP(I,M) (I=1,NPER)
       SP(I,M) (I=1,NPER)
</pre><p>
where NPER (&lt;NRAD) is the number of values and DRP the increment  between
values for the perturbing potential. CP(I,M) and SP(I,M)   are amplitudes
of the COS(M*THETA) resp. SIN(M*THETA) components of  of the Fourier development
the perturbing potential. AMPC(M) and  AMPS(M) are factors with which these
amplitudes will be multiplied.  MMAX (&lt;10) is the maximum M value in the
development of the potential.  NTH (&lt;100) and NC are the number of THETA
values and contours for  potential plotting. <p>
Positions and densities will
be listed in file <b>EPIDEN</b> and plotted in file <b>density.ps</b>. Positions, x and
y velocities will be listed in file <b>EPIRV</b> and plotted in file <b>velocity.ps</b>
<p>
Test values are written in file <b>EPITEST</b>. 
<p> 
<h2><a name='sect4' href='#toc4'>Examples</a></h2>
With the example epar,
vrot and perpot file, here is the kind of dialog you may encounter. Boldface

<p>is user input 
<p> <br>
<pre>% epic5
 Parameter file: 
epar 
 ARE PARAMETERS CORRECT ? (y/n):
y
 Perturbing potential ? (y/n) :
y
 SEE THE INPUT PLOTS ? (y/n):
y
 RMAX =   22.0 ? (y/n):
y
 PERTURBING POTENTIAL:
 Graphics device/type (? to see list, default /NULL): 
/xs
 TOTAL POTENTIAL:
 Graphics device/type (? to see list, default /NULL): 
/xs
 REMAINING INPUT PLOTS ? (y/n):
n
 COMPUTE ORBITS ? (y/n):
y
 PRINT THIS PLOT ? (y/n):
y
 CHANGE RMAX (  22.0)? (y/n): 
n
 PLOT DENSITIES ? (y/n):     @todo: user has no idea what units are
y
 NUMBER OF CONTOURS?:
2
 CONTOURS?:
0.1,1
 PLOT DENSITIES WITH PERTURBING POTENTIAL? (y/n):
n
 PLOT DENSITIES ? (y/n):
n
 GIVE POSITION ANGLE OF LINE OF NODES (BAR=90,TO QUIT   WRITE 360 OR MORE):
45
 CONTOUR INTERVAL (KM/S)?:
20
 GIVE POSITION ANGLE OF LINE OF NODES (BAR=90,TO QUIT   WRITE 360 OR MORE):
999
</pre>
<p> The <b>perpot</b> file can probably be generated from an N-body snapshot using
the <a href='snapfour.1.html'><i>snapfour(1NEMO)</i></a>
 program. Has not been tried. 
<p> <p>
THe <b>EPIRV</b> file is a simple
list of <b>x,y,vx,vy</b>, in NEMO <a href='bodytrans.5.html'><i>bodytrans(5NEMO)</i></a>
 terms, so it is straightforward
to replace some of the plotting functionality with NEMO tools. Here are
some examples, first converting the table to a snapshot: <br>
<pre> 
   # convert velocities to snapshot
   tabtos EPIRV snap1 block1=x,y,vx,vy
   # make a velocity field
   snaprotate snap1 - 45 x |\
       snapmap - - xrange=-32:32 yrange=-32:32 evar=vz  svar=1 |\
       ccdfits - snap1.fits
   # make a global profile
   snaprotate snap1 - 45 x |\
<tt> </tt>&nbsp;<tt> </tt>&nbsp;snapprint - vx |\
<tt> </tt>&nbsp;<tt> </tt>&nbsp;tabhist - 1 -320 320 bins=16
   # convert densities to snapshot
   tabtos EPIDEN snap2 block1=x,y,m
   # make a density map
   snapmap snap2 - xrange=-32:32 yrange=-32:32 evar=m svar=1 |\
       ccdfits - snap2.fits
<tt> </tt>&nbsp;<tt> </tt>&nbsp;
</pre>formally this is not exactly correct, since the velocities are not weighted
by their densities. The two arrays (EPIDEN and EPIRV) are not on the same
grid, making the correct procedure a bit more work for this short example.

<p> 
<h2><a name='sect5' href='#toc5'>Units</a></h2>
The units here are kpc and km/s. If masses are in units of 1e6 solarmass,
G=4.3 See also <a href='units.1.html'><i>units(1NEMO)</i></a>
. 
<p> 
<h2><a name='sect6' href='#toc6'>Caveats</a></h2>
The epic5.pdf manual is not available
(yet) <p>
fortran is an annoying language with the the first columns sometimes
just is blank. This complicated fixed formated reading, which is a bug I
had to fix. Version creep? <p>
There is a unix IRC client with the same name,
see <a href='epic5.1.html'><i>epic5(1)</i></a>
. But we were here first, so there. 
<p> 
<h2><a name='sect7' href='#toc7'>Files</a></h2>
<br>
<pre>$NEMO/usr/lindblad/epic5<tt> </tt>&nbsp;<tt> </tt>&nbsp;code distribution
epar<tt> </tt>&nbsp;<tt> </tt>&nbsp;input parameter file for epic5
vfile<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;rotation curve (1st filename in epar) ("vrot")
bfile<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;perturbing potential file (2nd filename in epar) ("perpot")
EPIRV<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;written (23) - but must exist to bootstrap
EPIDEN<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;written (22) - but must exist to bootstrap
EPITEST<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;written (25) - but must exist to bootstrap
density.ps<tt> </tt>&nbsp;<tt> </tt>&nbsp;pgplot file produced by epic5
velocity.ps<tt> </tt>&nbsp;<tt> </tt>&nbsp;pgplot file produced by epic5
orbits.ps<tt> </tt>&nbsp;<tt> </tt>&nbsp;pgplot file produced by epic5
histogram.ps<tt> </tt>&nbsp;<tt> </tt>&nbsp;produced by epibin
</pre>
<p> 
<h2><a name='sect8' href='#toc8'>See Also</a></h2>
<a href='tabplot.1.html'>tabplot(1NEMO)</a>
, <a href='tabtos.1.html'>tabtos(1NEMO)</a>
, <a href='tabhist.1.html'>tabhist(1NEMO)</a>
, <a href='snapprint.1.html'>snapprint(1NEMO)</a>
,
<a href='snapplot.1.html'>snapplot(1NEMO)</a>
,  <a href='snapfour.1.html'>snapfour(1NEMO)</a>
, <a href='snapshot.5.html'>snapshot(5NEMO)</a>
 <p>
<a href='https://ui.adsabs.harvard.edu/abs/1994ASPC...66...29L/abstract'>https://ui.adsabs.harvard.edu/abs/1994ASPC...66...29L/abstract</a>

- <i>Kinematics of Interstellar Matter in a Barred Potential in the Epicyclic
Approximation</i> (EPIC V1) <p>
<a href='https://ui.adsabs.harvard.edu/abs/2012MNRAS.421.1089P/abstract'>https://ui.adsabs.harvard.edu/abs/2012MNRAS.421.1089P/abstract</a>

-  <i>Analytic gas orbits in an arbitrary rotating galactic potential using
the linear epicyclic approximation</i> (EPIC V5) <p>
<a href='https://ui.adsabs.harvard.edu/abs/2013PhDT.........5P/abstract'>https://ui.adsabs.harvard.edu/abs/2013PhDT.........5P/abstract</a>

- <i>Rearrangement of gas in disc galaxies</i>, Thesis Pinol-Ferrer 
<h2><a name='sect9' href='#toc9'>Ads</a></h2>
@ads <A HREF=https://ui.adsabs.harvard.edu/abs/2012MNRAS.421.1089P> 2012MNRAS.421.1089P </A>

<p> 
<h2><a name='sect10' href='#toc10'>Author</a></h2>
Per A.B. Lindblad, Per Olaf Lindblad (1993), +Nuria, +Kambiz (2012
adaptations), +Peter (2021 distribution) 
<p> 
<h2><a name='sect11' href='#toc11'>History</a></h2>
<br>
<pre>11-aug-1993<tt> </tt>&nbsp;<tt> </tt>&nbsp;First version (P.O. Lindblad &amp; P.A.B. Lindblad)
2011-2012<tt> </tt>&nbsp;<tt> </tt>&nbsp;Modification by P.O. Lindblad, N. Pinol-Ferrer and K Fathi (see source
code)
apr-2021<tt> </tt>&nbsp;<tt> </tt>&nbsp;Adapted for NEMO<tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
</pre><p>

<hr><p>
<a name='toc'><b>Table of Contents</b></a><p>
<ul>
<li><a name='toc0' href='#sect0'>Name</a></li>
<li><a name='toc1' href='#sect1'>Synopsis</a></li>
<li><a name='toc2' href='#sect2'>Description</a></li>
<li><a name='toc3' href='#sect3'>Running</a></li>
<li><a name='toc4' href='#sect4'>Examples</a></li>
<li><a name='toc5' href='#sect5'>Units</a></li>
<li><a name='toc6' href='#sect6'>Caveats</a></li>
<li><a name='toc7' href='#sect7'>Files</a></li>
<li><a name='toc8' href='#sect8'>See Also</a></li>
<li><a name='toc9' href='#sect9'>Ads</a></li>
<li><a name='toc10' href='#sect10'>Author</a></li>
<li><a name='toc11' href='#sect11'>History</a></li>
</ul>
</body>
</html>
