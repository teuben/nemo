<!-- manual page source format generated by PolyglotMan v3.2, -->
<!-- available at http://polyglotman.sourceforge.net/ -->

<html>
<head>
<title>SNAPDENS(1NEMO) manual page</title>
</head>
<body bgcolor='white'>
<a href='#toc'>Table of Contents</a><p>

<h2><a name='sect0' href='#toc0'>Name</a></h2>
snapdens - local density estimator in an N-body snapshot 
<h2><a name='sect1' href='#toc1'>Synopsis</a></h2>
<p>
<b>snapdens
in=</b>snap_in  [parameter=value] 
<h2><a name='sect2' href='#toc2'>Description</a></h2>
<b>snapdens</b> finds the space density
in an N-body snapshot by using the Kth nearest neighbor density estimator
discussed by Casertano &amp; Hut (1985, ApJ 298, 80). It uses a simple N^2 algorithm,
and is hence slow for large snapshots (see also <a href='hackdens.1.html'><i>hackdens(1NEMO)</i></a>
). <p>
In case
the number of nearest neighbours used is large enough and the velocity
distribution function is close enough to gaussian an estimate for the phase
space density can also be obtained (see e.g. the discussion in Lake (1989AJ.....97.1312L))
<p>
Standard output (not the table) is: <i> density weighted  center of mass,
nearest neighbor, maximum density, density radius, density weighted average
density</i>. 
<h2><a name='sect3' href='#toc3'>Parameters</a></h2>
The following parameters are recognized in any order
if the keyword is also given: 
<dl>

<dt><b>in=<i>in-file</i></b> </dt>
<dd>input file, in <a href='snapshot.5.html'><i>snapshot(5NEMO)</i></a>

format [no default] </dd>

<dt><b>out=<i>out-file</i></b> </dt>
<dd>optional output file, in <a href='snapshot.5.html'><i>snapshot(5NEMO)</i></a>

format. The Aux() key will contain the density or phase space density, depending
on the <b>dens</b> key below. [not used]. </dd>

<dt><b>kmax=<i>k_max</i></b> </dt>
<dd>Number of nearest neighbours
used in the density estimator. [default: <b>6</b>]. </dd>

<dt><b>dens=t|f</b> </dt>
<dd>Density written to file
(<b>dens=t</b>) or phase space density (<b>dens=f</b>) (future expansion) [default: <b>t</b>].
</dd>

<dt><b>tab=t|f</b> </dt>
<dd>Table output? If selected, it shows <i>radius, density, phase space
density, K&rsquo;th nearest neighbor, velocity dispersion</i>. [default: <b>t</b>]. </dd>

<dt><b>format=</b><i>f_fmt</i>
</dt>
<dd>Format with which the numbers are output in case a table was selected (see
above) [default: <b>%e</b>]. </dd>

<dt><b>tfactor=</b> </dt>
<dd>If used, this factor is used to scale radii
to velocities, used in computing the phase space densities. ** in development
** </dd>

<dt><b>nn=t|f</b> </dt>
<dd>If set, the neighest neighbor (a number from 0 and Nnbody-1) is
saved in the <i>Key</i> of a <a href='snapshot.5.html'><i>snapshot(5NEMO)</i></a>
.  This is required for the <a href='atlas.5.html'><i>atlas(5NEMO)</i></a>

format. Default: f </dd>

<dt><b>ndim=2|3f</b> </dt>
<dd>Dimensionality of space. For ndim=2 a surface
density will be computed. Default: 3 </dd>
</dl>

<h2><a name='sect4' href='#toc4'>Timing</a></h2>
<br>
<pre>Hackforce:<tt> </tt>&nbsp;<tt> </tt>&nbsp;Nbody=16384<tt> </tt>&nbsp;<tt> </tt>&nbsp;Kmax=32<tt> </tt>&nbsp;<tt> </tt>&nbsp;2600"<tt> </tt>&nbsp;<tt> </tt>&nbsp;grolsch SUN 3/160 (f68881)
Snapdens:<tt> </tt>&nbsp;<tt> </tt>&nbsp;Nbody=1024<tt> </tt>&nbsp;<tt> </tt>&nbsp;Kmax=8<tt> </tt>&nbsp;<tt> </tt>&nbsp;240"/0.41 <tt> </tt>&nbsp;<tt> </tt>&nbsp;guinness (f68881)  / P4/1.6
Snapdens:<tt> </tt>&nbsp;<tt> </tt>&nbsp;Nbody=16384<tt> </tt>&nbsp;<tt> </tt>&nbsp;Kmax=64<tt> </tt>&nbsp;<tt> </tt>&nbsp;75000"/83"<tt> </tt>&nbsp;<tt> </tt>&nbsp;grolsch SUN 3/160 (f68881) / P4/1.6
Snapdens:<tt> </tt>&nbsp;<tt> </tt>&nbsp;Nbody=512<tt> </tt>&nbsp;<tt> </tt>&nbsp;Kmax=16<tt> </tt>&nbsp;<tt> </tt>&nbsp;65"<tt> </tt>&nbsp;<tt> </tt>&nbsp;pollux SUN 3/110 (f68881)
Hackdens:<tt> </tt>&nbsp;<tt> </tt>&nbsp;Nbody=512<tt> </tt>&nbsp;<tt> </tt>&nbsp;Kmax=16 xx"<tt> </tt>&nbsp;<tt> </tt>&nbsp;pollux SUN 3/110 (f68881)
</pre>
<h2><a name='sect5' href='#toc5'>See Also</a></h2>
<a href='snappeak.1.html'>snappeak(1NEMO)</a>
, <a href='snapstat.1.html'>snapstat(1NEMO)</a>
, <a href='hackdens.1.html'>hackdens(1NEMO)</a>
, <a href='density.1falcON.html'>density(1falcON)</a>
,
<a href='snapatlas.1.html'>snapatlas(1NEMO)</a>
, <a href='atlas.5.html'>atlas(5NEMO)</a>
, <a href='snapshot.5.html'>snapshot(5NEMO)</a>
 <br>
<pre>M. Maciejewski et. al: <tt> </tt>&nbsp;<tt> </tt>&nbsp;Phase-space structures I: A comparison of 6D density
estimators (arXiv:0810.0504v1)
Wozniak &amp; Kruzewski: On Estimating Non-uniform Density Distributions using
N Nearest Neighbors (arXiv:1301.5346)
</pre>
<h2><a name='sect6' href='#toc6'>Author</a></h2>
Peter Teuben 
<h2><a name='sect7' href='#toc7'>Files</a></h2>
<br>
<pre>~/src/pjt/nbody     snapdens.c snapdens.1
</pre>
<h2><a name='sect8' href='#toc8'>Update History</a></h2>
<br>
<pre>1-Nov-88<tt> </tt>&nbsp;<tt> </tt>&nbsp;V1.0: created          <tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
12-apr-03<tt> </tt>&nbsp;<tt> </tt>&nbsp;V1.5 added nn= and ndim=<tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
</pre>
<p> <p>

<hr><p>
<a name='toc'><b>Table of Contents</b></a><p>
<ul>
<li><a name='toc0' href='#sect0'>Name</a></li>
<li><a name='toc1' href='#sect1'>Synopsis</a></li>
<li><a name='toc2' href='#sect2'>Description</a></li>
<li><a name='toc3' href='#sect3'>Parameters</a></li>
<li><a name='toc4' href='#sect4'>Timing</a></li>
<li><a name='toc5' href='#sect5'>See Also</a></li>
<li><a name='toc6' href='#sect6'>Author</a></li>
<li><a name='toc7' href='#sect7'>Files</a></li>
<li><a name='toc8' href='#sect8'>Update History</a></li>
</ul>
</body>
</html>
