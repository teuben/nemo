<!-- manual page source format generated by PolyglotMan v3.2, -->
<!-- available at http://polyglotman.sourceforge.net/ -->

<html>
<head>
<title>GALAXY1(1NEMO) manual page</title>
</head>
<body bgcolor='white'>
HTML automatically generated with <A HREF=http://manpages.ubuntu.com/manpages/bionic/man1/rman.1.html>rman</A><br>
<a href='#toc'>Table of Contents</a><p>

<h2><a name='sect0' href='#toc0'>Name</a></h2>
galaxy -  3D FFT N-body code 
<h2><a name='sect1' href='#toc1'>Synopsis</a></h2>
<b>galaxy</b>  
<h2><a name='sect2' href='#toc2'>Description</a></h2>
<i>galaxy</i>  is a
direct descendant of the code first used by James &amp; Sellwood (1978, MNRAS
v182, p331) with only minor refinements since.  The Poisson solver was written
exclusively by Richard James and uses the algorithm descibed in James (1977,
J Comp Phys v25, p71).  This algorithm determines the gravitational potential
of an isolated mass distribution using FFTs on a 3-D Cartesian grid without
the need to remove images by doubling the grid size in each dimension. 
The motion of particles within the grid volume is integrated forwards in
time according to accelerations determined by differencing the grid potential
values.  Particles that leave the grid volume are discarded. <p>
Very large numbers
of particles can be employed at little cost since most cpu time is taken
up by the determination of the potential on the grid.  [See Sellwood (1997,
in "Computational Astrophysics" ed Clarke &amp; West, ASP Conf series v123,
p215) for a performance comparison with other codes.] <p>
The version of the
algorithm used here requires the individual grid cells to be cubic, but
the overall grid need not be cubic.  The FFTs supplied require the number
of mesh spaces in each direction to be (2**n + 1), where the exponent n
may be chosen independently for each coordinate direction.  As large grids
require a great deal of memory (c400 MB for a 257**3 grid), it is recommended
that the parameters set in the include file &rsquo;<b>rjinclude.h</b>&rsquo; be no larger than
necessary, although the code will function correctly as long as the actual
dimensions used do not exceed those set by the parameter statement at compile
time. <p>
Time integration follows the standard 2nd order time-centered leap-frog,
with the velocities one half a time step out of synchrony with positions.
 This difference is maintained in the internally stored coordinates and
is created and can be undone, by a call to subroutine TMCENT.  For output
of the particle coordinates at a particular instant, the velocities need
to be the average of those before and after the time for the positions.
<p>
Results, in this public version, are simply the phase space coordinates
of all the particles as often as requested, which can create a very large
file. The authors therefore do not employ this scheme themselves, preferring
instead to measure and save properties of the model as the simulation evolves.
An example of this "on the fly" analysis is provided in the routines ICHECK
and MEASURE to determine the global integrals (energy, momentum, etc) <p>
The
grid is set up in subroutine GRDSET using parameters read in from a short
ASCII input file (<i>galaxy.dat</i>). The positions and velocities of the particles
are read in subroutine LOADUP, from a local file <i>galaxy.ini</i>. The gravitational
field is determined by a call to FINDF. The model is integrated forward
by a call to STEP. After the desired evolution is completed, the positions
and velocities of the particles are saved by a call to UNLOAD. The new 2014
public release of <b>galaxy</b> contains an updated code, including versions of
SCF (see <a href='scfm.1.html'><i>scfm(1NEMO)</i></a>
) and BHTREE (see <a href='hackcode1.1.html'><b>hackcode1(1NEMO)</b></a>
). 
<h2><a name='sect3' href='#toc3'>Files</a></h2>
<br>
<pre>$NEMO/src/nbody/evolve/sellwood  <tt> </tt>&nbsp;<tt> </tt>&nbsp;source code tree (w/ res2snap &amp; snap2ini)
$NEMO/usr/sellwood/GALAXY15<tt> </tt>&nbsp;<tt> </tt>&nbsp;source code tree for GALAXY15
</pre>The main files associated with the run are (notice the basename &rsquo;galaxy&rsquo;
is fixed by the code): <br>
<pre>galaxy.dat<tt> </tt>&nbsp;<tt> </tt>&nbsp;ASCII input: grid parameters, length and time scales
galaxy.ini<tt> </tt>&nbsp;<tt> </tt>&nbsp;ASCII input: initial coordinates of all the particles
galaxy.lis<tt> </tt>&nbsp;<tt> </tt>&nbsp;ASCII output: a brief summary of progress (appended)
galaxy.fin<tt> </tt>&nbsp;<tt> </tt>&nbsp;ASCII output: final coordinates of all the particles
galaxy.res<tt> </tt>&nbsp;<tt> </tt>&nbsp;binary output: coordinates and potentials at intervals  (appended)
galaxy.tmp<tt> </tt>&nbsp;<tt> </tt>&nbsp;short ASCII file (deleted when closed)
galaxy.aux<tt> </tt>&nbsp;<tt> </tt>&nbsp;large binary file (deleted when closed)
</pre><p>
Sample <i>galaxy.dat</i> initialization file: <br>
<pre> 33  33  33    # number of grid cells in (x,y,z)
 15.0          # number of grid cells per length unit
 0.05          # time step length
 0.5           # time between particle outputs
 0.1           # time between integral checks
 1.00          # end time
</pre><p>
The format of the ASCII <i>galaxy.ini</i> (and also <i>galaxy.fin</i>) files is: <br>
<pre>    Time Mass Nbody
    X_1 Y_1 Z_1 VX_1 VY_1 VZ_1
    ....
    X_n Y_n Z_n VX_n VY_n VZ_n
</pre>The <i>galaxy.fin</i> can also be used for a restart. Note that the timestep is
one more then the last requested time, to prevent that the  <i>galaxy.res</i> file
will contain a datadump on the restart timestep twice. 
<h2><a name='sect4' href='#toc4'>Compilation</a></h2>
Note that
the maximum grid size and maximum amount of particles are hardcoded during
compilation. See comments in <b>rjinclude.h</b> how to change the maximum grid size
and the parameter <b>mbod</b> in <b>galaxy.f</b> for the maximum particle number that
can be used. <p>
The new release V15 does not depend on commercial (e.g. NAG)
software, and can be compiled using open source tools and libraries. PGPLOT
must be installed independantly. 
<h2><a name='sect5' href='#toc5'>Res2snap</a></h2>
The following shell script, given
as an example, will convert a particular snapshot from a binary "galaxy.res"
file into a NEMO <a href='snapshot.5.html'><i>snapshot(5NEMO)</i></a>
 format. <p>
<br>
<pre>#! /bin/csh -f
if ($#argv != 2) then
  echo Usage: res2snap FILE N
  echo Converts the N-th snapshot from FILE to NEMOs snapshot format
  exit 0
endif
#   set command line parameters
set file=$1
set n=$2
#   get header info 
set tsnap=&lsquo;unfio $file "$n*2-1" float | awk &rsquo;{if (NR==1) print $1}&rsquo;&lsquo;
set nbody=&lsquo;unfio $file "$n*2-1" int   | awk &rsquo;{if (NR==2) print $1}&rsquo;&lsquo;
#   dump data and convert to snapshot
unfio $file "$n*2" float maxbuf=100000 |\
   tabtos - ${file:r}.$n.snap "" pos,vel,phi options=wrap times=$tsnap nbody=$nbody
</pre>
<h2><a name='sect6' href='#toc6'>Benchmarks</a></h2>
1000 particles on a 32**3 cube integrating for 20 steps took
4.77 a sparc Ultra-2. (1997?) <p>
2021 update: 200 steps on an i5-1135G7 took 3.7
13 speedup from the 2004 results. However, compiling with flang (FFLAGS=-O3),

<p>200 steps took 0.22 
<p> 
<h2><a name='sect7' href='#toc7'>See Also</a></h2>
<a href='rungalaxy.1.html'>rungalaxy(1NEMO)</a>
, <a href='unfio.1.html'>unfio(1NEMO)</a>
, <a href='snapshot.5.html'>snapshot(5NEMO)</a>

<p>
<br>
<pre>James &amp; Sellwood (1978, MNRAS v182, p331) 
James (1977, J Comp Phys v25, p71).  
Sellwood (1997, in "Computational Astrophysics" ed Clarke &amp; West, ASP Conf
series v123, p215) 
http://www.physics.rutgers.edu/galaxy   (full 2014 version; V1.5 and later)
</pre>
<p> 
<h2><a name='sect8' href='#toc8'>Ads</a></h2>
@ads <A HREF=https://ui.adsabs.harvard.edu/abs/2014arXiv1406.6606S> 2014arXiv1406.6606S </A>
<h2><a name='sect9' href='#toc9'>Author</a></h2>
Jerry Sellwood 
<h2><a name='sect10' href='#toc10'>History</a></h2>
<br>
<pre>9-jun-97<tt> </tt>&nbsp;<tt> </tt>&nbsp;V1.0  Sellwood public release/adopted for NEMO  <tt> </tt>&nbsp;<tt> </tt>&nbsp;JS/PJT
24-jun-97<tt> </tt>&nbsp;<tt> </tt>&nbsp;V1.1  added ICHECK/MEASURE; dtlog to galaxy.dat <tt> </tt>&nbsp;<tt> </tt>&nbsp;JS
18-mar-04<tt> </tt>&nbsp;<tt> </tt>&nbsp;fixed bad usage line; refer to rungalaxy now<tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
8-mar-06<tt> </tt>&nbsp;<tt> </tt>&nbsp;V1.3  now installs by default into NEMOBIN<tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
26-jun-2014<tt> </tt>&nbsp;<tt> </tt>&nbsp;notes on the official full public release<tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
10-mar-2017     notes on the new V15 release<tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
6-feb-2018<tt> </tt>&nbsp;<tt> </tt>&nbsp;notes on the new V1.5.2 release<tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
</pre><p>

<hr><p>
<a name='toc'><b>Table of Contents</b></a><p>
<ul>
<li><a name='toc0' href='#sect0'>Name</a></li>
<li><a name='toc1' href='#sect1'>Synopsis</a></li>
<li><a name='toc2' href='#sect2'>Description</a></li>
<li><a name='toc3' href='#sect3'>Files</a></li>
<li><a name='toc4' href='#sect4'>Compilation</a></li>
<li><a name='toc5' href='#sect5'>Res2snap</a></li>
<li><a name='toc6' href='#sect6'>Benchmarks</a></li>
<li><a name='toc7' href='#sect7'>See Also</a></li>
<li><a name='toc8' href='#sect8'>Ads</a></li>
<li><a name='toc9' href='#sect9'>Author</a></li>
<li><a name='toc10' href='#sect10'>History</a></li>
</ul>
</body>
</html>
