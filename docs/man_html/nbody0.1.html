<!-- manual page source format generated by PolyglotMan v3.2, -->
<!-- available at http://polyglotman.sourceforge.net/ -->

<html>
<head>
<title>NBODY0(1NEMO) manual page</title>
</head>
<body bgcolor='white'>
<a href='#toc'>Table of Contents</a><p>

<h2><a name='sect0' href='#toc0'>Name</a></h2>
nbody0, nbody00 - direct summation Aarseth N-body integrator 
<h2><a name='sect1' href='#toc1'>Synopsis</a></h2>
nbody0
in=snap_in out=snap_out [keyword=value ...] 
<h2><a name='sect2' href='#toc2'>Description</a></h2>
<b>nbody0</b> is the NEMO
adaptation of version 0 (the <i>Micky Mouse</i> version) of Aarseth&rsquo;s N-body integrator,
as published in Appendix 4B of Binney &amp; Tremaine (1987). It is a direct N-body
integrator, <i>i.e.</i> for each particle it computes the force due to all other
N-1 particles, hence the computational time grows approximately as N*N. Although
also being referred to as a &rsquo;toy version&rsquo;, it is  a fully functional N-body
integrator. <p>
Each particle is followed with its own integration step - an
essential feature when the dynamical times of different particles vary
a lot. A complete description is given in: S.J. Aarseth, "Multiple Time Scales",
ed. U.J. Brackhill &amp; B.I. Cohen, pp377. Orlando: Academic Press. (1985). <p>
An important
input parameter to the program is the accuracy parameter <i>eta</i> (see also
<b>eta=</b> below). The timestep, <i>dt</i>, chosen for a given particle is related to
the force, <i>F</i>, and its time derivatives by <i>dt = sqrt(eta * F / (d2Fdt2))</i>,
which is a slight modification of the criterion given by Aarseth in the
above mentioned reference (but see also <b>BUGS</b> below on academic cases like
the <i>figure8</i> orbit). <p>
A typical value of <i>eta = 0.02</i> usually conserves the energy
better than one part in 10000 over one crossing time, in the absence of
close encounters. <p>
<b>nbody00</b> is the C version of <b>nbody0</b>,  based on the f2c
translated code (and hence will look odd and ugly in places). It has more
debug output (debug=1 and higher) and also fixes problems with orbits like
the Figure8 orbit (see BUGS below). 
<h2><a name='sect3' href='#toc3'>Parameters</a></h2>
The following parameters are
recognized in any order when the keyword is also given 
<dl>

<dt><b>in=<i>in_name</i></b> </dt>
<dd>Input
file in <a href='snapshot.5NEMO.html'><i>snapshot(5NEMO)</i></a>
 format. Depending on how <b>nbody0</b> was compiled, other
input formats are supported. [no default].  </dd>

<dt><b>out=<i>out_name</i></b> </dt>
<dd>Output file in snapshot
format [no default]. </dd>

<dt><b>eta=<i>value</i></b> </dt>
<dd>Accurracy parameter, which automatically
determines the integration step.  For small enough values of <b>deltat</b> the
Heisenberg principle applies and the accuracy is determined by the integration
step itself! [0.02]. </dd>

<dt><b>deltat=<i>value</i></b> </dt>
<dd>Time interval of a major output. Although
the timestep is determined from <b>eta</b>, the accurracy parameter, for small
enough values of <b>deltat=</b> this parameter will determine the integration
step, and hence accuracy. [Default: 0.25]. </dd>

<dt><b>tcrit=<i>value</i></b> </dt>
<dd>Final integration time
[2.0]. </dd>

<dt><b>eps=</b><i>value</i> </dt>
<dd>Gravitational softening length [0.05]. </dd>

<dt><b>reset=t|f</b> </dt>
<dd>Selects if
the integration time of the next particle  to be advanced be reset to the
requested output time if that preceded the integration time (see <b>deltat=</b>).
This is highly recommended, as for high output frequencies (small <b>deltat=</b>
cf. the  <i>eta</i>-derived timestep <i>dt</i>) [t]. </dd>

<dt><b>f3dot=t|f</b> </dt>
<dd>Use higher order terms to
determine the timestep from <i>eta</i>. In the determination of the timestep a
simplified formulae using just F and F2DOT is used, which is what the original
BT87 code uses. By setting this keyword higher order terms F3DOT (and also
FDOT) are used, which mimic the behavior of <a href='nbody1.1NEMO.html'><i>nbody1(1NEMO)</i></a>
. This keyword
was introduced to integrate nice orbits like the Figure8 orbit, in which
both F and FDOT were 0 for the central particle. [f]. </dd>

<dt><b>options=</b><b>step</b> </dt>
<dd>Miscellaneous
control options, specified as a comma separated list of keywords. Currently
implemented are: <b>step</b>, outputs the current timestep per particle  in the
<i>Aux</i> array of  a <a href='snapshot.5NEMO.html'><i>snapshot(5NEMO)</i></a>
. Default: none. </dd>
</dl>

<h2><a name='sect4' href='#toc4'>Limitations</a></h2>
The code has a
hardcoded maximum number of particles in the fortran and C code (File:
<i>nmax.h</i>), change the relevant PARAMETER statement  to whatever is required.
Using NEMO install the Makefile macro NMAX can also be used to do this
automatically and  hence easily generate a new version with a different
value for  NMAX, <i>e.g.</i> <b>make nmax NMAX=256 nbody0</b>. The NDIM parameter should
not be changed, and remains at 3. <p>
Close encounters are not treated in any
special way.  See any of the modified  versions of the Aarseth code (<a href='nbody2.1NEMO.html'><i>nbody2(1NEMO)</i></a>
)
or in case regularization is needed (see also newton0_reg in: <a href='newton0.1NEMO.html'><i>newton0(1NEMO)</i></a>
).
<p>
Timesteps are not recomputed until the current timestep has expired. <p>
A side-effect
of the variable and particle-unique timesteps is that the final snapshot
will not be exactly identical for two runs with different choices of <b>deltat</b>.
<p>
In order to save time, all calculations in the fortran code (nbody0.f) can
be done in single precision.  A different version of nbody0.f is needed in
this case. See code comments labeled &lsquo;&lsquo;<i>SED</i>&rsquo;&rsquo;. <p>
A C version is also available,
as nbody0.c, though the Makefile needs the target <b>nbody00</b> to install it.
The user interface is as that of nbody0, except the keyword <b>f3dot=</b> was
added. 
<h2><a name='sect5' href='#toc5'>Bugs</a></h2>
Starting time of initial conditions is (re)set to 0, even if
the snapshot had another time. <p>
nbody0 has a simple version of the time step
criterion, which can fail in "academic" situations. For example, for the
nice symmetric <i>"figure8 orbit"</i> (see $NEMODAT/figure8.dat),  the integration
will fail since the timestep for the 3rd particle blows up. Interestingly
enough, some compilers (e.g. gnu) will happily work around this if optimization
is turned on, but fail with pure debugging (OPT=-g) since only in this case
the expression will compute as exactly 0. 
<h2><a name='sect6' href='#toc6'>Storage</a></h2>
A total of order <i>600.NMAX</i>
bytes is needed, for a given maximum of <i>NMAX</i> particles. This breaks down
as follows: <p>
The <b>FORTRAN</b> I/O code uses <i>10.NMAX</i> double precision and <i>20.NMAX</i>
real storage units for a maximum compiled number of <i>NMAX</i> particles. On most
machines this adds up to <i>160.NMAX</i> bytes. <p>
The <b>C</b> I/O code allocates space dynamically;
and through limitations of the fortran code, a maximum of <i>100.NMAX</i> double&rsquo;s
are needed, which means <i>400.NMAX</i> bytes. 
<h2><a name='sect7' href='#toc7'>Author</a></h2>
Sverre Aarseth (F77), Peter
Teuben (C) 
<h2><a name='sect8' href='#toc8'>Genealogy</a></h2>
The <b>nbody*</b> series of NBODY integrators were all originally
written by Sverre Aarseth, and exist in many forms throughout the scientific
community. The list below is a mere zeroth order approximation to the current
state of affairs: <br>
<pre>nbody0    <tt> </tt>&nbsp;<tt> </tt>&nbsp;Binney &amp; Tremaine&rsquo;s toy version, with NEMO interface 
nbody1       <tt> </tt>&nbsp;<tt> </tt>&nbsp;variable timestep; runbody1
nbody2     <tt> </tt>&nbsp;<tt> </tt>&nbsp;with Ahmad-Cohen scheme - (see also Benz et al, 1997); runbody2
nbody3          XXX
nbody4    <tt> </tt>&nbsp;<tt> </tt>&nbsp;... for HARP
nbody5    <tt> </tt>&nbsp;<tt> </tt>&nbsp;with regularization handling triples &amp; binaries  
nbody6     <tt> </tt>&nbsp;<tt> </tt>&nbsp;... for new parallel machine
nbody7<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;<tt> </tt>&nbsp;... secret
</pre>
<h2><a name='sect9' href='#toc9'>Files</a></h2>
<br>
<pre>NEMO/src/nbody/evolve/aarseth/nbody0<tt> </tt>&nbsp;<tt> </tt>&nbsp;official source code within NEMO
NEMO/usr/aarseth/                      <tt> </tt>&nbsp;<tt> </tt>&nbsp;SJA&rsquo;s other nbodyX versions (not
all exported)
</pre>
<h2><a name='sect10' href='#toc10'>See Also</a></h2>
<a href='hackcode1.1NEMO.html'>hackcode1(1NEMO)</a>
, <a href='runbody2.1NEMO.html'>runbody2(1NEMO)</a>
, <a href='snapshot.5NEMO.html'>snapshot(5NEMO)</a>
, <a href='atos.1NEMO.html'>atos(1NEMO)</a>
,
<a href='stoa.1NEMO.html'>stoa(1NEMO)</a>
 <p>
Binney, J. &amp; Tremaine, S. <i>Galactic Dynamics</i>. Princeton Unversity
Press (1987), pp678. <p>
S.J.Aarseth, 1972, p.373 in: "Gravitational N-Body Problem",
IAU Colloquium #10, M.Lecar (Ed.), Reidel, Dordrecht. <p>
S.J.Aarseth, 1985, p.377
in: "Multiple Time Scales", U.J. Brackbill &amp; B.I. Cohen (Eds.), Academic Press,
Orlando. <p>
S.J. Aarseth, 2003, "Gravitational N-Body Simulations : Tools and
Algorithms" (Cambridge Univ. Press). 
<p> 
<h2><a name='sect11' href='#toc11'>History</a></h2>
<br>
<pre>30-jun-89<tt> </tt>&nbsp;<tt> </tt>&nbsp;V1.0 created + NEMO interfaces to fortran source<tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
3-jul-89<tt> </tt>&nbsp;<tt> </tt>&nbsp;V1.1 mods to f2c interface, name of keywords       <tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
24-jan-90<tt> </tt>&nbsp;<tt> </tt>&nbsp;V1.2 all in double precision                     <tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
15-nov-91<tt> </tt>&nbsp;<tt> </tt>&nbsp;fixed up pure nbody0_ff version                 <tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
20-may-92<tt> </tt>&nbsp;<tt> </tt>&nbsp;-- also made the C (f2c) version available            <tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
2-apr-97<tt> </tt>&nbsp;<tt> </tt>&nbsp;documentation updated for NEMO 2.4                 <tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
6-aug-97<tt> </tt>&nbsp;<tt> </tt>&nbsp;V1.3 added options=                                  <tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
11-feb-98<tt> </tt>&nbsp;<tt> </tt>&nbsp;V1.3a fixed array index bug for higher order term<tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
21-jan-00<tt> </tt>&nbsp;<tt> </tt>&nbsp;V1.4 added reset= to fix small deltat problem/bug<tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
24-feb-04<tt> </tt>&nbsp;<tt> </tt>&nbsp;V1.5 documented the academic figure8 orbit problem, fixed in nbody00<tt> </tt>&nbsp;<tt> </tt>&nbsp;PJT
</pre><p>

<hr><p>
<a name='toc'><b>Table of Contents</b></a><p>
<ul>
<li><a name='toc0' href='#sect0'>Name</a></li>
<li><a name='toc1' href='#sect1'>Synopsis</a></li>
<li><a name='toc2' href='#sect2'>Description</a></li>
<li><a name='toc3' href='#sect3'>Parameters</a></li>
<li><a name='toc4' href='#sect4'>Limitations</a></li>
<li><a name='toc5' href='#sect5'>Bugs</a></li>
<li><a name='toc6' href='#sect6'>Storage</a></li>
<li><a name='toc7' href='#sect7'>Author</a></li>
<li><a name='toc8' href='#sect8'>Genealogy</a></li>
<li><a name='toc9' href='#sect9'>Files</a></li>
<li><a name='toc10' href='#sect10'>See Also</a></li>
<li><a name='toc11' href='#sect11'>History</a></li>
</ul>
</body>
</html>
