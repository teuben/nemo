.TH CCD2VEL 1NEMO "11 March 2022"

.SH "NAME"
ccd2vel \- convert map of wave/freq/velocities to doppler velocities

.SH "SYNOPSIS"
\fBccd2vel\fP [parameter=value]

.SH "DESCRIPTION"
\fBccd2vel\fP converts a map to a doppler velocity map. The input map
units can be in wavelength (\fBrestwave=\fP is needed), frequency (\fBrestfreq=\fP is needed)
or one of three doppler velocity frames of reference (radio, optical, relativistic).
The output map will be in one of those three doppler velocity frames of reference
(radio, optical, relativistic). Output units are normally km/s.
.PP
This program ignores references to being in a Barycenric, Heliocentric or LSR frame. See comments below in the
CASA and MIRIAD sections.

.SH "PARAMETERS"
.so man1/parameters
.TP 20
\fBin=\fP
Optional input image file. No default.
.TP
\fBout=\fP
Output image file. No Default.
.TP
\fBfrom=rel|rad|opt\fP
Frame of reference (relativistic, radio, optical). When using \fBrestwave=\fP or \fBrestfreq=\fP this keyword is ignored.
[rel] 
.TP
\fBto=rel|rad|opt\fP
Frame of reference (relativistic, radio, optical) [rel] 
.TP
\fBrestwave=\fP
Rest wavelength, in the units of the map.  
Only one of restwave of restfreq can be used.
.TP
\fBrestfreq=\fP
Rest frequency, in the units of the map
.TP
\fBclip=\fP\fImin,max\fP
Clipping of output (none, or two values needed). Default: no clipping.
.TP
\fBunits=km/s\fP
Desired output units (km/s, m/s) [km/s]
.TP
\fBunits=\fP
If given, and no in/out is given, the three velocity conventions (radio, relativistic, optical)
are given in km/s. Default: not used.

.SH "EXAMPLES"
Here is how one converts a fits cube with an optical wavelengths 3rd axis
to a relatistic velocity field:
.nf
   fitsccd Ha.cube.fits  - | ccdmom - - mom=3 | ccd2vel - Ha-3.vel opt rel 6562.80 
.fi
and here an optical velocity field into a relativistic
.nf
   NGC2347.VoptFromHa.fits - | ccd2vel - NGC2347.VrelFromHa.ccd opt rel
.fi
and the different doppler conversion velocities for z=1:
.nf
    ccd2vel z=1
    vrad=149896
    vrel=179875
    vopt=299792
.fi

.SH "CASA"
From the \fBtclean\fP documentation on the \fBveltype\fP keyword:

Velocity type (radio, z, ratio, beta, gamma, optical)
For start and/or width specified in velocity, specifies the velocity definition

Options: 'radio','optical','z','beta','gamma'

NOTE: the viewer always defaults to displaying the 'radio' frame, 
but that can be changed in the position tracking pull down.

The different types (with F = f/f0, the frequency ratio), are:
.nf

                       Z = (-1 + 1/F)
                      RATIO = (F) *
                      RADIO = (1 - F)
                      OPTICAL == Z
                      BETA = ((1 - F2)/(1 + F2))
                      GAMMA = ((1 + F2)/2F) *
                      RELATIVISTIC == BETA (== v/c)
                      DEFAULT == RADIO
                      Note that the ones with an '*' have no real interpretation 
                      (although the calculation will proceed) if given as a velocity.

.fi

.SH "MIRIAD"
From the \fBVELSW\fP documentation:

VELSW is a Miriad task used to change the type of a spectral axis.
For example, a frequency axis could be changed to redshift or
relativistic velocity.

The resulting axis may be non-linear.  If so, it will be marked by a
code, e.g. VOPT-F2W, meaning that it is actually linear in frequency
(F) but is labelled as a spectral type that is linear in wavelength
(W).  Such non-linear axes are handled properly by the coordinate
routines.  However, when plotted, non-linear axes are only correct to
first-order at the reference point.

Switching between velocity and other spectral types, via the
Doppler formula, is only possible if a rest frequency is
recorded in the header.  It is also possible to change the
Doppler reference frame to barycentric or LSRK (only).

Note that velocity axes labelled as {VELO,FELO}-{HEL,LSR} in
Miriad have been Doppler-shifted to the specified frame
(barycentric or LSRK) as would be expected.  However, frequency
axes labelled as FREQ-{HEL,LSR} are actually topocentric, the
Doppler frame here refers only to the value of vobs recorded in
the header.  This convention also applies to FITS images written
and read by Miriad - the presence of vobs with FREQ-{HEL,LSR} in
the header of a Miriad image read from such a FITS file is
indicative.  However, there is a potential inconsistency when
FITS files generated by other packages are read into Miriad.
See option altspc below.

.nf
Keyword: axis
         The spectral type to change to:
           FREQ: frequency,
           ENER: photon energy (linear with frequency),
           WAVN: wavenumber (linear with frequency),
           VRAD: radio velocity (linear with frequency),
           WAVE: wavelength,
           VOPT: optical velocity (linear with wavelength),
           ZOPT: redshift (linear with wavelength),
           AWAV: air wavelength (applicable to optical regime only),
           VELO: apparent radial velocity (relativistic),
           BETA: relativistic beta factor (= VELO/c).
.fi

Note that there is no minimum-match on these four-letter
spectral types.  For backwards compatibility, 'frequency', 'radio',
and 'optical' (with min-match) are understood as
synonyms for 'FREQ', 'VRAD', and 'VOPT'.

AIPS-convention types, {FREQ,VELO,FELO}-{HEL,LSR}, are also
understood and will be translated.  Here VELO means radio
velocity (VRAD), and FELO is optical velocity (VOPT-F2W).
However, these types are deprecated, and there is no way to
switch to them explicitly.

An optional second value defines the Doppler frame to transform
to (min-match applies):
.nf
   BARYCENT: Solar System barycentre (aka BARYCENT{RE,ER,RIC}, or HEL),
   LSRK: Kinematic Local Standard of Rest.
.fi
The default for both the spectral type and the Doppler frame is
to leave them as is, performing only required translations.

.fi

.SH "SEE ALSO"

ccdsky(1NEMO), ccdmath(1NEMO), fitsccd(1NEMO)

.SH "AUTHOR"
Peter Teuben

.SH "UPDATE HISTORY"
.nf
.ta +1.0i +4.0i
27-Apr-17	V0.3 Created	PJT
11-mar-11	V0.6 added doppler conversions for given z=	PJT
.fi
